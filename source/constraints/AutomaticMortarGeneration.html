<!DOCTYPE html><head><meta charset="UTF-8"><title>AutomaticMortarGeneration | Zapdos</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/zapdos.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Zapdos</a><a href="https://github.com/shannon-lab/zapdos" class="right"><img src="../../media/framework/github-logo.png" alt="GitHub wordmark" class="github-mark"></img><img src="../../media/framework/github-mark.png" alt="GitHub logo" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="5ec91b5b-71ea-49b6-9824-16fa7c4ebbb8" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="93f397ed-72bc-4322-b305-2406c49b253b" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="53e65fdc-baa6-4bb9-bf3f-b8fadff9c37b" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../citing.html">Citing</a></li></ul><a href="#" class="sidenav-trigger" data-target="4d427cd6-f8a1-4713-ab41-5924d7d253fa"><i class="material-icons">menu</i></a><ul class="sidenav" id="4d427cd6-f8a1-4713-ab41-5924d7d253fa"><li><a href="#!" class="dropdown-trigger" data-target="e7ea48c2-246a-45c0-9455-346a4cd68b22" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="0f335245-66d7-4670-8c81-141ac2afa5c2" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="7e1f5de0-1969-4fc9-9d0d-a41f91491111" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../citing.html">Citing</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="5ec91b5b-71ea-49b6-9824-16fa7c4ebbb8"><li><a href="../../getting_started/installation.html">Installation</a></li><li><a href="../../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../../getting_started/zapdos_meshing.html">Generating Meshes</a></li><li><a href="../../tutorial/index.html">Tutorial Slides</a></li></ul><ul class="dropdown-content" id="93f397ed-72bc-4322-b305-2406c49b253b"><li><a href="../../syntax/zapdos_only.html">Zapdos Input Syntax</a></li><li><a href="../../syntax/index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../../examples/crane_examples.html">CRANE Examples</a></li><li><a href="../../development/contributing.html">Contributing Guidelines</a></li><li><a href="../../development/code_standards.html">Code Standards</a></li><li><a href="../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="53e65fdc-baa6-4bb9-bf3f-b8fadff9c37b"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="../../development/zapdos_developer_info.html">Zapdos Developer Information</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul><ul class="dropdown-content" id="e7ea48c2-246a-45c0-9455-346a4cd68b22"><li><a href="../../getting_started/installation.html">Installation</a></li><li><a href="../../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../../getting_started/zapdos_meshing.html">Generating Meshes</a></li><li><a href="../../tutorial/index.html">Tutorial Slides</a></li></ul><ul class="dropdown-content" id="0f335245-66d7-4670-8c81-141ac2afa5c2"><li><a href="../../syntax/zapdos_only.html">Zapdos Input Syntax</a></li><li><a href="../../syntax/index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../../examples/crane_examples.html">CRANE Examples</a></li><li><a href="../../development/contributing.html">Contributing Guidelines</a></li><li><a href="../../development/code_standards.html">Code Standards</a></li><li><a href="../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="7e1f5de0-1969-4fc9-9d0d-a41f91491111"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="../../development/zapdos_developer_info.html">Zapdos Developer Information</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">source</a><span class="breadcrumb">constraints</span><a href="#" class="breadcrumb">AutomaticMortarGeneration</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="6d565519-9273-474e-af9c-eea47ebd6482" data-section-level="1" data-section-text="AutomaticMortarGeneration"><h1 id="automaticmortargeneration">AutomaticMortarGeneration</h1><p>The <code>AutomaticMortarGeneration</code> class is used to define mortar segment meshes to properly integrate discontinuities caused by normal projections of non-matching, faceted meshes. The mortar segment mesh is always replicated when the parent mesh is allowed to displace, otherwise its distribution type (replicated/distributed) is determined by the type of the parent mesh. The reason the mortar mesh is replicated during displacement is that we always build the mortar mesh by looping over all active elements associated with the secondary and primary interface, not just active local elements. When displacement is occurring we cannot know <em>a priori</em> what elements will project onto each other, so absent that knowledge we keep copies of all interface elements on each process. In the future we may eliminate this replication and implement communication patterns that occur during each residual and Jacobian evaluation to pull remote elements. This would improve memory scalability. Even for the current implementation where the interface of the parent mesh is replicated, one could legitimately ask why the mortar mesh needs to be so. The answer is that <code>MortarNodalAuxKernel</code> derived classes require access to all mortar segment elements, local or not, that have support from the shape function associated with a given node. In the future we may add ghosting functors to the mortar segment mesh, which would allow us to delete unnecessary non-local elements.</p><section class="scrollspy" id="902443fc-0857-4fe7-82ba-23d9cde4a277" data-section-level="2" data-section-text="2 D"><h2 id="2-d">2D</h2><p>Generation of the 2D mortar segment mesh is outlined in <a href="#osti_1468630">Peterson (2018)</a>. In short, a nodal-normal projection is used to map points from the primary interface to the secondary interface; secondary interface elements are then split by the projected nodes to form mortar segment mesh elements.</p></section><section class="scrollspy" id="03ead7d6-367e-44e7-998e-066b637ec64a" data-section-level="2" data-section-text="3 D"><h2 id="3-d">3D</h2><p>Generation of mortar segment meshes in 3D is more challenging and various approaches exist. In MOOSE we follow the approach suggested in <a href="#puso20043d">Puso (2004)</a>, defining mortar segments on local linearizations of the secondary interface. When the secondary interface is composed entirely of TRI3 faces (which are already linear), generating the mortar segment mesh reduces to projecting the primary face elements onto secondary face elements (along the secondary face normal) and performing a polygon clipping (and subsequent triangularization). The mortar segment mesh is therefore simply a sub-mesh of the secondary mesh in this case.</p><p>The definition is more delicate for quadrilateral faces and second order geometries:</p><section id="bce1e4c1-9098-4e8e-930e-0e95e50e6ff5" data-section-level="3" data-section-text="QUAD 4 faces"><h3 id="quad-4-faces">QUAD4 faces</h3><p>While first-order, QUAD4 faces are (in general) not linear. The &#x27;twisting&#x27; or &#x27;potato-chipping&#x27; of QUAD4 elements complicates the simple projection and polygon clipping defined for TRI3 faces. To circumvent this problem, mortar segment meshes are defined on local linearizations of QUAD4 elements (see below). The linearization of QUAD4 face elements allows the same polygon clipping algorithm used for TRI3 face elements, but the mortar segment mesh elements produced do not coincide with the secondary mesh and the mortar segment mesh is disconnected between secondary elements.</p><picture class="materialboxed moose-image" role="button" tabindex="0"><img src="../../media/framework/constraints/Linearized-Quad.jpg" alt="A local linearization of a nonlinear QUAD4 element." style="display:block;margin:auto;width:70%"></img></picture></section><section id="9602ebdf-e365-4381-b836-182f51f95e4b" data-section-level="3" data-section-text="Second Order Geometries ( TRI 6 and QUAD 9 faces )"><h3 id="second-order-geometries-tri-6-and-quad-9-faces">Second Order Geometries (TRI6 and QUAD9 faces)</h3><p>Elements defined on second order geometries are curvilinear so to simplify the &#x27;clipping&#x27; procedure both secondary and primary face elements are subdivided into first-order face elements then subsequently linearized (illustrated below). The same clipping and triangularization routine is then applied on the linearized sub-elements to create the mortar segments. See <a href="#puso2008segment">Puso et al. (2008)</a>.</p><picture class="materialboxed moose-image" role="button" tabindex="0"><img src="../../media/framework/constraints/Second-Order-Linearized.jpg" alt="A second order quad element is converted to 4 first-order elements, which are then linearized and "clipped"." style="display:block;margin:auto;width:70%"></img></picture><p>Quadrature points defined on mortar segments (which live on linearized elements) are mapped back to second order elements following an analogous but reverse procedure to the one illustrated above; points are mapped from linearized elements to first order sub-elements then subsequently transformed to the original second order elements.</p></section></section><section class="scrollspy" id="af6f5ba8-b418-45ef-8585-9f56e6368e86" data-section-level="2" data-section-text="References"><h2 id="references">References</h2><div class="moose-bibliography"><ol><li id="osti_1468630">John&nbsp;W. Peterson.
Progress toward a new implementation of the mortar finite element method in moose.
2 2018.
<a href="https://doi.org/10.2172/1468630">doi:10.2172/1468630</a>.<a href="#143f9373-2e3d-45eb-9c84-e3bcc06e9c35" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="143f9373-2e3d-45eb-9c84-e3bcc06e9c35"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{osti_1468630,
    author = "Peterson, John W.",
    title = "Progress toward a new implementation of the mortar finite element method in MOOSE",
    abstractNote = {The mortar finite element method has been used for many years in a variety of applications, including the enforcement of continuity conditions across decomposed domains, the implementation of Dirichlet boundary conditions, obtaining improved estimates of surface fluxes, and for solving large deformation contact mechanics problems. There is a currently great deal of interest in developing more robust mechanical and thermal contact solution strategies in the MOOSE framework and physics modules, and schemes based on the mortar finite element approach appear to be a promising avenue of development. There are a number of challenges associated with the development of a robust Lagrange multiplier based formulation of the mortar finite element method which can be tackled using the relatively simple framework of thermal contact problems, before tackling more complicated applications such as thermomechanical contact. In this report, we describe several aspects of our mortar finite element method implementation for solving thermal contact problems. The approach and notation used are based primarily based on the work of Bin Yang et al. ("Two dimensional mortar contact methods for large deformation frictional sliding," International Journal for Numerical Methods in Engineering 62(9), 2005).},
    doi = "10.2172/1468630",
    journal = "",
    place = "United States",
    year = "2018",
    month = "2"
}
</code></pre></div></div></li><li id="puso20043d">Michael&nbsp;A Puso.
A 3d mortar method for solid mechanics.
<em>International Journal for Numerical Methods in Engineering</em>, 59(3):315–336, 2004.<a href="#add02225-54b2-4826-900f-f356d5e3e5f4" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="add02225-54b2-4826-900f-f356d5e3e5f4"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{puso20043d,
    author = "Puso, Michael A",
    title = "A 3D mortar method for solid mechanics",
    journal = "International Journal for Numerical Methods in Engineering",
    volume = "59",
    number = "3",
    pages = "315--336",
    year = "2004",
    publisher = "Wiley Online Library"
}
</code></pre></div></div></li><li id="puso2008segment">Michael&nbsp;A Puso, TA&nbsp;Laursen, and Jerome Solberg.
A segment-to-segment mortar contact method for quadratic elements and large deformations.
<em>Computer Methods in Applied Mechanics and Engineering</em>, 197(6-8):555–566, 2008.<a href="#242cf1dc-2638-44cf-8ae7-409426e4b08b" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="242cf1dc-2638-44cf-8ae7-409426e4b08b"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{puso2008segment,
    author = "Puso, Michael A and Laursen, TA and Solberg, Jerome",
    title = "A segment-to-segment mortar contact method for quadratic elements and large deformations",
    journal = "Computer Methods in Applied Mechanics and Engineering",
    volume = "197",
    number = "6-8",
    pages = "555--566",
    year = "2008",
    publisher = "Elsevier"
}
</code></pre></div></div></li></ol></div></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#902443fc-0857-4fe7-82ba-23d9cde4a277" class="tooltipped" data-position="left" data-tooltip="2 D">2 D</a></li><li><a href="#03ead7d6-367e-44e7-998e-066b637ec64a" class="tooltipped" data-position="left" data-tooltip="3 D">3 D</a></li><li><a href="#af6f5ba8-b418-45ef-8585-9f56e6368e86" class="tooltipped" data-position="left" data-tooltip="References">References</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>