<!DOCTYPE html><head><meta charset="UTF-8"><title>ExplicitSSPRungeKutta | Zapdos</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/zapdos.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://shannon-lab.github.io/zapdos" class="left moose-logo hide-on-med-and-down">Zapdos</a><a href="https://github.com/shannon-lab/zapdos" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="d123584c-e23d-44c6-bc70-6680de317743" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="05924055-230b-4c2f-bfc9-a5169ecb141c" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="5e6f5401-f87c-445a-8a11-06e8d540b7ae" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../citing.html">Citing</a></li></ul><a href="#" class="sidenav-trigger" data-target="888f9900-06f3-44d0-b9ea-4449990b7592"><i class="material-icons">menu</i></a><ul class="sidenav" id="888f9900-06f3-44d0-b9ea-4449990b7592"><li><a href="#!" class="dropdown-trigger" data-target="1e81bdfc-6ffc-4a89-9df9-2e680acf1ec6" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="5efa8452-dc74-449a-9c39-718758697208" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="0f87991d-b778-468e-a421-5a82c73be5d7" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../citing.html">Citing</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="d123584c-e23d-44c6-bc70-6680de317743"><li><a href="../../getting_started/installation.html">Installation</a></li><li><a href="../../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../../getting_started/zapdos_meshing.html">Generating Meshes</a></li></ul><ul class="dropdown-content" id="05924055-230b-4c2f-bfc9-a5169ecb141c"><li><a href="../../syntax/index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../../development/contributing.html">Contributing Guidelines</a></li><li><a href="../../development/code_standards.html">Code Standards</a></li><li><a href="../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="5e6f5401-f87c-445a-8a11-06e8d540b7ae"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul><ul class="dropdown-content" id="1e81bdfc-6ffc-4a89-9df9-2e680acf1ec6"><li><a href="../../getting_started/installation.html">Installation</a></li><li><a href="../../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../../getting_started/zapdos_meshing.html">Generating Meshes</a></li></ul><ul class="dropdown-content" id="5efa8452-dc74-449a-9c39-718758697208"><li><a href="../../syntax/index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../../development/contributing.html">Contributing Guidelines</a></li><li><a href="../../development/code_standards.html">Code Standards</a></li><li><a href="../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="0f87991d-b778-468e-a421-5a82c73be5d7"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="https://shannon-lab.github.io/zapdos" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">source</a><span class="breadcrumb">timeintegrators</span><a href="#" class="breadcrumb">ExplicitSSPRungeKutta</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="61bab06f-3982-4238-8d4d-1ab9ece5397a" data-section-level="1" data-section-text="ExplicitSSPRungeKutta"><h1 id="explicitssprungekutta">ExplicitSSPRungeKutta</h1><section class="scrollspy" id="4a9b6a0e-3702-423c-abac-9b0af6c48afd" data-section-level="2" data-section-text="Introduction"><h2 id="introduction">Introduction</h2><p>This time integrator includes explicit Strong Stability Preserving (SSP) Runge-Kutta time integration methods, of orders 1, 2, and 3, deriving from <a href="ExplicitTimeIntegrator.html">ExplicitTimeIntegrator</a>, meaning that no nonlinear solver is invoked. The key feature of SSP Runge-Kutta methods is that they preserve the strong stability properties (in any norm or seminorm) of the explicit/forward Euler method <a href="#gottlieb2005">Gottlieb (2005)</a>.</p></section><section class="scrollspy" id="d57375da-af10-4423-a79d-38ec64539451" data-section-level="2" data-section-text="Formulation"><h2 id="formulation">Formulation</h2><p>For the ODE <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-66f78a8b-ab25-4d3b-96c6-9146effdbd68"></span><script>var element = document.getElementById("moose-equation-66f78a8b-ab25-4d3b-96c6-9146effdbd68");katex.render("  \\frac{d u}{d t} = f(u(t), t) \\,,", element, {displayMode:true,throwOnError:false});</script></span> the SSP Runge-Kutta methods up to order 3 can be expressed in the following form for a time step: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-0e1ecfb7-aa33-4fea-a49c-c63df508adaa"></span><script>var element = document.getElementById("moose-equation-0e1ecfb7-aa33-4fea-a49c-c63df508adaa");katex.render("  u^{(0)} = u^n \\,,", element, {displayMode:true,throwOnError:false});</script></span> <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-098a5079-cb19-4b77-8db9-8f6787bf69cc"></span><script>var element = document.getElementById("moose-equation-098a5079-cb19-4b77-8db9-8f6787bf69cc");katex.render("  u^{(s)} = \\sum\\limits_{k=0}^{s-1} a_{s,k} u^{(k)} + b_s \\Delta t f\\left(u^{(s-1)}, t^n + c_s\\Delta t\\right) \\,,     \\qquad i = 1,\\ldots,N_s \\,,", element, {displayMode:true,throwOnError:false});</script></span> <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-e93e49ee-407b-48c5-9961-a66c74c87b74"></span><script>var element = document.getElementById("moose-equation-e93e49ee-407b-48c5-9961-a66c74c87b74");katex.render("  u^{n+1} = u^{(N_s)} \\,,", element, {displayMode:true,throwOnError:false});</script></span> where <span class="moose-katex-inline-equation" id="moose-equation-342c4939-e39a-47f3-9976-19303cd75244"><script>var element = document.getElementById("moose-equation-342c4939-e39a-47f3-9976-19303cd75244");katex.render("N_s", element, {displayMode:false,throwOnError:false});</script></span> is the number of stages and for methods up to order 3, is also the order of accuracy. The coefficients <span class="moose-katex-inline-equation" id="moose-equation-2e6cf33e-6097-4466-b067-4d7d459522b3"><script>var element = document.getElementById("moose-equation-2e6cf33e-6097-4466-b067-4d7d459522b3");katex.render("a_{i,j}", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-bc04d7c0-596d-49dc-87db-e59cdbe96029"><script>var element = document.getElementById("moose-equation-bc04d7c0-596d-49dc-87db-e59cdbe96029");katex.render("b_i", element, {displayMode:false,throwOnError:false});</script></span>, and <span class="moose-katex-inline-equation" id="moose-equation-93cd85f0-72c0-410e-b38b-07812ad4a225"><script>var element = document.getElementById("moose-equation-93cd85f0-72c0-410e-b38b-07812ad4a225");katex.render("c_i", element, {displayMode:false,throwOnError:false});</script></span> can be conveniently expressed in the following tabular form: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-7bd41170-5a5b-4165-ac7d-2748b4fc575f"></span><script>var element = document.getElementById("moose-equation-7bd41170-5a5b-4165-ac7d-2748b4fc575f");katex.render("  \\begin{array}{c|c}     \\mathbf{c} & \\mathbf{A}\\\\\\hline     & \\mathbf{b}^T\\\\   \\end{array} \\,.", element, {displayMode:true,throwOnError:false});</script></span> Respectively, the tables for the methods of orders 1, 2, and 3 are as follows: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-b0556d48-a5c4-4b89-9466-cd03e5e3768b"></span><script>var element = document.getElementById("moose-equation-b0556d48-a5c4-4b89-9466-cd03e5e3768b");katex.render("  \\begin{array}{c|c}     0 & 1\\\\\\hline     & 1\\\\   \\end{array} \\,,", element, {displayMode:true,throwOnError:false});</script></span> <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-789d554a-8ef0-4e3d-8a80-0e35daab0d13"></span><script>var element = document.getElementById("moose-equation-789d554a-8ef0-4e3d-8a80-0e35daab0d13");katex.render("  \\begin{array}{c|c c}     0 & 1           & \\\\     1 & \\frac{1}{2} & \\frac{1}{2}\\\\\\hline       & 1           & \\frac{1}{2}\\\\   \\end{array} \\,,", element, {displayMode:true,throwOnError:false});</script></span> <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-398bdf99-6792-4d27-b3b5-643db0a1b08b"></span><script>var element = document.getElementById("moose-equation-398bdf99-6792-4d27-b3b5-643db0a1b08b");katex.render("  \\begin{array}{c|c c}     0           & 1           &             &\\\\     1           & \\frac{3}{4} & \\frac{1}{4} &\\\\     \\frac{1}{2} & \\frac{1}{3} & 0           & \\frac{2}{3}\\\\\\hline                 & 1           & \\frac{1}{4} & \\frac{2}{3}\\\\   \\end{array} \\,.", element, {displayMode:true,throwOnError:false});</script></span> These methods have the following time step size requirement for stability: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-590bbc18-27b5-4605-9a33-ca469676b331"></span><script>var element = document.getElementById("moose-equation-590bbc18-27b5-4605-9a33-ca469676b331");katex.render("  \\Delta t < \\gamma \\Delta t_{FE} \\,, \\quad \\gamma = \\min\\limits_{i,k} \\frac{a_{i,k}}{b_i} \\,.", element, {displayMode:true,throwOnError:false});</script></span> where <span class="moose-katex-inline-equation" id="moose-equation-1705172e-3076-4df4-a63f-2682b2c3e5ac"><script>var element = document.getElementById("moose-equation-1705172e-3076-4df4-a63f-2682b2c3e5ac");katex.render("\\Delta t_{FE}", element, {displayMode:false,throwOnError:false});</script></span> is the maximum time step size for stability of the forward Euler method. For these methods of order 1, 2, 3, <span class="moose-katex-inline-equation" id="moose-equation-cdfed1ac-1eee-41ba-bf4d-b1e856a3e09f"><script>var element = document.getElementById("moose-equation-cdfed1ac-1eee-41ba-bf4d-b1e856a3e09f");katex.render("\\gamma = 1", element, {displayMode:false,throwOnError:false});</script></span>.</p><p>In MOOSE, generally the system of ODEs to be solved result from discretization using the finite element method, and thus a mass matrix exists: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-0e3a17bf-afa2-4edc-a6aa-a7decb73ed8f"></span><script>var element = document.getElementById("moose-equation-0e3a17bf-afa2-4edc-a6aa-a7decb73ed8f");katex.render("  \\mathbf{M}\\frac{d \\mathbf{u}}{d t} = \\mathbf{f}\\left(\\mathbf{u}(t), t\\right) \\,.", element, {displayMode:true,throwOnError:false});</script></span> In this case, the stage <span class="moose-katex-inline-equation" id="moose-equation-b0746fa0-3125-40ad-ae91-f8886b810795"><script>var element = document.getElementById("moose-equation-b0746fa0-3125-40ad-ae91-f8886b810795");katex.render("s", element, {displayMode:false,throwOnError:false});</script></span> solution is actually the following: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-b18df58b-186c-4061-98dd-94747a2dc833"></span><script>var element = document.getElementById("moose-equation-b18df58b-186c-4061-98dd-94747a2dc833");katex.render("  \\mathbf{u}^{(s)} = \\sum\\limits_{k=0}^{s-1} a_{s,k} \\mathbf{u}^{(k)}     + \\mathbf{M}^{-1} b_s \\Delta t \\mathbf{f}\\left(\\mathbf{u}^{(s-1)}, t^n + c_s\\Delta t\\right) \\,.", element, {displayMode:true,throwOnError:false});</script></span> As an implementation note, the usual mass matrix entry is <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-168a4bea-e136-492e-b132-c5b9fef352f8"></span><script>var element = document.getElementById("moose-equation-168a4bea-e136-492e-b132-c5b9fef352f8");katex.render("  m_{i,j} = (\\phi_i, \\phi_j) \\,.", element, {displayMode:true,throwOnError:false});</script></span> However, in MOOSE, the mass matrix includes the time step size: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-02446256-fae6-4791-9b08-31acb8eeb08c"></span><script>var element = document.getElementById("moose-equation-02446256-fae6-4791-9b08-31acb8eeb08c");katex.render("  m_{i,j} = \\frac{(\\phi_i, \\phi_j)}{b_i \\Delta t} \\,,", element, {displayMode:true,throwOnError:false});</script></span> <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-b3c0b1e5-5e31-4035-a3e9-e54e6ff1ff7d"></span><span class="moose-katex-equation-number">(1)</span><script>var element = document.getElementById("moose-equation-b3c0b1e5-5e31-4035-a3e9-e54e6ff1ff7d");katex.render("   \\mathbf{u}^{(s)} = \\sum\\limits_{k=0}^{s-1} a_{s,k} \\mathbf{u}^{(k)}     + \\mathbf{M}^{-1} \\mathbf{f}\\left(\\mathbf{u}^{(s-1)}, t^n + c_s\\Delta t\\right) \\,.", element, {displayMode:true,throwOnError:false});</script></span></p></section><section class="scrollspy" id="63f5158a-62c3-4996-98ce-7b318abaa1e1" data-section-level="2" data-section-text="Dirichlet Boundary Conditions Treatment"><h2 id="dirichlet-boundary-conditions-treatment">Dirichlet Boundary Conditions Treatment</h2><p>Now consider the case where one or more degrees of freedom are subject to strong (Dirichlet) boundary conditions: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-0d436f61-b9f4-4f78-bfc7-72a6b0012de7"></span><script>var element = document.getElementById("moose-equation-0d436f61-b9f4-4f78-bfc7-72a6b0012de7");katex.render("  u_i(t) = g(\\mathbf{x}_i, t) \\,, \\qquad i \\in \\mathcal{I}_\\text{Dirichlet} \\,.", element, {displayMode:true,throwOnError:false});</script></span> For a nonlinear solve with Newton&#x27;s method, each iteration consists of the solution of a linear system: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-47fd4793-2b0a-4291-83d3-ec0a8878a4b2"></span><span class="moose-katex-equation-number">(2)</span><script>var element = document.getElementById("moose-equation-47fd4793-2b0a-4291-83d3-ec0a8878a4b2");katex.render("   \\mathbf{J}^{(\\ell-1)}\\mathbf{\\delta u}^{(\\ell)} = -\\mathbf{r}^{(\\ell-1)} \\,,", element, {displayMode:true,throwOnError:false});</script></span> and then updating the solution: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-6aee5d2b-e350-4ee7-82b8-2aaa2d23bd9e"></span><script>var element = document.getElementById("moose-equation-6aee5d2b-e350-4ee7-82b8-2aaa2d23bd9e");katex.render("  \\mathbf{u}^{(\\ell)} = \\mathbf{u}^{(\\ell-1)} + \\mathbf{\\delta u}^{(\\ell)} \\,.", element, {displayMode:true,throwOnError:false});</script></span> In MOOSE, Dirichlet boundary conditions are implemented by modifying the residual vector <span class="moose-katex-inline-equation" id="moose-equation-44989ade-5ca6-4cfc-9e03-5a31a214cb86"><script>var element = document.getElementById("moose-equation-44989ade-5ca6-4cfc-9e03-5a31a214cb86");katex.render("\\mathbf{r}", element, {displayMode:false,throwOnError:false});</script></span> to replace entries for the affected degrees of freedom: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-10e17b2c-7b45-4019-b9c0-b42e61c4cc0b"></span><script>var element = document.getElementById("moose-equation-10e17b2c-7b45-4019-b9c0-b42e61c4cc0b");katex.render("  \\tilde{r}_i = \\left\\{\\begin{array}{l l}     r_i \\,,                      & i \\notin \\mathcal{I}_\\text{Dirichlet}\\\\     u_i - g(\\mathbf{x}_i, t) \\,, & i \\in \\mathcal{I}_\\text{Dirichlet}     \\end{array}\\right. \\,.", element, {displayMode:true,throwOnError:false});</script></span> By modifying the Jacobian matrix as follows, one can guarantee that the boundary conditions are enforced, i.e., <span class="moose-katex-inline-equation" id="moose-equation-35613365-ac2c-442e-829f-bfdf6607e168"><script>var element = document.getElementById("moose-equation-35613365-ac2c-442e-829f-bfdf6607e168");katex.render("u_i^{(\\ell)} = g(\\mathbf{x}_i, t)", element, {displayMode:false,throwOnError:false});</script></span> for <span class="moose-katex-inline-equation" id="moose-equation-2a430887-a199-4e68-92d3-3d2fe2acd037"><script>var element = document.getElementById("moose-equation-2a430887-a199-4e68-92d3-3d2fe2acd037");katex.render("i \\in \\mathcal{I}_\\text{Dirichlet}", element, {displayMode:false,throwOnError:false});</script></span>: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-b2711aac-2bf6-4d6c-b2d0-b56618e2be21"></span><script>var element = document.getElementById("moose-equation-b2711aac-2bf6-4d6c-b2d0-b56618e2be21");katex.render("  \\tilde{J}_{i,j} = \\left\\{\\begin{array}{l l}     J_{i,j} \\,, & i \\notin \\mathcal{I}_\\text{Dirichlet}\\\\     1 \\,,       & i \\in \\mathcal{I}_\\text{Dirichlet}, \\quad j = i\\\\     0 \\,,       & i \\in \\mathcal{I}_\\text{Dirichlet}, \\quad j \\ne i     \\end{array}\\right. \\,.", element, {displayMode:true,throwOnError:false});</script></span> To work with MOOSE&#x27;s Dirichlet boundary condition implementation, <a href="#moose-equation-b3c0b1e5-5e31-4035-a3e9-e54e6ff1ff7d">Eq. (1)</a> must be put in an update form, similar to <a href="#moose-equation-47fd4793-2b0a-4291-83d3-ec0a8878a4b2">Eq. (2)</a>: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-b2a0d3e9-d131-43cb-9e08-6326fbf02e39"></span><span class="moose-katex-equation-number">(3)</span><script>var element = document.getElementById("moose-equation-b2a0d3e9-d131-43cb-9e08-6326fbf02e39");katex.render("   \\mathbf{M}\\mathbf{\\delta u}^{(s)} = \\mathbf{b} \\,,", element, {displayMode:true,throwOnError:false});</script></span> <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-61e5d343-c1f7-4e41-b034-b3eea062e990"></span><span class="moose-katex-equation-number">(4)</span><script>var element = document.getElementById("moose-equation-61e5d343-c1f7-4e41-b034-b3eea062e990");katex.render("   \\mathbf{b} = \\mathbf{M}\\left(\\sum\\limits_{k=0}^{s-1} a_{s,k} \\mathbf{u}^{(k)}     - \\mathbf{u}^{(s-1)} \\right)     + \\mathbf{f}\\left(\\mathbf{u}^{(s-1)}, t^n + c_s\\Delta t\\right) \\,,", element, {displayMode:true,throwOnError:false});</script></span> <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-b741d055-8d3b-4935-b038-a08d7a8e466f"></span><script>var element = document.getElementById("moose-equation-b741d055-8d3b-4935-b038-a08d7a8e466f");katex.render("  \\mathbf{\\delta u}^{(s)} \\equiv \\mathbf{u}^{(s)} - \\mathbf{u}^{(s-1)} \\,.", element, {displayMode:true,throwOnError:false});</script></span> To impose the Dirichlet boundary conditions, the mass matrix and right-hand side vector are modified as for the Newton case: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-485bbe56-7513-472b-8fcc-3fd7157b4877"></span><script>var element = document.getElementById("moose-equation-485bbe56-7513-472b-8fcc-3fd7157b4877");katex.render("  \\tilde{m}_{i,j} = \\left\\{\\begin{array}{l l}     m_{i,j} \\,, & i \\notin \\mathcal{I}_\\text{Dirichlet}\\\\     1 \\,,       & i \\in \\mathcal{I}_\\text{Dirichlet}, \\quad j = i\\\\     0 \\,,       & i \\in \\mathcal{I}_\\text{Dirichlet}, \\quad j \\ne i     \\end{array}\\right. \\,,", element, {displayMode:true,throwOnError:false});</script></span> <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-90e043e4-e3e8-4235-8a7c-494fbc7c067d"></span><span class="moose-katex-equation-number">(5)</span><script>var element = document.getElementById("moose-equation-90e043e4-e3e8-4235-8a7c-494fbc7c067d");katex.render("   \\tilde{b}_i = \\left\\{\\begin{array}{l l}     b_i \\,,                              & i \\notin \\mathcal{I}_\\text{Dirichlet}\\\\     g_i^{(s)} - u_i^{(s-1)} \\,, & i \\in \\mathcal{I}_\\text{Dirichlet}     \\end{array}\\right. \\,,", element, {displayMode:true,throwOnError:false});</script></span> where <span class="moose-katex-inline-equation" id="moose-equation-ad7eed1b-f211-4b5b-b679-74ec86dd9e2d"><script>var element = document.getElementById("moose-equation-ad7eed1b-f211-4b5b-b679-74ec86dd9e2d");katex.render("g_i^{(s)}", element, {displayMode:false,throwOnError:false});</script></span> is an appropriate value to impose for degree of freedom <span class="moose-katex-inline-equation" id="moose-equation-07ce249c-ed71-4b83-8aba-5babe239d428"><script>var element = document.getElementById("moose-equation-07ce249c-ed71-4b83-8aba-5babe239d428");katex.render("i", element, {displayMode:false,throwOnError:false});</script></span> in stage <span class="moose-katex-inline-equation" id="moose-equation-7c5fc6d0-191a-47d9-8bc1-0dad698f3b2f"><script>var element = document.getElementById("moose-equation-7c5fc6d0-191a-47d9-8bc1-0dad698f3b2f");katex.render("s", element, {displayMode:false,throwOnError:false});</script></span>. For most cases, this is simply <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-5ab009f3-3e9f-4f86-8759-47bd1831ec00"></span><script>var element = document.getElementById("moose-equation-5ab009f3-3e9f-4f86-8759-47bd1831ec00");katex.render("  g_i^{(s)} = g(\\mathbf{x}_i, t^{n+1}) \\,.", element, {displayMode:true,throwOnError:false});</script></span> However, in general, certain conditions must be enforced on the imposed boundary values for intermediate stages to preserve the formal order of accuracy of the method. For methods up to order 2, it is safe to impose each stage as shown above. For the 3rd-order method, the boundary values imposed in each stage should be as follows, according to <a href="#zhao2019">Zhao and Huang (2019)</a>: <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-fad1728f-79f3-4e68-8e39-e510e06cadae"></span><script>var element = document.getElementById("moose-equation-fad1728f-79f3-4e68-8e39-e510e06cadae");katex.render("  u_i^{(1)} = g(\\mathbf{x}_i, t^n) + \\Delta t g'(\\mathbf{x}_i, t^n) \\,,", element, {displayMode:true,throwOnError:false});</script></span> <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-b3414717-47c3-4c91-8ec5-3f5c8676ba84"></span><script>var element = document.getElementById("moose-equation-b3414717-47c3-4c91-8ec5-3f5c8676ba84");katex.render("  u_i^{(2)} = g(\\mathbf{x}_i, t^n) + \\frac{1}{2}\\Delta t g'(\\mathbf{x}_i, t^n)     + \\frac{1}{4} \\Delta t^2 g''(\\mathbf{x}_i, t^n) \\,,", element, {displayMode:true,throwOnError:false});</script></span> <span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-0cd73015-c544-49c8-b651-d943ee972822"></span><script>var element = document.getElementById("moose-equation-0cd73015-c544-49c8-b651-d943ee972822");katex.render("  u_i^{(3)} = g(\\mathbf{x}_i, t^{n+1}) \\,.", element, {displayMode:true,throwOnError:false});</script></span></p><p>The convergence rates for a MMS problem with time-dependent Dirichlet boundary conditions is shown in <a href="#ssprk_convergence_with_bc">Figure 1</a>. This illustrates the degradation of the 3rd-order method to 1st-order accuracy in the presence of time-dependent Dirichlet boundary conditions. Contrast this to <a href="#ssprk_convergence_no_bc">Figure 2</a>, which shows the results for an MMS problem without time-dependent Dirichlet boundary conditions, demonstrating the expected orders of accuracy.</p><div class="card moose-float" style="width:100%;padding:20px;" id="ssprk_convergence_with_bc"><div class="card-content"><picture class="materialboxed moose-image"><img src="../../media/time_integrators/ssprk_convergence_with_bc.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 1: </span><span class="moose-caption-text" id="ssprk_convergence_with_bc">Convergence rates for SSPRK methods on an MMS problem with          time-dependent Dirichlet boundary conditions</span></p></div></div><div class="card moose-float" style="width:100%;padding:20px;" id="ssprk_convergence_no_bc"><div class="card-content"><picture class="materialboxed moose-image"><img src="../../media/time_integrators/ssprk_convergence_no_bc.png"></img></picture><p class="moose-caption"><span class="moose-caption-heading">Figure 2: </span><span class="moose-caption-text" id="ssprk_convergence_no_bc">Convergence rates for SSPRK methods on an MMS problem without          time-dependent Dirichlet boundary conditions</span></p></div></div></section><section class="scrollspy" id="e01d2357-3a32-4d39-8263-1c2ed1ff2fb6" data-section-level="2" data-section-text="Implementation"><h2 id="implementation">Implementation</h2><p><a href="#moose-equation-b2a0d3e9-d131-43cb-9e08-6326fbf02e39">Eq. (3)</a> is implemented as described in the following sections:</p><section id="f06fed0d-5911-4c7c-9c1d-c05c0ebbc5a6" data-section-level="3" data-section-text="computeTimeDerivatives()"><h3><code>computeTimeDerivatives()</code></h3><p>Only the Jacobian <code>_du_dot_du</code> is implemented, which is needed by the mass matrix. The time derivative itself is not needed because only part of it appears in the residual vector.</p></section><section id="768786cf-e37d-4dc1-affc-836e79fa59f0" data-section-level="3" data-section-text="solveStage()"><h3><code>solveStage()</code></h3><p>First the mass matrix is computed by calling <code>computeJacobianTag()</code> with the time tag. Because the mass matrix is computed before the call <code>computeResidual()</code>, the call to <code>computeTimeDerivatives()</code> must be made before <code>computeJacobianTag()</code>, even though it will be called again in <code>computeResidual()</code>. The Jacobian must be computed before the call to <code>computeResidual()</code> because the mass matrix will be used in <code>computeResidual()</code> via the call to <code>postResidual()</code>. In <code>computeResidual()</code>, the following steps occur:</p><ul class="browser-default"><li><p>The steady-state residual <span class="moose-katex-inline-equation" id="moose-equation-66e4db24-44f7-4c18-a02b-c429f788c76f"><script>var element = document.getElementById("moose-equation-66e4db24-44f7-4c18-a02b-c429f788c76f");katex.render("\\mathbf{f}\\left(\\mathbf{u}^{(s-1)}, t^n + c_s\\Delta t\\right)", element, {displayMode:false,throwOnError:false});</script></span> is computed. </p></li><li><p><code>postResidual()</code> is called, which adds the mass matrix product shown in <a href="#moose-equation-61e5d343-c1f7-4e41-b034-b3eea062e990">Eq. (4)</a>. </p></li><li><p>Dirichlet boundary condition modifications are made to the residual as shown in <a href="#moose-equation-90e043e4-e3e8-4235-8a7c-494fbc7c067d">Eq. (5)</a>.</p></li></ul></section><section id="54390cb1-4ad9-42db-a7e5-fbb31a93198c" data-section-level="3" data-section-text="postResidual()"><h3><code>postResidual()</code></h3><p>Here <span class="moose-katex-inline-equation" id="moose-equation-67dd59fa-e548-47b5-aadc-e3e71ca96c45"><script>var element = document.getElementById("moose-equation-67dd59fa-e548-47b5-aadc-e3e71ca96c45");katex.render("\\mathbf{b}", element, {displayMode:false,throwOnError:false});</script></span> is assembled as shown in <a href="#moose-equation-61e5d343-c1f7-4e41-b034-b3eea062e990">Eq. (4)</a>. The mass matrix product here is responsible for the need to call <code>computeJacobianTag()</code> before <code>computeResidual()</code> in <code>solveStage()</code>.</p></section></section><section class="scrollspy" id="ca0011e5-cd1c-413b-86c8-fd7d5fb38087" data-section-level="2" data-section-text="Input Parameters"><h2 id="input-parameters">Input Parameters</h2><section id="54179ca2-e7c0-4db2-9dd1-8f5527afc7e9" data-section-level="3" data-section-text="Required Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">order</span><span class="moose-parameter-header-description">Order of time integration</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MooseEnum</p><p class="moose-parameter-description-options"><span>Options:</span>1, 2, 3</p><p class="moose-parameter-description"><span>Description:</span>Order of time integration</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Required Parameters</h3></summary></details></section><section id="cdf7b6b9-6794-4f68-890a-71c60d68f997" data-section-level="3" data-section-text="Optional Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">solve_type</span><span class="moose-parameter-header-default">consistent</span><span class="moose-parameter-header-description">The way to solve the system.  A 'consistent' solve uses the full mass matrix and actually needs to use a linear solver to solve the problem.  'lumped' uses a lumped mass matrix with a simple inversion - incredibly fast but may be less accurate.  'lump_preconditioned' uses the lumped mass matrix as a preconditioner for the 'consistent' solve</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>consistent</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MooseEnum</p><p class="moose-parameter-description-options"><span>Options:</span>consistent, lumped, lump_preconditioned</p><p class="moose-parameter-description"><span>Description:</span>The way to solve the system.  A 'consistent' solve uses the full mass matrix and actually needs to use a linear solver to solve the problem.  'lumped' uses a lumped mass matrix with a simple inversion - incredibly fast but may be less accurate.  'lump_preconditioned' uses the lumped mass matrix as a preconditioner for the 'consistent' solve</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Optional Parameters</h3></summary></details></section><section id="4b529a9d-33a6-43de-bfb8-57ab3f66b315" data-section-level="3" data-section-text="Advanced Parameters" data-details-open="close"><details class="moose-section-content"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">control_tags</span><span class="moose-parameter-header-description">Adds user-defined labels for accessing object parameters via control logic.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;std::string&gt;</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Adds user-defined labels for accessing object parameters via control logic.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">enable</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Set the enabled status of the MooseObject.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Set the enabled status of the MooseObject.</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Advanced Parameters</h3></summary></details></section></section><section class="scrollspy" id="0a3ea8ee-f6bb-4818-b8b2-6d7b09cf9f45" data-section-level="2" data-section-text="References"><h2 id="references">References</h2><div class="moose-bibliography"><ol><li id="gottlieb2005">Sigal Gottlieb.
On high order strong stability preserving runge-kutta and multi step time discretizations.
<em>Journal of Scientific Computing</em>, November 2005.
<a href="https://doi.org/10.1007/s10915-004-4635-5">doi:10.1007/s10915-004-4635-5</a>.<a href="#5cb81ae0-45d6-4c9d-a975-6d878b6fb8e7" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="5cb81ae0-45d6-4c9d-a975-6d878b6fb8e7"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{gottlieb2005,
    author = "Gottlieb, Sigal",
    title = "On High Order Strong Stability Preserving Runge-Kutta and Multi Step Time Discretizations",
    journal = "Journal of Scientific Computing",
    volume = "25",
    number = "1/2",
    month = "November",
    year = "2005",
    doi = "10.1007/s10915-004-4635-5"
}
</code></pre></div></div></li><li id="zhao2019">Weifeng <span class="bibtex-protected">Zhao</span> and Juntao <span class="bibtex-protected">Huang</span>.
<span class="bibtex-protected">Boundary treatment of implicit-explicit Runge-Kutta method for hyperbolic systems with source terms</span>.
<em>arXiv e-prints</em>, pages arXiv:1908.01027, Aug 2019.
<a href="https://arxiv.org/abs/1908.01027">arXiv:1908.01027</a>.<a href="#020b9f7b-4203-4d17-be9e-a52e8c0387dd" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="020b9f7b-4203-4d17-be9e-a52e8c0387dd"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{zhao2019,
    author = "{Zhao}, Weifeng and {Huang}, Juntao",
    title = "{Boundary treatment of implicit-explicit Runge-Kutta method for hyperbolic systems with source terms}",
    journal = "arXiv e-prints",
    keywords = "Mathematics - Numerical Analysis",
    year = "2019",
    month = "Aug",
    eid = "arXiv:1908.01027",
    pages = "arXiv:1908.01027",
    archivePrefix = "arXiv",
    eprint = "1908.01027",
    primaryClass = "math.NA",
    adsurl = "https://ui.adsabs.harvard.edu/abs/2019arXiv190801027Z",
    adsnote = "Provided by the SAO/NASA Astrophysics Data System"
}
</code></pre></div></div></li></ol></div></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#4a9b6a0e-3702-423c-abac-9b0af6c48afd" class="tooltipped" data-position="left" data-tooltip="Introduction">Introduction</a></li><li><a href="#d57375da-af10-4423-a79d-38ec64539451" class="tooltipped" data-position="left" data-tooltip="Formulation">Formulation</a></li><li><a href="#63f5158a-62c3-4996-98ce-7b318abaa1e1" class="tooltipped" data-position="left" data-tooltip="Dirichlet Boundary Conditions Treatment">Dirichlet Boundary Conditions Treatment</a></li><li><a href="#e01d2357-3a32-4d39-8263-1c2ed1ff2fb6" class="tooltipped" data-position="left" data-tooltip="Implementation">Implementation</a></li><li><a href="#ca0011e5-cd1c-413b-86c8-fd7d5fb38087" class="tooltipped" data-position="left" data-tooltip="Input Parameters">Input Parameters</a></li><li><a href="#0a3ea8ee-f6bb-4818-b8b2-6d7b09cf9f45" class="tooltipped" data-position="left" data-tooltip="References">References</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>