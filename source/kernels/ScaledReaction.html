<!DOCTYPE html><head><meta charset="UTF-8"><title>ScaledReaction | Zapdos</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/zapdos.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Zapdos</a><a href="https://github.com/shannon-lab/zapdos" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="a7e2a4f4-6fd1-43ee-ae91-3c1dbf4bbfab" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="55541c5d-c2f6-4b9d-90b0-10dc88d4fede" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="19277a6b-1603-4cd3-92a8-ccfdd3482ddd" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../citing.html">Citing</a></li></ul><a href="#" class="sidenav-trigger" data-target="0f521c87-6ff7-4528-b8e6-7bd0a2bcf87d"><i class="material-icons">menu</i></a><ul class="sidenav" id="0f521c87-6ff7-4528-b8e6-7bd0a2bcf87d"><li><a href="#!" class="dropdown-trigger" data-target="774875fc-2b40-463f-9b05-861d3cbb56d0" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="49e0093e-68dd-4935-9738-1913add0b757" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="f85c62d1-7b6b-4b82-9663-207d680289b0" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../citing.html">Citing</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="a7e2a4f4-6fd1-43ee-ae91-3c1dbf4bbfab"><li><a href="../../getting_started/installation.html">Installation</a></li><li><a href="../../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../../getting_started/zapdos_meshing.html">Generating Meshes</a></li></ul><ul class="dropdown-content" id="55541c5d-c2f6-4b9d-90b0-10dc88d4fede"><li><a href="../../syntax/index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../../development/contributing.html">Contributing Guidelines</a></li><li><a href="../../development/code_standards.html">Code Standards</a></li><li><a href="../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="19277a6b-1603-4cd3-92a8-ccfdd3482ddd"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul><ul class="dropdown-content" id="774875fc-2b40-463f-9b05-861d3cbb56d0"><li><a href="../../getting_started/installation.html">Installation</a></li><li><a href="../../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../../getting_started/zapdos_meshing.html">Generating Meshes</a></li></ul><ul class="dropdown-content" id="49e0093e-68dd-4935-9738-1913add0b757"><li><a href="../../syntax/index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../../development/contributing.html">Contributing Guidelines</a></li><li><a href="../../development/code_standards.html">Code Standards</a></li><li><a href="../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="f85c62d1-7b6b-4b82-9663-207d680289b0"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">source</a><span class="breadcrumb">kernels</span><a href="#" class="breadcrumb">ScaledReaction</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="472dc234-b90f-4111-bf42-4c135f2e211d" data-section-level="1" data-section-text="ScaledReaction"><h1 id="scaledreaction">ScaledReaction</h1><div class="card moose-alert moose-alert-construction"><div class="card-title moose-alert-title"><i class="material-icons moose-inline-icon">build</i><span class="moose-alert-title-brand">construction:</span>Undocumented Class</div><div class="card-content"><div class="moose-alert-content"><p>The ScaledReaction has not been documented. The content listed below should be used as a starting point for documenting the class, which includes the typical automatic documentation associated with a MooseObject; however, what is contained is ultimately determined by what is necessary to make the documentation clear for users.</p></div></div></div><p>The multiple of a given variable(Used for calculating the effective ion potential for a given collision frequency)</p><section class="scrollspy" id="0463cb71-142e-4267-8a11-b28044ba9583" data-section-level="2" data-section-text="Overview"><h2 id="overview">Overview</h2><p></p></section><section class="scrollspy" id="e21538a8-de5f-48af-978f-933302dd872a" data-section-level="2" data-section-text="Example Input File Syntax"><h2 id="example-input-file-syntax">Example Input File Syntax</h2><p></p></section><section class="scrollspy" id="7a364072-5a19-486b-a78f-a3a465066022" data-section-level="2" data-section-text="Input Parameters"><h2 id="input-parameters">Input Parameters</h2><section id="736c60b3-a56d-4328-b819-848098d814b3" data-section-level="3" data-section-text="Required Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">collision_freq</span><span class="moose-parameter-header-description">The ion-neutral collision frequency.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>double</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The ion-neutral collision frequency.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">variable</span><span class="moose-parameter-header-description">The name of the variable that this residual object operates on</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>NonlinearVariableName</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The name of the variable that this residual object operates on</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Required Parameters</h3></summary></details></section><section id="1644f8ae-c6a5-4978-be5e-fba314ad5789" data-section-level="3" data-section-text="Optional Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">block</span><span class="moose-parameter-header-description">The list of blocks (ids or names) that this object will be applied</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;SubdomainName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The list of blocks (ids or names) that this object will be applied</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">displacements</span><span class="moose-parameter-header-description">The displacements</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;VariableName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The displacements</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">prop_getter_suffix</span><span class="moose-parameter-header-description">An optional suffix parameter that can be appended to any attempt to retrieve/get material properties. The suffix will be prepended with a '_' character.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MaterialPropertyName</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>An optional suffix parameter that can be appended to any attempt to retrieve/get material properties. The suffix will be prepended with a '_' character.</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Optional Parameters</h3></summary></details></section><section id="57f508c4-ede4-493b-9a42-787f1acc8142" data-section-level="3" data-section-text="Advanced Parameters" data-details-open="close"><details class="moose-section-content"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">control_tags</span><span class="moose-parameter-header-description">Adds user-defined labels for accessing object parameters via control logic.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;std::string&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Adds user-defined labels for accessing object parameters via control logic.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">diag_save_in</span><span class="moose-parameter-header-description">The name of auxiliary variables to save this Kernel's diagonal Jacobian contributions to. Everything about that variable must match everything about this variable (the type, what blocks it's on, etc.)</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;AuxVariableName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The name of auxiliary variables to save this Kernel's diagonal Jacobian contributions to. Everything about that variable must match everything about this variable (the type, what blocks it's on, etc.)</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">enable</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Set the enabled status of the MooseObject.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>Yes</p><p class="moose-parameter-description"><span>Description:</span>Set the enabled status of the MooseObject.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">implicit</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Determines whether this object is calculated using an implicit or explicit form</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Determines whether this object is calculated using an implicit or explicit form</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">save_in</span><span class="moose-parameter-header-description">The name of auxiliary variables to save this Kernel's residual contributions to.  Everything about that variable must match everything about this variable (the type, what blocks it's on, etc.)</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;AuxVariableName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The name of auxiliary variables to save this Kernel's residual contributions to.  Everything about that variable must match everything about this variable (the type, what blocks it's on, etc.)</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">seed</span><span class="moose-parameter-header-default">0</span><span class="moose-parameter-header-description">The seed for the master random number generator</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>0</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>unsigned int</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The seed for the master random number generator</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">use_displaced_mesh</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">Whether or not this object should use the displaced mesh for computation. Note that in the case this is true but no displacements are provided in the Mesh block the undisplaced mesh will still be used.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Whether or not this object should use the displaced mesh for computation. Note that in the case this is true but no displacements are provided in the Mesh block the undisplaced mesh will still be used.</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Advanced Parameters</h3></summary></details></section><section id="e3dade75-f5fb-4ffc-ba64-708206638826" data-section-level="3" data-section-text="Tagging Parameters" data-details-open="close"><details class="moose-section-content"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">extra_matrix_tags</span><span class="moose-parameter-header-description">The extra tags for the matrices this Kernel should fill</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;TagName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The extra tags for the matrices this Kernel should fill</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">extra_vector_tags</span><span class="moose-parameter-header-description">The extra tags for the vectors this Kernel should fill</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;TagName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The extra tags for the vectors this Kernel should fill</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">matrix_tags</span><span class="moose-parameter-header-default">system</span><span class="moose-parameter-header-description">The tag for the matrices this Kernel should fill</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>system</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MultiMooseEnum</p><p class="moose-parameter-description-options"><span>Options:</span>nontime, system</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The tag for the matrices this Kernel should fill</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">vector_tags</span><span class="moose-parameter-header-default">nontime</span><span class="moose-parameter-header-description">The tag for the vectors this Kernel should fill</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>nontime</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MultiMooseEnum</p><p class="moose-parameter-description-options"><span>Options:</span>nontime, time</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The tag for the vectors this Kernel should fill</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Tagging Parameters</h3></summary></details></section></section><section class="scrollspy" id="de21fdc9-e134-4cb9-bc91-7bcfffeec4c5" data-section-level="2" data-section-text="Input Files"><h2 id="input-files">Input Files</h2><ul class="moose-list-inputs browser-default"><li><a class="moose-source-filename tooltipped modal-trigger" href="#c66de4c4-9cd4-46d3-924e-814e0e733616">(test/tests/DriftDiffusionAction/2D_RF_Plasma_no_actions.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#19d78214-66e5-4a27-88f6-6c2af2849135">(test/tests/Lymberopoulos_rf_discharge/Lymberopoulos_with_argon_metastables_2D_At100mTorr_CoarseMesh.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#0747c7be-7c67-4224-9607-9aa1d7741520">(test/tests/Conference_Syntax_Tests/Lymberopoulos_with_argon_metastables_2D_At100mTorr.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#beece77b-8e0a-4520-9b7e-e00b3a15a655">(test/tests/Conference_Syntax_Tests/Lymberopoulos_with_argon_metastables_2D_At1Torr.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#c3bf02fa-7091-4279-8e27-af8f96e02ea5">(test/tests/DriftDiffusionAction/2D_RF_Plasma_actions.i)</a></li></ul></section></section><div class="moose-modal modal" id="c66de4c4-9cd4-46d3-924e-814e0e733616"><div class="modal-content"><h4>(test/tests/DriftDiffusionAction/2D_RF_Plasma_no_actions.i)</h4><pre class="moose-pre"><code class="language-text">#This is the input file that supplied the gold output file.
#It is the same as the input file in
#tests/Lymberopoulos_rf_discharge/Lymberopoulos_with_argon_metastables_2D_At100mTorr_CoarseMesh.i,
#execpt some of the Aux Variables are renamed for the Action test

dom0Scale=25.4e-3

[GlobalParams]
  potential_units = V
  use_moles = true
[]

[Mesh]
  type = FileMesh
  file = &#x27;GEC_mesh_coarse.msh&#x27;
  coord_type = RZ
  rz_coord_axis = Y
[]

[Variables]
  [./em]
  [../]

  [./Ar+]
  [../]

  [./Ar*]
  [../]

  [./mean_en]
  [../]

  [./potential]
  [../]

  [./potential_ion]
  [../]
[]

[Kernels]
  #Electron Equations (Same as in paper)
    #Time Derivative term of electron
    [./em_time_deriv]
      type = ElectronTimeDerivative
      variable = em
    [../]
    #Advection term of electron
    [./em_advection]
      type = EFieldAdvection
      variable = em
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons
    [./em_diffusion]
      type = CoeffDiffusion
      variable = em
      position_units = ${dom0Scale}
    [../]
    #Net electron production from ionization
    [./em_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      target = Ar
      mean_energy = mean_en
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from step-wise ionization
    [./em_stepwise_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      target = Ar*
      mean_energy = mean_en
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from metastable pooling
    [./em_pooling]
      type = ReactionSecondOrderLog
      variable = em
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

  #Argon Ion Equations (Same as in paper)
    #Time Derivative term of the ions
    [./Ar+_time_deriv]
      type = ElectronTimeDerivative
      variable = Ar+
    [../]
    #Advection term of ions
    [./Ar+_advection]
      type = EFieldAdvection
      variable = Ar+
      potential = potential_ion
      position_units = ${dom0Scale}
    [../]
    [./Ar+_diffusion]
      type = CoeffDiffusion
      variable = Ar+
      position_units = ${dom0Scale}
    [../]
    #Net ion production from ionization
    [./Ar+_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      target = Ar
      mean_energy = mean_en
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from step-wise ionization
    [./Ar+_stepwise_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      target = Ar*
      mean_energy = mean_en
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from metastable pooling
    [./Ar+_pooling]
      type = ReactionSecondOrderLog
      variable = Ar+
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

    #Argon Excited Equations (Same as in paper)
      #Time Derivative term of excited Argon
      [./Ar*_time_deriv]
        type = ElectronTimeDerivative
        variable = Ar*
      [../]
      #Diffusion term of excited Argon
      [./Ar*_diffusion]
        type = CoeffDiffusion
        variable = Ar*
        position_units = ${dom0Scale}
      [../]
      #Net excited Argon production from excitation
      [./Ar*_excitation]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar
        mean_energy = mean_en
        reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
        coefficient = 1
      [../]
      #Net excited Argon loss from step-wise ionization
      [./Ar*_stepwise_ionization]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from superelastic collisions
      [./Ar*_collisions]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from quenching to resonant
      [./Ar*_quenching]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from  metastable pooling
      [./Ar*_pooling]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar*
        reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
        coefficient = -2
        _v_eq_u = true
        _w_eq_u = true
      [../]
      #Net excited Argon loss from two-body quenching
      [./Ar*_2B_quenching]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]
      #Net excited Argon loss from three-body quenching
      [./Ar*_3B_quenching]
        type = ReactionThirdOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        x = Ar
        reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]

  #Voltage Equations (Same as in paper)
    #Voltage term in Poissons Eqaution
    [./potential_diffusion_dom0]
      type = CoeffDiffusionLin
      variable = potential
      position_units = ${dom0Scale}
    [../]
    #Ion term in Poissons Equation
    [./Ar+_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = Ar+
    [../]
    #Electron term in Poissons Equation
    [./em_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = em
    [../]


  #Since the paper uses electron temperature as a variable, the energy equation is in
  #a different form but should be the same physics
    #Time Derivative term of electron energy
    [./mean_en_time_deriv]
      type = ElectronTimeDerivative
      variable = mean_en
    [../]
    #Advection term of electron energy
    [./mean_en_advection]
      type = EFieldAdvection
      variable = mean_en
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons energy
    [./mean_en_diffusion]
      type = CoeffDiffusion
      variable = mean_en
      position_units = ${dom0Scale}
    [../]
    #Joule Heating term
    [./mean_en_joule_heating]
      type = JouleHeating
      variable = mean_en
      potential = potential
      em = em
      position_units = ${dom0Scale}
    [../]
    #Energy loss from ionization
    [./Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      threshold_energy = -15.7
    [../]
    #Energy loss from excitation
    [./Excitation_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
      threshold_energy = -11.56
    [../]
    #Energy loss from step-wise ionization
    [./Stepwise_Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      threshold_energy = -4.14
    [../]
    #Energy gain from superelastic collisions
    [./Collisions_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
      threshold_energy = 11.56
    [../]
    # Energy loss from elastic collisions
    [./Elastic_loss]
      type = EEDFElasticLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + Ar&#x27;
    [../]

    #Effective potential for the Ions
    [./Ion_potential_time_deriv]
      type = TimeDerivative
      variable = potential_ion
    [../]
    [./Ion_potential_reaction]
      type = ScaledReaction
      variable = potential_ion
      collision_freq = 1283370.875
    [../]
    [./Ion_potential_coupled_force]
      type = CoupledForce
      variable = potential_ion
      v = potential
      coef = 1283370.875
    [../]
  []


[AuxVariables]
  [./e_temp]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./x_position]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./x_node]
  [../]

  [./y_position]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./y_node]
  [../]

  [./rho]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./em_density]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar+_density]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar*_density]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar]
  [../]

  [./Efieldx]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./Efieldy]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Current_em]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./Current_Ar+]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./emRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./exRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./swRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./deexRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./quRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./poolRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./TwoBRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./ThreeBRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]

[]

[AuxKernels]
  [./emRate]
    type = ProcRateForRateCoeff
    variable = emRate
    v = em
    w = Ar
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
  [../]
  [./exRate]
    type = ProcRateForRateCoeff
    variable = exRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
  [../]
  [./swRate]
    type = ProcRateForRateCoeff
    variable = swRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
  [../]
  [./deexRate]
    type = ProcRateForRateCoeff
    variable = deexRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
  [../]
  [./quRate]
    type = ProcRateForRateCoeff
    variable = quRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
  [../]
  [./poolRate]
    type = ProcRateForRateCoeff
    variable = poolRate
    v = Ar*
    w = Ar*
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
  [../]
  [./TwoBRate]
    type = ProcRateForRateCoeff
    variable = TwoBRate
    v = Ar*
    w = Ar
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
  [../]
  [./ThreeBRate]
    type = ProcRateForRateCoeffThreeBody
    variable = ThreeBRate
    v = Ar*
    w = Ar
    vv = Ar
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
  [../]
  [./e_temp]
    type = ElectronTemperature
    variable = e_temp
    electron_density = em
    mean_en = mean_en
  [../]
  [./x_g]
    type = Position
    variable = x_position
    component = 0
    position_units = ${dom0Scale}
  [../]
  [./x_ng]
    type = Position
    variable = x_node
    component = 0
    position_units = ${dom0Scale}
  [../]

  [./y_g]
    type = Position
    variable = y_position
    component = 1
    position_units = ${dom0Scale}
  [../]
  [./y_ng]
    type = Position
    variable = y_node
    component = 1
    position_units = ${dom0Scale}
  [../]

  [./em_density]
    type = DensityMoles
    variable = em_density
    density_log = em
  [../]
  [./Ar+_density]
    type = DensityMoles
    variable = Ar+_density
    density_log = Ar+
  [../]
  [./Ar*_density]
    type = DensityMoles
    variable = Ar*_density
    density_log = Ar*
  [../]

  [./Ar_val]
    type = ConstantAux
    variable = Ar
    # value = 3.22e2
    value = -5.231208
    execute_on = INITIAL
  [../]

  [./Efieldx_calc]
    type = Efield
    component = 0
    potential = potential
    variable = Efieldx
    position_units = ${dom0Scale}
  [../]
  [./Efieldy_calc]
    type = Efield
    component = 1
    potential = potential
    variable = Efieldy
    position_units = ${dom0Scale}
  [../]

  [./Current_em]
    type = ADCurrent
    potential = potential
    density_log = em
    variable = Current_em
    art_diff = false
    block = &#x27;plasma&#x27;
    position_units = ${dom0Scale}
  [../]
  [./Current_Ar]
    type = ADCurrent
    potential = potential_ion
    density_log = Ar+
    variable = Current_Ar+
    art_diff = false
    block = &#x27;plasma&#x27;
    position_units = ${dom0Scale}
  [../]

[]


[BCs]
#Voltage Boundary Condition, same as in paper
  [./potential_top_plate]
    type = FunctionDirichletBC
    variable = potential
    boundary = &#x27;Top_Electrode&#x27;
    function = potential_top_bc_func
  [../]
  [./potential_bottom_plate]
    type = FunctionDirichletBC
    variable = potential
    boundary = &#x27;Bottom_Electrode&#x27;
    function = potential_bottom_bc_func
  [../]
  [./potential_dirichlet_bottom_plate]
    type = DirichletBC
    variable = potential
    boundary = &#x27;Walls&#x27;
    value = 0
  [../]
  [./potential_Dielectric]
    type = EconomouDielectricBC
    variable = potential
    boundary = &#x27;Top_Insulator Bottom_Insulator&#x27;
    em = em
    ip = Ar+
    potential_ion = potential_ion
    mean_en = mean_en
    dielectric_constant = 1.859382e-11
    thickness = 0.0127
    users_gamma = 0.01
    position_units = ${dom0Scale}
  [../]


#New Boundary conditions for electons, same as in paper
  [./em_physical_diffusion]
    type = SakiyamaElectronDiffusionBC
    variable = em
    mean_en = mean_en
    boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
    position_units = ${dom0Scale}
  [../]
  [./em_Ar+_second_emissions]
    type = SakiyamaSecondaryElectronBC
    variable = em
    potential = potential_ion
    ip = Ar+
    users_gamma = 0.01
    boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
  [./Ar+_physical_advection]
    type = SakiyamaIonAdvectionBC
    variable = Ar+
    potential = potential_ion
    boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
#(except the metastables are not set to zero, since Zapdos uses log form)
  [./Ar*_physical_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
    value = 100
  [../]

#New Boundary conditions for mean energy, should be the same as in paper
[./mean_en_physical_diffusion]
  type = SakiyamaEnergyDiffusionBC
  variable = mean_en
  em = em
  boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
  position_units = ${dom0Scale}
[../]
[./mean_en_Ar+_second_emissions]
  type = SakiyamaEnergySecondaryElectronBC
  variable = mean_en
  em = em
  ip = Ar+
  potential = potential_ion
  Tse_equal_Te = true
  se_coeff = 0.01
  boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
  position_units = ${dom0Scale}
[../]

[]


[ICs]
  [./em_ic]
    type = FunctionIC
    variable = em
    function = density_ic_func
  [../]
  [./Ar+_ic]
    type = FunctionIC
    variable = Ar+
    function = density_ic_func
  [../]
  [./Ar*_ic]
    type = FunctionIC
    variable = Ar*
    function = meta_density_ic_func
  [../]
  [./mean_en_ic]
    type = FunctionIC
    variable = mean_en
    function = energy_density_ic_func
  [../]

  [./potential_ic]
    type = FunctionIC
    variable = potential
    function = potential_ic_func
  [../]
[]

[Functions]
  [./potential_top_bc_func]
    type = ParsedFunction
    value = &#x27;50*sin(2*3.1415926*13.56e6*t)&#x27;
  [../]
  [./potential_bottom_bc_func]
    type = ParsedFunction
    value = &#x27;-50*sin(2*3.1415926*13.56e6*t)&#x27;
  [../]
  [./potential_ic_func]
    type = ParsedFunction
    value = 0
  [../]
  [./density_ic_func]
    type = ParsedFunction
    value = &#x27;log((1e14)/6.022e23)&#x27;
  [../]
  [./meta_density_ic_func]
    type = ParsedFunction
    value = &#x27;log((1e16)/6.022e23)&#x27;
  [../]
  [./energy_density_ic_func]
    type = ParsedFunction
    value = &#x27;log((3./2.) * 4) + log((1e14)/6.022e23)&#x27;
  [../]
[]

[Materials]
  [./GasBasics]
    type = GasElectronMoments
    interp_trans_coeffs = true
    interp_elastic_coeff = false
    ramp_trans_coeffs = false
    user_p_gas = 133.322
    em = em
    potential = potential
    mean_en = mean_en
    user_se_coeff = 0.00
    property_tables_file = Argon_reactions_paper_RateCoefficients/electron_moments.txt
  [../]
  [./gas_species_0]
    type = ADHeavySpecies
    heavy_species_name = Ar+
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 1.0
    mobility = 1.44409938
    diffusivity = 6.428571e-2
  [../]
  [./gas_species_1]
    type = ADHeavySpecies
    heavy_species_name = Ar*
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
    diffusivity = 7.515528e-2
  [../]
  [./gas_species_2]
    type = ADHeavySpecies
    heavy_species_name = Ar
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
  [../]
  [./reaction_00]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_elastic.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + Ar&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_0]
    type = ZapdosEEDFRateConstant
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_excitation.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
    file_location = &#x27;&#x27;
    mean_energy = mean_en
    electrons = em
  [../]
  [./reaction_1]
    type = ZapdosEEDFRateConstant
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_ionization.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    mean_energy = mean_en
    electrons = em
  [../]
  [./reaction_2]
    type = ZapdosEEDFRateConstant
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_deexcitation.txt&#x27;
    file_location = &#x27;&#x27;
    mean_energy = mean_en
    electrons = em
  [../]
  [./reaction_3]
    type = ZapdosEEDFRateConstant
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_excited_ionization.txt&#x27;
    file_location = &#x27;&#x27;
    mean_energy = mean_en
    electrons = em
  [../]
  [./reaction_4]
    type = GenericRateConstant
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
    #reaction_rate_value = 2e-13
    reaction_rate_value = 1.2044e11
  [../]
  [./reaction_5]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
    #reaction_rate_value = 6.2e-16
    reaction_rate_value = 373364000
  [../]
  [./reaction_6]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
    #reaction_rate_value = 3e-21
    reaction_rate_value = 1806.6
  [../]
  [./reaction_7]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
    #reaction_rate_value = 1.1e-42
    reaction_rate_value = 398909.324
  [../]
[]

#New postprocessor that calculates the inverse of the plasma frequency
[Postprocessors]
  [./InversePlasmaFreq]
    type = PlasmaFrequencyInverse
    variable = em
    use_moles = true
    execute_on = &#x27;INITIAL TIMESTEP_BEGIN&#x27;
  [../]
[]


[Preconditioning]
  active = &#x27;smp&#x27;
  [./smp]
    type = SMP
    full = true
  [../]

  [./fdp]
    type = FDP
    full = true
  [../]
[]


[Executioner]
  type = Transient
  #end_time = 7.4e-3
  end_time = 1e-7
  dtmax = 1e-9
  petsc_options = &#x27;-snes_converged_reason -snes_linesearch_monitor&#x27;
  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_shift_amount -ksp_type -snes_linesearch_minlambda&#x27;
  petsc_options_value = &#x27;lu NONZERO 1.e-10 fgmres 1e-3&#x27;
  nl_rel_tol = 1e-12
  #nl_abs_tol = 7.6e-5
  dtmin = 1e-14
  l_max_its = 20

  #Time steps based on the inverse of the plasma frequency
  #[./TimeStepper]
  #  type = PostprocessorDT
  #  postprocessor = InversePlasmaFreq
  #  scale = 0.1
  #[../]
[]

[Outputs]
  file_base = &#x27;2D_RF_out&#x27;
  perf_graph = true
  [./out]
    type = Exodus
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="19d78214-66e5-4a27-88f6-6c2af2849135"><div class="modal-content"><h4>(test/tests/Lymberopoulos_rf_discharge/Lymberopoulos_with_argon_metastables_2D_At100mTorr_CoarseMesh.i)</h4><pre class="moose-pre"><code class="language-text">dom0Scale=25.4e-3

[GlobalParams]
  potential_units = V
  use_moles = true
[]

[Mesh]
  type = FileMesh
  file = &#x27;GEC_mesh_coarse.msh&#x27;
  coord_type = RZ
  rz_coord_axis = Y
[]

[Variables]
  [./em]
  [../]

  [./Ar+]
  [../]

  [./Ar*]
  [../]

  [./mean_en]
  [../]

  [./potential]
  [../]

  [./potential_ion]
  [../]
[]

[Kernels]
  #Electron Equations (Same as in paper)
    #Time Derivative term of electron
    [./em_time_deriv]
      type = ElectronTimeDerivative
      variable = em
    [../]
    #Advection term of electron
    [./em_advection]
      type = EFieldAdvection
      variable = em
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons
    [./em_diffusion]
      type = CoeffDiffusion
      variable = em
      position_units = ${dom0Scale}
    [../]
    #Net electron production from ionization
    [./em_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      target = Ar
      mean_energy = mean_en
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from step-wise ionization
    [./em_stepwise_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      target = Ar*
      mean_energy = mean_en
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from metastable pooling
    [./em_pooling]
      type = ReactionSecondOrderLog
      variable = em
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

  #Argon Ion Equations (Same as in paper)
    #Time Derivative term of the ions
    [./Ar+_time_deriv]
      type = ElectronTimeDerivative
      variable = Ar+
    [../]
    #Advection term of ions
    [./Ar+_advection]
      type = EFieldAdvection
      variable = Ar+
      potential = potential_ion
      position_units = ${dom0Scale}
    [../]
    [./Ar+_diffusion]
      type = CoeffDiffusion
      variable = Ar+
      position_units = ${dom0Scale}
    [../]
    #Net ion production from ionization
    [./Ar+_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      target = Ar
      mean_energy = mean_en
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from step-wise ionization
    [./Ar+_stepwise_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      target = Ar*
      mean_energy = mean_en
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from metastable pooling
    [./Ar+_pooling]
      type = ReactionSecondOrderLog
      variable = Ar+
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

    #Argon Excited Equations (Same as in paper)
      #Time Derivative term of excited Argon
      [./Ar*_time_deriv]
        type = ElectronTimeDerivative
        variable = Ar*
      [../]
      #Diffusion term of excited Argon
      [./Ar*_diffusion]
        type = CoeffDiffusion
        variable = Ar*
        position_units = ${dom0Scale}
      [../]
      #Net excited Argon production from excitation
      [./Ar*_excitation]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar
        mean_energy = mean_en
        reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
        coefficient = 1
      [../]
      #Net excited Argon loss from step-wise ionization
      [./Ar*_stepwise_ionization]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from superelastic collisions
      [./Ar*_collisions]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from quenching to resonant
      [./Ar*_quenching]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from  metastable pooling
      [./Ar*_pooling]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar*
        reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
        coefficient = -2
        _v_eq_u = true
        _w_eq_u = true
      [../]
      #Net excited Argon loss from two-body quenching
      [./Ar*_2B_quenching]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]
      #Net excited Argon loss from three-body quenching
      [./Ar*_3B_quenching]
        type = ReactionThirdOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        x = Ar
        reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]

  #Voltage Equations (Same as in paper)
    #Voltage term in Poissons Eqaution
    [./potential_diffusion_dom0]
      type = CoeffDiffusionLin
      variable = potential
      position_units = ${dom0Scale}
    [../]
    #Ion term in Poissons Equation
    [./Ar+_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = Ar+
    [../]
    #Electron term in Poissons Equation
    [./em_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = em
    [../]


  #Since the paper uses electron temperature as a variable, the energy equation is in
  #a different form but should be the same physics
    #Time Derivative term of electron energy
    [./mean_en_time_deriv]
      type = ElectronTimeDerivative
      variable = mean_en
    [../]
    #Advection term of electron energy
    [./mean_en_advection]
      type = EFieldAdvection
      variable = mean_en
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons energy
    [./mean_en_diffusion]
      type = CoeffDiffusion
      variable = mean_en
      position_units = ${dom0Scale}
    [../]
    #Joule Heating term
    [./mean_en_joule_heating]
      type = JouleHeating
      variable = mean_en
      potential = potential
      em = em
      position_units = ${dom0Scale}
    [../]
    #Energy loss from ionization
    [./Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      threshold_energy = -15.7
    [../]
    #Energy loss from excitation
    [./Excitation_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
      threshold_energy = -11.56
    [../]
    #Energy loss from step-wise ionization
    [./Stepwise_Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      threshold_energy = -4.14
    [../]
    #Energy gain from superelastic collisions
    [./Collisions_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
      threshold_energy = 11.56
    [../]
    # Energy loss from elastic collisions
    [./Elastic_loss]
      type = EEDFElasticLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + Ar&#x27;
    [../]

    #Effective potential for the Ions
    [./Ion_potential_time_deriv]
      type = TimeDerivative
      variable = potential_ion
    [../]
    [./Ion_potential_reaction]
      type = ScaledReaction
      variable = potential_ion
      collision_freq = 1283370.875
    [../]
    [./Ion_potential_coupled_force]
      type = CoupledForce
      variable = potential_ion
      v = potential
      coef = 1283370.875
    [../]
  []


[AuxVariables]
  [./emDeBug]
  [../]
  [./Ar+_DeBug]
  [../]
  [./Ar*_DeBug]
  [../]
  [./mean_enDeBug]
  [../]
  [./potential_DeBug]
  [../]

  [./Te]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./x]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./x_node]
  [../]

  [./y]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./y_node]
  [../]

  [./rho]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./em_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar+_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar*_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar]
  [../]

  [./Efieldx]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./Efieldy]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Current_em]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./Current_Ar]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./emRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./exRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./swRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./deexRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./quRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./poolRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./TwoBRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./ThreeBRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]

[]

[AuxKernels]
  #[./emDeBug]
  #  type = DebugResidualAux
  #  variable = emDeBug
  #  debug_variable = em
  #[../]
  #[./Ar+_DeBug]
  #  type = DebugResidualAux
  #  variable = Ar+_DeBug
  #  debug_variable = Ar+
  #[../]
  #[./mean_enDeBug]
  #  type = DebugResidualAux
  #  variable = mean_enDeBug
  #  debug_variable = mean_en
  #[../]
  #[./Ar*_DeBug]
  #  type = DebugResidualAux
  #  variable = Ar*_DeBug
  #  debug_variable = Ar*
  #[../]
  #[./Potential_DeBug]
  #  type = DebugResidualAux
  #  variable = potential_DeBug
  #  debug_variable = potential
  #[../]

  [./emRate]
    type = ProcRateForRateCoeff
    variable = emRate
    v = em
    w = Ar
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
  [../]
  [./exRate]
    type = ProcRateForRateCoeff
    variable = exRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
  [../]
  [./swRate]
    type = ProcRateForRateCoeff
    variable = swRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
  [../]
  [./deexRate]
    type = ProcRateForRateCoeff
    variable = deexRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
  [../]
  [./quRate]
    type = ProcRateForRateCoeff
    variable = quRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
  [../]
  [./poolRate]
    type = ProcRateForRateCoeff
    variable = poolRate
    v = Ar*
    w = Ar*
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
  [../]
  [./TwoBRate]
    type = ProcRateForRateCoeff
    variable = TwoBRate
    v = Ar*
    w = Ar
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
  [../]
  [./ThreeBRate]
    type = ProcRateForRateCoeffThreeBody
    variable = ThreeBRate
    v = Ar*
    w = Ar
    vv = Ar
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
  [../]
  [./Te]
    type = ElectronTemperature
    variable = Te
    electron_density = em
    mean_en = mean_en
  [../]
  [./x_g]
    type = Position
    variable = x
    position_units = ${dom0Scale}
  [../]
  [./x_ng]
    type = Position
    variable = x_node
    position_units = ${dom0Scale}
  [../]

  [./y_g]
    type = Position
    variable = y
    position_units = ${dom0Scale}
  [../]
  [./y_ng]
    type = Position
    variable = y_node
    position_units = ${dom0Scale}
  [../]

  [./em_lin]
    type = DensityMoles
    variable = em_lin
    density_log = em
  [../]
  [./Ar+_lin]
    type = DensityMoles
    variable = Ar+_lin
    density_log = Ar+
  [../]
  [./Ar*_lin]
    type = DensityMoles
    variable = Ar*_lin
    density_log = Ar*
  [../]

  [./Ar_val]
    type = ConstantAux
    variable = Ar
    # value = 3.22e2
    value = -5.231208
    execute_on = INITIAL
  [../]

  [./Efieldx_calc]
    type = Efield
    component = 0
    potential = potential
    variable = Efieldx
    position_units = ${dom0Scale}
  [../]
  [./Efieldy_calc]
    type = Efield
    component = 1
    potential = potential
    variable = Efieldy
    position_units = ${dom0Scale}
  [../]

  [./Current_em]
    type = ADCurrent
    potential = potential
    density_log = em
    variable = Current_em
    art_diff = false
    block = &#x27;plasma&#x27;
    position_units = ${dom0Scale}
  [../]
  [./Current_Ar]
    type = ADCurrent
    potential = potential_ion
    density_log = Ar+
    variable = Current_Ar
    art_diff = false
    block = &#x27;plasma&#x27;
    position_units = ${dom0Scale}
  [../]

[]


[BCs]
#Voltage Boundary Condition, same as in paper
  [./potential_top_plate]
    type = FunctionDirichletBC
    variable = potential
    boundary = &#x27;Top_Electrode&#x27;
    function = potential_top_bc_func
    preset = false
  [../]
  [./potential_bottom_plate]
    type = FunctionDirichletBC
    variable = potential
    boundary = &#x27;Bottom_Electrode&#x27;
    function = potential_bottom_bc_func
    preset = false
  [../]
  [./potential_dirichlet_bottom_plate]
    type = DirichletBC
    variable = potential
    boundary = &#x27;Walls&#x27;
    value = 0
    preset = false
  [../]
  [./potential_Dielectric]
    type = EconomouDielectricBC
    variable = potential
    boundary = &#x27;Top_Insulator Bottom_Insulator&#x27;
    em = em
    ip = Ar+
    potential_ion = potential_ion
    mean_en = mean_en
    dielectric_constant = 1.859382e-11
    thickness = 0.0127
    users_gamma = 0.01
    position_units = ${dom0Scale}
  [../]


#New Boundary conditions for electons, same as in paper
  [./em_physical_diffusion]
    type = SakiyamaElectronDiffusionBC
    variable = em
    mean_en = mean_en
    boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
    position_units = ${dom0Scale}
  [../]
  [./em_Ar+_second_emissions]
    type = SakiyamaSecondaryElectronBC
    variable = em
    potential = potential_ion
    ip = Ar+
    users_gamma = 0.01
    boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
  [./Ar+_physical_advection]
    type = SakiyamaIonAdvectionBC
    variable = Ar+
    potential = potential_ion
    boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
#(except the metastables are not set to zero, since Zapdos uses log form)
  [./Ar*_physical_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
    value = 100
  [../]

#New Boundary conditions for mean energy, should be the same as in paper
[./mean_en_physical_diffusion]
  type = SakiyamaEnergyDiffusionBC
  variable = mean_en
  em = em
  boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
  position_units = ${dom0Scale}
[../]
[./mean_en_Ar+_second_emissions]
  type = SakiyamaEnergySecondaryElectronBC
  variable = mean_en
  em = em
  ip = Ar+
  potential = potential_ion
  Tse_equal_Te = true
  se_coeff = 0.01
  boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
  position_units = ${dom0Scale}
[../]

[]


[ICs]
  [./em_ic]
    type = FunctionIC
    variable = em
    function = density_ic_func
  [../]
  [./Ar+_ic]
    type = FunctionIC
    variable = Ar+
    function = density_ic_func
  [../]
  [./Ar*_ic]
    type = FunctionIC
    variable = Ar*
    function = meta_density_ic_func
  [../]
  [./mean_en_ic]
    type = FunctionIC
    variable = mean_en
    function = energy_density_ic_func
  [../]

  [./potential_ic]
    type = FunctionIC
    variable = potential
    function = potential_ic_func
  [../]
[]

[Functions]
  [./potential_top_bc_func]
    type = ParsedFunction
    value = &#x27;50*sin(2*3.1415926*13.56e6*t)&#x27;
  [../]
  [./potential_bottom_bc_func]
    type = ParsedFunction
    value = &#x27;-50*sin(2*3.1415926*13.56e6*t)&#x27;
  [../]
  [./potential_ic_func]
    type = ParsedFunction
    value = 0
  [../]
  [./density_ic_func]
    type = ParsedFunction
    value = &#x27;log((1e14)/6.022e23)&#x27;
  [../]
  [./meta_density_ic_func]
    type = ParsedFunction
    value = &#x27;log((1e16)/6.022e23)&#x27;
  [../]
  [./energy_density_ic_func]
    type = ParsedFunction
    value = &#x27;log((3./2.) * 4) + log((1e14)/6.022e23)&#x27;
  [../]
[]

[Materials]
  [./GasBasics]
    type = GasElectronMoments
    interp_trans_coeffs = true
    interp_elastic_coeff = false
    ramp_trans_coeffs = false
    user_p_gas = 133.322
    em = em
    potential = potential
    mean_en = mean_en
    user_se_coeff = 0.00
    property_tables_file = Argon_reactions_paper_RateCoefficients/electron_moments.txt
  [../]
  [./gas_species_0]
    type = ADHeavySpecies
    heavy_species_name = Ar+
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 1.0
    mobility = 1.44409938
    diffusivity = 6.428571e-2
  [../]
  [./gas_species_1]
    type = ADHeavySpecies
    heavy_species_name = Ar*
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
    diffusivity = 7.515528e-2
  [../]
  [./gas_species_2]
    type = ADHeavySpecies
    heavy_species_name = Ar
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
  [../]
  [./reaction_00]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_elastic.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + Ar&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_0]
    type = ZapdosEEDFRateConstant
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_excitation.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
    file_location = &#x27;&#x27;
    mean_energy = mean_en
    electrons = em
  [../]
  [./reaction_1]
    type = ZapdosEEDFRateConstant
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_ionization.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    mean_energy = mean_en
    electrons = em
  [../]
  [./reaction_2]
    type = ZapdosEEDFRateConstant
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_deexcitation.txt&#x27;
    file_location = &#x27;&#x27;
    mean_energy = mean_en
    electrons = em
  [../]
  [./reaction_3]
    type = ZapdosEEDFRateConstant
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_excited_ionization.txt&#x27;
    file_location = &#x27;&#x27;
    mean_energy = mean_en
    electrons = em
  [../]
  [./reaction_4]
    type = GenericRateConstant
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
    #reaction_rate_value = 2e-13
    reaction_rate_value = 1.2044e11
  [../]
  [./reaction_5]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
    #reaction_rate_value = 6.2e-16
    reaction_rate_value = 373364000
  [../]
  [./reaction_6]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
    #reaction_rate_value = 3e-21
    reaction_rate_value = 1806.6
  [../]
  [./reaction_7]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
    #reaction_rate_value = 1.1e-42
    reaction_rate_value = 398909.324
  [../]
[]

#New postprocessor that calculates the inverse of the plasma frequency
[Postprocessors]
  [./InversePlasmaFreq]
    type = PlasmaFrequencyInverse
    variable = em
    use_moles = true
    execute_on = &#x27;INITIAL TIMESTEP_BEGIN&#x27;
  [../]
[]


[Preconditioning]
  active = &#x27;smp&#x27;
  [./smp]
    type = SMP
    full = true
  [../]

  [./fdp]
    type = FDP
    full = true
  [../]
[]


[Executioner]
  type = Transient
  #end_time = 7.4e-3
  end_time = 1e-7
  dtmax = 1e-9
  petsc_options = &#x27;-snes_converged_reason -snes_linesearch_monitor&#x27;
  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_shift_amount -ksp_type -snes_linesearch_minlambda&#x27;
  petsc_options_value = &#x27;lu NONZERO 1.e-10 fgmres 1e-3&#x27;
  nl_rel_tol = 1e-12
  #nl_abs_tol = 7.6e-5
  dtmin = 1e-14
  l_max_its = 20

  #Time steps based on the inverse of the plasma frequency
  #[./TimeStepper]
  #  type = PostprocessorDT
  #  postprocessor = InversePlasmaFreq
  #  scale = 0.1
  #[../]
[]

[Outputs]
  perf_graph = true
  [./out]
    type = Exodus
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="0747c7be-7c67-4224-9607-9aa1d7741520"><div class="modal-content"><h4>(test/tests/Conference_Syntax_Tests/Lymberopoulos_with_argon_metastables_2D_At100mTorr.i)</h4><pre class="moose-pre"><code class="language-text">dom0Scale=25.4e-3

[GlobalParams]
  potential_units = V
  use_moles = true
[]

[Mesh]
  type = FileMesh
  file = &#x27;GEC_mesh.msh&#x27;
  coord_type = RZ
  rz_coord_axis = Y
[]

[Variables]
  [./em]
  [../]

  [./Ar+]
  [../]

  [./Ar*]
  [../]

  [./mean_en]
  [../]

  [./potential]
  [../]

  [./potential_ion]
  [../]
[]

[Kernels]
  #Electron Equations (Same as in paper)
    #Time Derivative term of electron
    [./em_time_deriv]
      type = ElectronTimeDerivative
      variable = em
    [../]
    #Advection term of electron
    [./em_advection]
      type = EFieldAdvection
      variable = em
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons
    [./em_diffusion]
      type = CoeffDiffusion
      variable = em
      position_units = ${dom0Scale}
    [../]
    #Net electron production from ionization
    [./em_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      target = Ar
      mean_energy = mean_en
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from step-wise ionization
    [./em_stepwise_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      target = Ar*
      mean_energy = mean_en
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from metastable pooling
    [./em_pooling]
      type = ReactionSecondOrderLog
      variable = em
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

  #Argon Ion Equations (Same as in paper)
    #Time Derivative term of the ions
    [./Ar+_time_deriv]
      type = ElectronTimeDerivative
      variable = Ar+
    [../]
    #Advection term of ions
    [./Ar+_advection]
      type = EFieldAdvection
      variable = Ar+
      potential = potential_ion
      position_units = ${dom0Scale}
    [../]
    [./Ar+_diffusion]
      type = CoeffDiffusion
      variable = Ar+
      position_units = ${dom0Scale}
    [../]
    #Net ion production from ionization
    [./Ar+_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      target = Ar
      mean_energy = mean_en
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from step-wise ionization
    [./Ar+_stepwise_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      target = Ar*
      mean_energy = mean_en
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from metastable pooling
    [./Ar+_pooling]
      type = ReactionSecondOrderLog
      variable = Ar+
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

    #Argon Excited Equations (Same as in paper)
      #Time Derivative term of excited Argon
      [./Ar*_time_deriv]
        type = ElectronTimeDerivative
        variable = Ar*
      [../]
      #Diffusion term of excited Argon
      [./Ar*_diffusion]
        type = CoeffDiffusion
        variable = Ar*
        position_units = ${dom0Scale}
      [../]
      #Net excited Argon production from excitation
      [./Ar*_excitation]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar
        mean_energy = mean_en
        reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
        coefficient = 1
      [../]
      #Net excited Argon loss from step-wise ionization
      [./Ar*_stepwise_ionization]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from superelastic collisions
      [./Ar*_collisions]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from quenching to resonant
      [./Ar*_quenching]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from  metastable pooling
      [./Ar*_pooling]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar*
        reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
        coefficient = -2
        _v_eq_u = true
        _w_eq_u = true
      [../]
      #Net excited Argon loss from two-body quenching
      [./Ar*_2B_quenching]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]
      #Net excited Argon loss from three-body quenching
      [./Ar*_3B_quenching]
        type = ReactionThirdOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        x = Ar
        reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]

  #Voltage Equations (Same as in paper)
    #Voltage term in Poissons Eqaution
    [./potential_diffusion_dom0]
      type = CoeffDiffusionLin
      variable = potential
      position_units = ${dom0Scale}
    [../]
    #Ion term in Poissons Equation
    [./Ar+_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = Ar+
    [../]
    #Electron term in Poissons Equation
    [./em_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = em
    [../]


  #Since the paper uses electron temperature as a variable, the energy equation is in
  #a different form but should be the same physics
    #Time Derivative term of electron energy
    [./mean_en_time_deriv]
      type = ElectronTimeDerivative
      variable = mean_en
    [../]
    #Advection term of electron energy
    [./mean_en_advection]
      type = EFieldAdvection
      variable = mean_en
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons energy
    [./mean_en_diffusion]
      type = CoeffDiffusion
      variable = mean_en
      position_units = ${dom0Scale}
    [../]
    #Joule Heating term
    [./mean_en_joule_heating]
      type = JouleHeating
      variable = mean_en
      potential = potential
      em = em
      position_units = ${dom0Scale}
    [../]
    #Energy loss from ionization
    [./Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      threshold_energy = -15.7
    [../]
    #Energy loss from excitation
    [./Excitation_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
      threshold_energy = -11.56
    [../]
    #Energy loss from step-wise ionization
    [./Stepwise_Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      threshold_energy = -4.14
    [../]
    #Energy gain from superelastic collisions
    [./Collisions_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
      threshold_energy = 11.56
    [../]
    # Energy loss from elastic collisions
    [./Elastic_loss]
      type = EEDFElasticLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + Ar&#x27;
    [../]

    #Effective potential for the Ions
    [./Ion_potential_time_deriv]
      type = TimeDerivative
      variable = potential_ion
    [../]
    [./Ion_potential_reaction]
      type = ScaledReaction
      variable = potential_ion
      collision_freq = 1283370.875
    [../]
    [./Ion_potential_coupled_force]
      type = CoupledForce
      variable = potential_ion
      v = potential
      coef = 1283370.875
    [../]
  []


[AuxVariables]
  [./emDeBug]
  [../]
  [./Ar+_DeBug]
  [../]
  [./Ar*_DeBug]
  [../]
  [./mean_enDeBug]
  [../]
  [./potential_DeBug]
  [../]

  [./Te]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./x]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./x_node]
  [../]

  [./y]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./y_node]
  [../]

  [./rho]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./em_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar+_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar*_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar]
  [../]

  [./Efieldx]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./Efieldy]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Current_em]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./Current_Ar]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./emRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./exRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./swRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./deexRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./quRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./poolRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./TwoBRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./ThreeBRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]

[]

[AuxKernels]
  #[./emDeBug]
  #  type = DebugResidualAux
  #  variable = emDeBug
  #  debug_variable = em
  #[../]
  #[./Ar+_DeBug]
  #  type = DebugResidualAux
  #  variable = Ar+_DeBug
  #  debug_variable = Ar+
  #[../]
  #[./mean_enDeBug]
  #  type = DebugResidualAux
  #  variable = mean_enDeBug
  #  debug_variable = mean_en
  #[../]
  #[./Ar*_DeBug]
  #  type = DebugResidualAux
  #  variable = Ar*_DeBug
  #  debug_variable = Ar*
  #[../]
  #[./Potential_DeBug]
  #  type = DebugResidualAux
  #  variable = potential_DeBug
  #  debug_variable = potential
  #[../]

  [./emRate]
    type = ProcRateForRateCoeff
    variable = emRate
    v = em
    w = Ar
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
  [../]
  [./exRate]
    type = ProcRateForRateCoeff
    variable = exRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
  [../]
  [./swRate]
    type = ProcRateForRateCoeff
    variable = swRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
  [../]
  [./deexRate]
    type = ProcRateForRateCoeff
    variable = deexRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
  [../]
  [./quRate]
    type = ProcRateForRateCoeff
    variable = quRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
  [../]
  [./poolRate]
    type = ProcRateForRateCoeff
    variable = poolRate
    v = Ar*
    w = Ar*
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
  [../]
  [./TwoBRate]
    type = ProcRateForRateCoeff
    variable = TwoBRate
    v = Ar*
    w = Ar
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
  [../]
  [./ThreeBRate]
    type = ProcRateForRateCoeffThreeBody
    variable = ThreeBRate
    v = Ar*
    w = Ar
    vv = Ar
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
  [../]
  [./Te]
    type = ElectronTemperature
    variable = Te
    electron_density = em
    mean_en = mean_en
  [../]
  [./x_g]
    type = Position
    variable = x
    position_units = ${dom0Scale}
  [../]
  [./x_ng]
    type = Position
    variable = x_node
    position_units = ${dom0Scale}
  [../]

  [./y_g]
    type = Position
    variable = y
    position_units = ${dom0Scale}
  [../]
  [./y_ng]
    type = Position
    variable = y_node
    position_units = ${dom0Scale}
  [../]

  [./em_lin]
    type = DensityMoles
    variable = em_lin
    density_log = em
  [../]
  [./Ar+_lin]
    type = DensityMoles
    variable = Ar+_lin
    density_log = Ar+
  [../]
  [./Ar*_lin]
    type = DensityMoles
    variable = Ar*_lin
    density_log = Ar*
  [../]

  [./Ar_val]
    type = ConstantAux
    variable = Ar
    # value = 3.22e2
    value = -5.231208
    execute_on = INITIAL
  [../]

  [./Efieldx_calc]
    type = Efield
    component = 0
    potential = potential
    variable = Efieldx
    position_units = ${dom0Scale}
  [../]
  [./Efieldy_calc]
    type = Efield
    component = 1
    potential = potential
    variable = Efieldy
    position_units = ${dom0Scale}
  [../]

  [./Current_em]
    type = ADCurrent
    potential = potential
    density_log = em
    variable = Current_em
    art_diff = false
    block = &#x27;plasma&#x27;
    position_units = ${dom0Scale}
  [../]
  [./Current_Ar]
    type = ADCurrent
    potential = potential_ion
    density_log = Ar+
    variable = Current_Ar
    art_diff = false
    block = &#x27;plasma&#x27;
    position_units = ${dom0Scale}
  [../]

[]


[BCs]
#Voltage Boundary Condition, same as in paper
  [./potential_top_plate]
    type = FunctionDirichletBC
    variable = potential
    boundary = &#x27;Top_Electrode&#x27;
    function = potential_top_bc_func
  [../]
  [./potential_bottom_plate]
    type = FunctionDirichletBC
    variable = potential
    boundary = &#x27;Bottom_Electrode&#x27;
    function = potential_bottom_bc_func
  [../]
  [./potential_dirichlet_bottom_plate]
    type = DirichletBC
    variable = potential
    boundary = &#x27;Walls&#x27;
    value = 0
  [../]
  [./potential_Dielectric]
    type = EconomouDielectricBC
    variable = potential
    boundary = &#x27;Top_Insulator Bottom_Insulator&#x27;
    em = em
    ip = Ar+
    potential_ion = potential_ion
    mean_en = mean_en
    dielectric_constant = 1.859382e-11
    thickness = 0.0127
    users_gamma = 0.01
    position_units = ${dom0Scale}
  [../]


#New Boundary conditions for electons, same as in paper
  [./em_physical_diffusion]
    type = SakiyamaElectronDiffusionBC
    variable = em
    mean_en = mean_en
    boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
    position_units = ${dom0Scale}
  [../]
  [./em_Ar+_second_emissions]
    type = SakiyamaSecondaryElectronBC
    variable = em
    potential = potential_ion
    ip = Ar+
    users_gamma = 0.01
    boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
  [./Ar+_physical_advection]
    type = SakiyamaIonAdvectionBC
    variable = Ar+
    potential = potential_ion
    boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
#(except the metastables are not set to zero, since Zapdos uses log form)
  [./Ar*_physical_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
    value = 100
  [../]

#New Boundary conditions for mean energy, should be the same as in paper
[./mean_en_physical_diffusion]
  type = SakiyamaEnergyDiffusionBC
  variable = mean_en
  em = em
  boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
  position_units = ${dom0Scale}
[../]
[./mean_en_Ar+_second_emissions]
  type = SakiyamaEnergySecondaryElectronBC
  variable = mean_en
  em = em
  ip = Ar+
  potential = potential_ion
  Tse_equal_Te = true
  se_coeff = 0.01
  boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
  position_units = ${dom0Scale}
[../]

[]


[ICs]
  [./em_ic]
    type = FunctionIC
    variable = em
    function = density_ic_func
  [../]
  [./Ar+_ic]
    type = FunctionIC
    variable = Ar+
    function = density_ic_func
  [../]
  [./Ar*_ic]
    type = FunctionIC
    variable = Ar*
    function = meta_density_ic_func
  [../]
  [./mean_en_ic]
    type = FunctionIC
    variable = mean_en
    function = energy_density_ic_func
  [../]

  [./potential_ic]
    type = FunctionIC
    variable = potential
    function = potential_ic_func
  [../]
[]

[Functions]
  [./potential_top_bc_func]
    type = ParsedFunction
    value = &#x27;50*sin(2*3.1415926*13.56e6*t)&#x27;
  [../]
  [./potential_bottom_bc_func]
    type = ParsedFunction
    value = &#x27;-50*sin(2*3.1415926*13.56e6*t)&#x27;
  [../]
  [./potential_ic_func]
    type = ParsedFunction
    value = 0
  [../]
  [./density_ic_func]
    type = ParsedFunction
    value = &#x27;log((1e14)/6.022e23)&#x27;
  [../]
  [./meta_density_ic_func]
    type = ParsedFunction
    value = &#x27;log((1e16)/6.022e23)&#x27;
  [../]
  [./energy_density_ic_func]
    type = ParsedFunction
    value = &#x27;log((3./2.) * 4) + log((1e14)/6.022e23)&#x27;
  [../]
[]

[Materials]
  [./GasBasics]
    type = GasElectronMoments
    interp_trans_coeffs = true
    interp_elastic_coeff = false
    ramp_trans_coeffs = false
    user_p_gas = 133.322
    em = em
    potential = potential
    mean_en = mean_en
    user_se_coeff = 0.00
    property_tables_file = Argon_reactions_paper_RateCoefficients/electron_moments.txt
  [../]
  [./gas_species_0]
    type = ADHeavySpecies
    heavy_species_name = Ar+
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 1.0
    mobility = 1.44409938
    diffusivity = 6.428571e-2
  [../]
  [./gas_species_1]
    type = ADHeavySpecies
    heavy_species_name = Ar*
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
    diffusivity = 7.515528e-2
  [../]
  [./gas_species_2]
    type = ADHeavySpecies
    heavy_species_name = Ar
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
  [../]
  [./reaction_00]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_elastic.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + Ar&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_0]
    type = ZapdosEEDFRateConstant
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_excitation.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
    file_location = &#x27;&#x27;
    mean_energy = mean_en
    electrons = em
  [../]
  [./reaction_1]
    type = ZapdosEEDFRateConstant
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_ionization.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    mean_energy = mean_en
    electrons = em
  [../]
  [./reaction_2]
    type = ZapdosEEDFRateConstant
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_deexcitation.txt&#x27;
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
    file_location = &#x27;&#x27;
    mean_energy = mean_en
    electrons = em
  [../]
  [./reaction_3]
    type = ZapdosEEDFRateConstant
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_excited_ionization.txt&#x27;
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    mean_energy = mean_en
    electrons = em
  [../]
  [./reaction_4]
    type = GenericRateConstant
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
    #reaction_rate_value = 2e-13
    reaction_rate_value = 1.2044e11
  [../]
  [./reaction_5]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
    #reaction_rate_value = 6.2e-16
    reaction_rate_value = 373364000
  [../]
  [./reaction_6]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
    #reaction_rate_value = 3e-21
    reaction_rate_value = 1806.6
  [../]
  [./reaction_7]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
    #reaction_rate_value = 1.1e-42
    reaction_rate_value = 398909.324
  [../]
[]

#New postprocessor that calculates the inverse of the plasma frequency
[Postprocessors]
  [./InversePlasmaFreq]
    type = PlasmaFrequencyInverse
    variable = em
    use_moles = true
    execute_on = &#x27;INITIAL TIMESTEP_BEGIN&#x27;
  [../]
[]


[Preconditioning]
  active = &#x27;smp&#x27;
  [./smp]
    type = SMP
    full = true
  [../]

  [./fdp]
    type = FDP
    full = true
  [../]
[]


[Executioner]
  type = Transient
  end_time = 7.4e-3
  dtmax = 1e-9
  petsc_options = &#x27;-snes_converged_reason -snes_linesearch_monitor&#x27;
  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_shift_amount -ksp_type -snes_linesearch_minlambda&#x27;
  petsc_options_value = &#x27;lu NONZERO 1.e-10 fgmres 1e-3&#x27;
  nl_rel_tol = 1e-8
  #nl_abs_tol = 7.6e-5
  dtmin = 1e-14
  l_max_its = 20

  #Time steps based on the inverse of the plasma frequency
  #[./TimeStepper]
  #  type = PostprocessorDT
  #  postprocessor = InversePlasmaFreq
  #  scale = 0.1
  #[../]
[]

[Outputs]
  perf_graph = true
  [./out]
    type = Exodus
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="beece77b-8e0a-4520-9b7e-e00b3a15a655"><div class="modal-content"><h4>(test/tests/Conference_Syntax_Tests/Lymberopoulos_with_argon_metastables_2D_At1Torr.i)</h4><pre class="moose-pre"><code class="language-text">dom0Scale=25.4e-3
#dom0Scale=1.0

[GlobalParams]
  potential_units = V
  use_moles = true
[]

[Mesh]
  type = FileMesh
  file = &#x27;GEC_mesh.msh&#x27;
  coord_type = RZ
  rz_coord_axis = Y
[]

[Variables]
  [./em]
  [../]

  [./Ar+]
  [../]

  [./Ar*]
  [../]

  [./mean_en]
  [../]

  [./potential]
  [../]

  [./potential_ion]
  [../]
[]

[Kernels]
  #Electron Equations (Same as in paper)
    #Time Derivative term of electron
    [./em_time_deriv]
      type = ElectronTimeDerivative
      variable = em
    [../]
    #Advection term of electron
    [./em_advection]
      type = EFieldAdvection
      variable = em
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons
    [./em_diffusion]
      type = CoeffDiffusion
      variable = em
      position_units = ${dom0Scale}
    [../]
    #Net electron production from ionization
    [./em_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      target = Ar
      mean_energy = mean_en
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from step-wise ionization
    [./em_stepwise_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      target = Ar*
      mean_energy = mean_en
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from metastable pooling
    [./em_pooling]
      type = ReactionSecondOrderLog
      variable = em
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

  #Argon Ion Equations (Same as in paper)
    #Time Derivative term of the ions
    [./Ar+_time_deriv]
      type = ElectronTimeDerivative
      variable = Ar+
    [../]
    #Advection term of ions
    [./Ar+_advection]
      type = EFieldAdvection
      variable = Ar+
      potential = potential_ion
      position_units = ${dom0Scale}
    [../]
    [./Ar+_diffusion]
      type = CoeffDiffusion
      variable = Ar+
      position_units = ${dom0Scale}
    [../]
    #Net ion production from ionization
    [./Ar+_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      target = Ar
      mean_energy = mean_en
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from step-wise ionization
    [./Ar+_stepwise_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      target = Ar*
      mean_energy = mean_en
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from metastable pooling
    [./Ar+_pooling]
      type = ReactionSecondOrderLog
      variable = Ar+
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

    #Argon Excited Equations (Same as in paper)
      #Time Derivative term of excited Argon
      [./Ar*_time_deriv]
        type = ElectronTimeDerivative
        variable = Ar*
      [../]
      #Diffusion term of excited Argon
      [./Ar*_diffusion]
        type = CoeffDiffusion
        variable = Ar*
        position_units = ${dom0Scale}
      [../]
      #Net excited Argon production from excitation
      [./Ar*_excitation]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar
        mean_energy = mean_en
        reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
        coefficient = 1
      [../]
      #Net excited Argon loss from step-wise ionization
      [./Ar*_stepwise_ionization]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from superelastic collisions
      [./Ar*_collisions]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from quenching to resonant
      [./Ar*_quenching]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from  metastable pooling
      [./Ar*_pooling]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar*
        reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
        coefficient = -2
        _v_eq_u = true
        _w_eq_u = true
      [../]
      #Net excited Argon loss from two-body quenching
      [./Ar*_2B_quenching]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]
      #Net excited Argon loss from three-body quenching
      [./Ar*_3B_quenching]
        type = ReactionThirdOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        x = Ar
        reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]

  #Voltage Equations (Same as in paper)
    #Voltage term in Poissons Eqaution
    [./potential_diffusion_dom0]
      type = CoeffDiffusionLin
      variable = potential
      position_units = ${dom0Scale}
    [../]
    #Ion term in Poissons Equation
    [./Ar+_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = Ar+
    [../]
    #Electron term in Poissons Equation
    [./em_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = em
    [../]


  #Since the paper uses electron temperature as a variable, the energy equation is in
  #a different form but should be the same physics
    #Time Derivative term of electron energy
    [./mean_en_time_deriv]
      type = ElectronTimeDerivative
      variable = mean_en
    [../]
    #Advection term of electron energy
    [./mean_en_advection]
      type = EFieldAdvection
      variable = mean_en
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons energy
    [./mean_en_diffusion]
      type = CoeffDiffusion
      variable = mean_en
      position_units = ${dom0Scale}
    [../]
    #Joule Heating term
    [./mean_en_joule_heating]
      type = JouleHeating
      variable = mean_en
      potential = potential
      em = em
      position_units = ${dom0Scale}
    [../]
    #Energy loss from ionization
    [./Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      threshold_energy = -15.7
    [../]
    #Energy loss from excitation
    [./Excitation_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
      threshold_energy = -11.56
    [../]
    #Energy loss from step-wise ionization
    [./Stepwise_Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      threshold_energy = -4.14
    [../]
    #Energy gain from superelastic collisions
    [./Collisions_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
      threshold_energy = 11.56
    [../]
    # Energy loss from elastic collisions
    [./Elastic_loss]
      type = EEDFElasticLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + Ar&#x27;
    [../]

    #Effective potential for the Ions
    [./Ion_potential_time_deriv]
      type = TimeDerivative
      variable = potential_ion
    [../]
    [./Ion_potential_reaction]
      type = ScaledReaction
      variable = potential_ion
      collision_freq = 1283370.875
    [../]
    [./Ion_potential_coupled_force]
      type = CoupledForce
      variable = potential_ion
      v = potential
      coef = 1283370.875
    [../]
  []


[AuxVariables]
  [./emDeBug]
  [../]
  [./Ar+_DeBug]
  [../]
  [./Ar*_DeBug]
  [../]
  [./mean_enDeBug]
  [../]
  [./potential_DeBug]
  [../]

  [./Te]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./x]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./x_node]
  [../]

  [./y]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./y_node]
  [../]

  [./rho]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./em_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar+_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar*_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar]
  [../]

  [./Efieldx]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./Efieldy]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Current_em]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./Current_Ar]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./emRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./exRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./swRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./deexRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./quRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./poolRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./TwoBRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./ThreeBRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]

[]

[AuxKernels]
  #[./emDeBug]
  #  type = DebugResidualAux
  #  variable = emDeBug
  #  debug_variable = em
  #[../]
  #[./Ar+_DeBug]
  #  type = DebugResidualAux
  #  variable = Ar+_DeBug
  #  debug_variable = Ar+
  #[../]
  #[./mean_enDeBug]
  #  type = DebugResidualAux
  #  variable = mean_enDeBug
  #  debug_variable = mean_en
  #[../]
  #[./Ar*_DeBug]
  #  type = DebugResidualAux
  #  variable = Ar*_DeBug
  #  debug_variable = Ar*
  #[../]
  #[./Potential_DeBug]
  #  type = DebugResidualAux
  #  variable = potential_DeBug
  #  debug_variable = potential
  #[../]

  [./emRate]
    type = ProcRateForRateCoeff
    variable = emRate
    v = em
    w = Ar
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
  [../]
  [./exRate]
    type = ProcRateForRateCoeff
    variable = exRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
  [../]
  [./swRate]
    type = ProcRateForRateCoeff
    variable = swRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
  [../]
  [./deexRate]
    type = ProcRateForRateCoeff
    variable = deexRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
  [../]
  [./quRate]
    type = ProcRateForRateCoeff
    variable = quRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
  [../]
  [./poolRate]
    type = ProcRateForRateCoeff
    variable = poolRate
    v = Ar*
    w = Ar*
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
  [../]
  [./TwoBRate]
    type = ProcRateForRateCoeff
    variable = TwoBRate
    v = Ar*
    w = Ar
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
  [../]
  [./ThreeBRate]
    type = ProcRateForRateCoeffThreeBody
    variable = ThreeBRate
    v = Ar*
    w = Ar
    vv = Ar
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
  [../]
  [./Te]
    type = ElectronTemperature
    variable = Te
    electron_density = em
    mean_en = mean_en
  [../]
  [./x_g]
    type = Position
    variable = x
    position_units = ${dom0Scale}
  [../]
  [./x_ng]
    type = Position
    variable = x_node
    position_units = ${dom0Scale}
  [../]

  [./y_g]
    type = Position
    variable = y
    position_units = ${dom0Scale}
  [../]
  [./y_ng]
    type = Position
    variable = y_node
    position_units = ${dom0Scale}
  [../]

  [./em_lin]
    type = DensityMoles
    variable = em_lin
    density_log = em
  [../]
  [./Ar+_lin]
    type = DensityMoles
    variable = Ar+_lin
    density_log = Ar+
  [../]
  [./Ar*_lin]
    type = DensityMoles
    variable = Ar*_lin
    density_log = Ar*
  [../]

  [./Ar_val]
    type = ConstantAux
    variable = Ar
    # value = 3.22e22
    value = -2.928623
    execute_on = INITIAL
  [../]

  [./Efieldx_calc]
    type = Efield
    component = 0
    potential = potential
    variable = Efieldx
    position_units = ${dom0Scale}
  [../]
  [./Efieldy_calc]
    type = Efield
    component = 1
    potential = potential
    variable = Efieldy
    position_units = ${dom0Scale}
  [../]

  [./Current_em]
    type = ADCurrent
    potential = potential
    density_log = em
    variable = Current_em
    art_diff = false
    block = &#x27;plasma&#x27;
    position_units = ${dom0Scale}
  [../]
  [./Current_Ar]
    type = ADCurrent
    potential = potential_ion
    density_log = Ar+
    variable = Current_Ar
    art_diff = false
    block = &#x27;plasma&#x27;
    position_units = ${dom0Scale}
  [../]

[]


[BCs]
#Voltage Boundary Condition, same as in paper
  [./potential_top_plate]
    type = FunctionDirichletBC
    variable = potential
    boundary = &#x27;Top_Electrode&#x27;
    function = potential_top_bc_func
  [../]
  [./potential_bottom_plate]
    type = FunctionDirichletBC
    variable = potential
    boundary = &#x27;Bottom_Electrode&#x27;
    function = potential_bottom_bc_func
  [../]
  [./potential_dirichlet_bottom_plate]
    type = DirichletBC
    variable = potential
    boundary = &#x27;Walls&#x27;
    value = 0
  [../]
  [./potential_Dielectric]
    type = EconomouDielectricBC
    variable = potential
    boundary = &#x27;Top_Insulator Bottom_Insulator&#x27;
    em = em
    ip = Ar+
    potential_ion = potential_ion
    mean_en = mean_en
    dielectric_constant = 1.859382e-11
    thickness = 0.0127
    users_gamma = 0.01
    position_units = ${dom0Scale}
  [../]


#New Boundary conditions for electons, same as in paper
  [./em_physical_diffusion]
    type = SakiyamaElectronDiffusionBC
    variable = em
    mean_en = mean_en
    boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
    position_units = ${dom0Scale}
  [../]
  [./em_Ar+_second_emissions]
    type = SakiyamaSecondaryElectronBC
    variable = em
    potential = potential_ion
    ip = Ar+
    users_gamma = 0.01
    boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
  [./Ar+_physical_advection]
    type = SakiyamaIonAdvectionBC
    variable = Ar+
    potential = potential_ion
    boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
#(except the metastables are not set to zero, since Zapdos uses log form)
  [./Ar*_physical_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
    value = 100
  [../]

#New Boundary conditions for mean energy, should be the same as in paper
[./mean_en_physical_diffusion]
  type = SakiyamaEnergyDiffusionBC
  variable = mean_en
  em = em
  boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
  position_units = ${dom0Scale}
[../]
[./mean_en_Ar+_second_emissions]
  type = SakiyamaEnergySecondaryElectronBC
  variable = mean_en
  em = em
  ip = Ar+
  potential = potential_ion
  Tse_equal_Te = true
  se_coeff = 0.01
  boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
  position_units = ${dom0Scale}
[../]

[]


[ICs]
  [./em_ic]
    type = FunctionIC
    variable = em
    function = density_ic_func
  [../]
  [./Ar+_ic]
    type = FunctionIC
    variable = Ar+
    function = density_ic_func
  [../]
  [./Ar*_ic]
    type = FunctionIC
    variable = Ar*
    function = meta_density_ic_func
  [../]
  [./mean_en_ic]
    type = FunctionIC
    variable = mean_en
    function = energy_density_ic_func
  [../]

  [./potential_ic]
    type = FunctionIC
    variable = potential
    function = potential_ic_func
  [../]
[]

[Functions]
  [./potential_top_bc_func]
    type = ParsedFunction
    value = &#x27;30*sin(2*3.1415926*13.56e6*t)&#x27;
  [../]
  [./potential_bottom_bc_func]
    type = ParsedFunction
    value = &#x27;-30*sin(2*3.1415926*13.56e6*t)&#x27;
  [../]
  [./potential_ic_func]
    type = ParsedFunction
    value = 0
  [../]
  [./density_ic_func]
    type = ParsedFunction
    value = &#x27;log((1e14)/6.022e23)&#x27;
  [../]
  [./meta_density_ic_func]
    type = ParsedFunction
    value = &#x27;log((1e16)/6.022e23)&#x27;
  [../]
  [./energy_density_ic_func]
    type = ParsedFunction
    value = &#x27;log((3./2.)) + log((1e14)/6.022e23)&#x27;
  [../]
[]

[Materials]
  [./GasBasics]
    type = GasElectronMoments
    interp_trans_coeffs = true
    interp_elastic_coeff = false
    ramp_trans_coeffs = false
    user_p_gas = 133.322
    em = em
    potential = potential
    mean_en = mean_en
    user_se_coeff = 0.00
    property_tables_file = Argon_reactions_paper_RateCoefficients/electron_moments.txt
  [../]
  [./gas_species_0]
    type = ADHeavySpecies
    heavy_species_name = Ar+
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 1.0
    mobility = 1.44409938
    diffusivity = 6.428571e-2
  [../]
  [./gas_species_1]
    type = ADHeavySpecies
    heavy_species_name = Ar*
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
    diffusivity = 7.515528e-2
  [../]
  [./gas_species_2]
    type = ADHeavySpecies
    heavy_species_name = Ar
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
  [../]
  [./reaction_00]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_elastic.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + Ar&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_0]
    type = ZapdosEEDFRateConstant
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_excitation.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
    file_location = &#x27;&#x27;
    mean_energy = mean_en
    electrons = em
  [../]
  [./reaction_1]
    type = ZapdosEEDFRateConstant
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_ionization.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    mean_energy = mean_en
    electrons = em
  [../]
  [./reaction_2]
    type = ZapdosEEDFRateConstant
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_deexcitation.txt&#x27;
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
    file_location = &#x27;&#x27;
    mean_energy = mean_en
    electrons = em
  [../]
  [./reaction_3]
    type = ZapdosEEDFRateConstant
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_excited_ionization.txt&#x27;
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    mean_energy = mean_en
    electrons = em
  [../]
  [./reaction_4]
    type = GenericRateConstant
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
    #reaction_rate_value = 2e-13
    reaction_rate_value = 1.2044e11
  [../]
  [./reaction_5]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
    #reaction_rate_value = 6.2e-16
    reaction_rate_value = 373364000
  [../]
  [./reaction_6]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
    #reaction_rate_value = 3e-21
    reaction_rate_value = 1806.6
  [../]
  [./reaction_7]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
    #reaction_rate_value = 1.1e-42
    reaction_rate_value = 398909.324
  [../]
[]

#New postprocessor that calculates the inverse of the plasma frequency
[Postprocessors]
  [./InversePlasmaFreq]
    type = PlasmaFrequencyInverse
    variable = em
    use_moles = true
    execute_on = &#x27;INITIAL TIMESTEP_BEGIN&#x27;
  [../]
[]


[Preconditioning]
  active = &#x27;smp&#x27;
  [./smp]
    type = SMP
    full = true
  [../]

  [./fdp]
    type = FDP
    full = true
  [../]
[]


[Executioner]
  type = Transient
  end_time = 7.4e-3
  automatic_scaling = true
  dtmax = 1e-9
  petsc_options = &#x27;-snes_converged_reason -snes_linesearch_monitor&#x27;
  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_shift_amount -ksp_type -snes_linesearch_minlambda&#x27;
  petsc_options_value = &#x27;lu NONZERO 1.e-10 fgmres 1e-3&#x27;
  nl_rel_tol = 1e-8
  #nl_abs_tol = 7.6e-5
  dtmin = 1e-14
  l_max_its = 20

  #Time steps based on the inverse of the plasma frequency
  #[./TimeStepper]
  #  type = PostprocessorDT
  #  postprocessor = InversePlasmaFreq
  #  scale = 0.1
  #[../]
[]

[Outputs]
  perf_graph = true
  [./out]
    type = Exodus
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="c3bf02fa-7091-4279-8e27-af8f96e02ea5"><div class="modal-content"><h4>(test/tests/DriftDiffusionAction/2D_RF_Plasma_actions.i)</h4><pre class="moose-pre"><code class="language-text">dom0Scale=25.4e-3

[GlobalParams]
  potential_units = V
  use_moles = true
[]

[Mesh]
  type = FileMesh
  file = &#x27;GEC_mesh_coarse.msh&#x27;
  coord_type = RZ
  rz_coord_axis = Y
[]

#Effective potentials and their kernels are not defined by the
#DriftDiffusionAction, but charged particles effective by
#this potential can by defined by the action.
[Variables]
  [./potential_ion]
  [../]
[]

#Action the supplies the drift-diffusion equations
#This action also adds JouleHeating and the ChargeSourceMoles_KV Kernels
[DriftDiffusionAction]
  [./Plasma]
    electrons = em
    secondary_charged_particles = Ar+
    Neutrals = Ar*
    mean_energy = mean_en
    potential = potential
    eff_potentials = potential_ion
    Is_potential_unique = true
    using_offset = false
    position_units = ${dom0Scale}
    Additional_Outputs = &#x27;ElectronTemperature Current EField&#x27;
  [../]
[]

#The Kernels supply the sources terms
[Kernels]
    #Net electron production from ionization
    [./em_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      target = Ar
      mean_energy = mean_en
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from step-wise ionization
    [./em_stepwise_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      target = Ar*
      mean_energy = mean_en
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from metastable pooling
    [./em_pooling]
      type = ReactionSecondOrderLog
      variable = em
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

    #Net ion production from ionization
    [./Ar+_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      target = Ar
      mean_energy = mean_en
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from step-wise ionization
    [./Ar+_stepwise_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      target = Ar*
      mean_energy = mean_en
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from metastable pooling
    [./Ar+_pooling]
      type = ReactionSecondOrderLog
      variable = Ar+
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

      #Net excited Argon production from excitation
      [./Ar*_excitation]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar
        mean_energy = mean_en
        reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
        coefficient = 1
      [../]
      #Net excited Argon loss from step-wise ionization
      [./Ar*_stepwise_ionization]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from superelastic collisions
      [./Ar*_collisions]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from quenching to resonant
      [./Ar*_quenching]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from  metastable pooling
      [./Ar*_pooling]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar*
        reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
        coefficient = -2
        _v_eq_u = true
        _w_eq_u = true
      [../]
      #Net excited Argon loss from two-body quenching
      [./Ar*_2B_quenching]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]
      #Net excited Argon loss from three-body quenching
      [./Ar*_3B_quenching]
        type = ReactionThirdOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        x = Ar
        reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]

    #Energy loss from ionization
    [./Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      threshold_energy = -15.7
    [../]
    #Energy loss from excitation
    [./Excitation_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
      threshold_energy = -11.56
    [../]
    #Energy loss from step-wise ionization
    [./Stepwise_Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      threshold_energy = -4.14
    [../]
    #Energy gain from superelastic collisions
    [./Collisions_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
      threshold_energy = 11.56
    [../]
    # Energy loss from elastic collisions
    [./Elastic_loss]
      type = EEDFElasticLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + Ar&#x27;
    [../]

    #Effective potential for the Ions
    [./Ion_potential_time_deriv]
      type = TimeDerivative
      variable = potential_ion
    [../]
    [./Ion_potential_reaction]
      type = ScaledReaction
      variable = potential_ion
      collision_freq = 1283370.875
    [../]
    [./Ion_potential_coupled_force]
      type = CoupledForce
      variable = potential_ion
      v = potential
      coef = 1283370.875
    [../]
  []


[AuxVariables]
  [./x_node]
  [../]

  [./y_node]
  [../]

  [./rho]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar]
  [../]

  [./emRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./exRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./swRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./deexRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./quRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./poolRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./TwoBRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]
  [./ThreeBRate]
    order = CONSTANT
    family = MONOMIAL
    block = &#x27;plasma&#x27;
  [../]

[]

[AuxKernels]
  [./emRate]
    type = ProcRateForRateCoeff
    variable = emRate
    v = em
    w = Ar
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
  [../]
  [./exRate]
    type = ProcRateForRateCoeff
    variable = exRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
  [../]
  [./swRate]
    type = ProcRateForRateCoeff
    variable = swRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
  [../]
  [./deexRate]
    type = ProcRateForRateCoeff
    variable = deexRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
  [../]
  [./quRate]
    type = ProcRateForRateCoeff
    variable = quRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
  [../]
  [./poolRate]
    type = ProcRateForRateCoeff
    variable = poolRate
    v = Ar*
    w = Ar*
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
  [../]
  [./TwoBRate]
    type = ProcRateForRateCoeff
    variable = TwoBRate
    v = Ar*
    w = Ar
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
  [../]
  [./ThreeBRate]
    type = ProcRateForRateCoeffThreeBody
    variable = ThreeBRate
    v = Ar*
    w = Ar
    vv = Ar
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
  [../]

  [./x_ng]
    type = Position
    variable = x_node
    component = 0
    position_units = ${dom0Scale}
  [../]

  [./y_ng]
    type = Position
    variable = y_node
    component = 1
    position_units = ${dom0Scale}
  [../]

  [./Ar_val]
    type = ConstantAux
    variable = Ar
    # value = 3.22e2
    value = -5.231208
    execute_on = INITIAL
  [../]
[]


[BCs]
#Voltage Boundary Condition, same as in paper
  [./potential_top_plate]
    type = FunctionDirichletBC
    variable = potential
    boundary = &#x27;Top_Electrode&#x27;
    function = potential_top_bc_func
    preset = false
  [../]
  [./potential_bottom_plate]
    type = FunctionDirichletBC
    variable = potential
    boundary = &#x27;Bottom_Electrode&#x27;
    function = potential_bottom_bc_func
    preset = false
  [../]
  [./potential_dirichlet_bottom_plate]
    type = DirichletBC
    variable = potential
    boundary = &#x27;Walls&#x27;
    value = 0
    preset = false
  [../]
  [./potential_Dielectric]
    type = EconomouDielectricBC
    variable = potential
    boundary = &#x27;Top_Insulator Bottom_Insulator&#x27;
    em = em
    ip = Ar+
    potential_ion = potential_ion
    mean_en = mean_en
    dielectric_constant = 1.859382e-11
    thickness = 0.0127
    users_gamma = 0.01
    position_units = ${dom0Scale}
  [../]


#New Boundary conditions for electons, same as in paper
  [./em_physical_diffusion]
    type = SakiyamaElectronDiffusionBC
    variable = em
    mean_en = mean_en
    boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
    position_units = ${dom0Scale}
  [../]
  [./em_Ar+_second_emissions]
    type = SakiyamaSecondaryElectronBC
    variable = em
    potential = potential_ion
    ip = Ar+
    users_gamma = 0.01
    boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
  [./Ar+_physical_advection]
    type = SakiyamaIonAdvectionBC
    variable = Ar+
    potential = potential_ion
    boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
#(except the metastables are not set to zero, since Zapdos uses log form)
  [./Ar*_physical_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
    value = 100
  [../]

#New Boundary conditions for mean energy, should be the same as in paper
[./mean_en_physical_diffusion]
  type = SakiyamaEnergyDiffusionBC
  variable = mean_en
  em = em
  boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
  position_units = ${dom0Scale}
[../]
[./mean_en_Ar+_second_emissions]
  type = SakiyamaEnergySecondaryElectronBC
  variable = mean_en
  em = em
  ip = Ar+
  potential = potential_ion
  Tse_equal_Te = true
  se_coeff = 0.01
  boundary = &#x27;Top_Electrode Bottom_Electrode Top_Insulator Bottom_Insulator Walls&#x27;
  position_units = ${dom0Scale}
[../]

[]


[ICs]
  [./em_ic]
    type = FunctionIC
    variable = em
    function = density_ic_func
  [../]
  [./Ar+_ic]
    type = FunctionIC
    variable = Ar+
    function = density_ic_func
  [../]
  [./Ar*_ic]
    type = FunctionIC
    variable = Ar*
    function = meta_density_ic_func
  [../]
  [./mean_en_ic]
    type = FunctionIC
    variable = mean_en
    function = energy_density_ic_func
  [../]

  [./potential_ic]
    type = FunctionIC
    variable = potential
    function = potential_ic_func
  [../]
[]

[Functions]
  [./potential_top_bc_func]
    type = ParsedFunction
    value = &#x27;50*sin(2*3.1415926*13.56e6*t)&#x27;
  [../]
  [./potential_bottom_bc_func]
    type = ParsedFunction
    value = &#x27;-50*sin(2*3.1415926*13.56e6*t)&#x27;
  [../]
  [./potential_ic_func]
    type = ParsedFunction
    value = 0
  [../]
  [./density_ic_func]
    type = ParsedFunction
    value = &#x27;log((1e14)/6.022e23)&#x27;
  [../]
  [./meta_density_ic_func]
    type = ParsedFunction
    value = &#x27;log((1e16)/6.022e23)&#x27;
  [../]
  [./energy_density_ic_func]
    type = ParsedFunction
    value = &#x27;log((3./2.) * 4) + log((1e14)/6.022e23)&#x27;
  [../]
[]

[Materials]
  [./GasBasics]
    type = GasElectronMoments
    interp_trans_coeffs = true
    interp_elastic_coeff = false
    ramp_trans_coeffs = false
    user_p_gas = 133.322
    em = em
    potential = potential
    mean_en = mean_en
    user_se_coeff = 0.00
    property_tables_file = Argon_reactions_paper_RateCoefficients/electron_moments.txt
  [../]
  [./gas_species_0]
    type = ADHeavySpecies
    heavy_species_name = Ar+
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 1.0
    mobility = 1.44409938
    diffusivity = 6.428571e-2
  [../]
  [./gas_species_1]
    type = ADHeavySpecies
    heavy_species_name = Ar*
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
    diffusivity = 7.515528e-2
  [../]
  [./gas_species_2]
    type = ADHeavySpecies
    heavy_species_name = Ar
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
  [../]
  [./reaction_00]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_elastic.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + Ar&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_0]
    type = ZapdosEEDFRateConstant
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_excitation.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
    file_location = &#x27;&#x27;
    mean_energy = mean_en
    electrons = em
  [../]
  [./reaction_1]
    type = ZapdosEEDFRateConstant
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_ionization.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    mean_energy = mean_en
    electrons = em
  [../]
  [./reaction_2]
    type = ZapdosEEDFRateConstant
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_deexcitation.txt&#x27;
    file_location = &#x27;&#x27;
    mean_energy = mean_en
    electrons = em
  [../]
  [./reaction_3]
    type = ZapdosEEDFRateConstant
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_excited_ionization.txt&#x27;
    file_location = &#x27;&#x27;
    mean_energy = mean_en
    electrons = em
  [../]
  [./reaction_4]
    type = GenericRateConstant
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
    #reaction_rate_value = 2e-13
    reaction_rate_value = 1.2044e11
  [../]
  [./reaction_5]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
    #reaction_rate_value = 6.2e-16
    reaction_rate_value = 373364000
  [../]
  [./reaction_6]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
    #reaction_rate_value = 3e-21
    reaction_rate_value = 1806.6
  [../]
  [./reaction_7]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
    #reaction_rate_value = 1.1e-42
    reaction_rate_value = 398909.324
  [../]
[]

#New postprocessor that calculates the inverse of the plasma frequency
[Postprocessors]
  [./InversePlasmaFreq]
    type = PlasmaFrequencyInverse
    variable = em
    use_moles = true
    execute_on = &#x27;INITIAL TIMESTEP_BEGIN&#x27;
  [../]
[]


[Preconditioning]
  active = &#x27;smp&#x27;
  [./smp]
    type = SMP
    full = true
  [../]

  [./fdp]
    type = FDP
    full = true
  [../]
[]


[Executioner]
  type = Transient
  #end_time = 7.4e-3
  end_time = 1e-7
  dtmax = 1e-9
  petsc_options = &#x27;-snes_converged_reason -snes_linesearch_monitor&#x27;
  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_shift_amount -ksp_type -snes_linesearch_minlambda&#x27;
  petsc_options_value = &#x27;lu NONZERO 1.e-10 fgmres 1e-3&#x27;
  nl_rel_tol = 1e-12
  #nl_abs_tol = 7.6e-5
  dtmin = 1e-14
  l_max_its = 20

  #Time steps based on the inverse of the plasma frequency
  #[./TimeStepper]
  #  type = PostprocessorDT
  #  postprocessor = InversePlasmaFreq
  #  scale = 0.1
  #[../]
[]

[Outputs]
  file_base = &#x27;2D_RF_out&#x27;
  perf_graph = true
  [./out]
    type = Exodus
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#0463cb71-142e-4267-8a11-b28044ba9583" class="tooltipped" data-position="left" data-tooltip="Overview">Overview</a></li><li><a href="#e21538a8-de5f-48af-978f-933302dd872a" class="tooltipped" data-position="left" data-tooltip="Example Input File Syntax">Example Input File Syntax</a></li><li><a href="#7a364072-5a19-486b-a78f-a3a465066022" class="tooltipped" data-position="left" data-tooltip="Input Parameters">Input Parameters</a></li><li><a href="#de21fdc9-e134-4cb9-bc91-7bcfffeec4c5" class="tooltipped" data-position="left" data-tooltip="Input Files">Input Files</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>