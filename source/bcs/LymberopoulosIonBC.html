<!DOCTYPE html><head><meta charset="UTF-8"><title>LymberopoulosIonBC | Zapdos</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/zapdos.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Zapdos</a><a href="https://github.com/shannon-lab/zapdos" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="49a98a5b-ec54-4153-ba0c-ec6f550df383" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="1be111f0-005c-40dd-99b5-cfebcc274225" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="302d3937-3344-4eee-9985-12baaf6718fc" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../citing.html">Citing</a></li></ul><a href="#" class="sidenav-trigger" data-target="7246b4c7-90a7-4469-94fe-6b8813f1a114"><i class="material-icons">menu</i></a><ul class="sidenav" id="7246b4c7-90a7-4469-94fe-6b8813f1a114"><li><a href="#!" class="dropdown-trigger" data-target="4c3ef053-7700-423a-abb0-c4e56d22c22b" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="da64c43a-0928-4954-8703-9393ba88046c" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="3455dc7f-9df1-4b16-81c8-6893c977058c" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../citing.html">Citing</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="49a98a5b-ec54-4153-ba0c-ec6f550df383"><li><a href="../../getting_started/installation.html">Installation</a></li><li><a href="../../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../../getting_started/zapdos_meshing.html">Generating Meshes</a></li></ul><ul class="dropdown-content" id="1be111f0-005c-40dd-99b5-cfebcc274225"><li><a href="../../syntax/index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../../development/contributing.html">Contributing Guidelines</a></li><li><a href="../../development/code_standards.html">Code Standards</a></li><li><a href="../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="302d3937-3344-4eee-9985-12baaf6718fc"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul><ul class="dropdown-content" id="4c3ef053-7700-423a-abb0-c4e56d22c22b"><li><a href="../../getting_started/installation.html">Installation</a></li><li><a href="../../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../../getting_started/zapdos_meshing.html">Generating Meshes</a></li></ul><ul class="dropdown-content" id="da64c43a-0928-4954-8703-9393ba88046c"><li><a href="../../syntax/index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../../development/contributing.html">Contributing Guidelines</a></li><li><a href="../../development/code_standards.html">Code Standards</a></li><li><a href="../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="3455dc7f-9df1-4b16-81c8-6893c977058c"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">source</a><span class="breadcrumb">bcs</span><a href="#" class="breadcrumb">LymberopoulosIonBC</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="f667621b-e746-40d1-9c5f-762488d87a87" data-section-level="1" data-section-text="LymberopoulosIonBC"><h1 id="lymberopoulosionbc">LymberopoulosIonBC</h1><div class="card moose-alert moose-alert-construction"><div class="card-title moose-alert-title"><i class="material-icons moose-inline-icon">build</i><span class="moose-alert-title-brand">construction:</span>Undocumented Class</div><div class="card-content"><div class="moose-alert-content"><p>The LymberopoulosIonBC has not been documented. The content listed below should be used as a starting point for documenting the class, which includes the typical automatic documentation associated with a MooseObject; however, what is contained is ultimately determined by what is necessary to make the documentation clear for users.</p></div></div></div><p>Simpified kinetic ion boundary condition(Based on DOI: https://doi.org/10.1063/1.352926)</p><section class="scrollspy" id="b7d1313d-f637-4cf2-9e3b-7087695bb1f6" data-section-level="2" data-section-text="Overview"><h2 id="overview">Overview</h2><p></p></section><section class="scrollspy" id="01030891-fea5-4b4e-94c2-9af40163c4c9" data-section-level="2" data-section-text="Example Input File Syntax"><h2 id="example-input-file-syntax">Example Input File Syntax</h2><p></p></section><section class="scrollspy" id="b1f8d834-7019-4e57-ad38-6bfe84b1b7ac" data-section-level="2" data-section-text="Input Parameters"><h2 id="input-parameters">Input Parameters</h2><section id="4249625a-421b-4785-bfa8-8eecc18c8955" data-section-level="3" data-section-text="Required Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">boundary</span><span class="moose-parameter-header-description">The list of boundary IDs from the mesh where this boundary condition applies</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;BoundaryName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The list of boundary IDs from the mesh where this boundary condition applies</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">position_units</span><span class="moose-parameter-header-description">Units of position.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>double</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Units of position.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">potential</span><span class="moose-parameter-header-description">The electric potential</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;VariableName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The electric potential</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">variable</span><span class="moose-parameter-header-description">The name of the variable that this residual object operates on</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>NonlinearVariableName</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The name of the variable that this residual object operates on</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Required Parameters</h3></summary></details></section><section id="5ae31eb9-dfc7-43a0-aad1-22149e09afc7" data-section-level="3" data-section-text="Optional Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">displacements</span><span class="moose-parameter-header-description">The displacements</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;VariableName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The displacements</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">prop_getter_suffix</span><span class="moose-parameter-header-description">An optional suffix parameter that can be appended to any attempt to retrieve/get material properties. The suffix will be prepended with a '_' character.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MaterialPropertyName</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>An optional suffix parameter that can be appended to any attempt to retrieve/get material properties. The suffix will be prepended with a '_' character.</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Optional Parameters</h3></summary></details></section><section id="eec48113-eddf-44cf-9d41-2da7724f9108" data-section-level="3" data-section-text="Advanced Parameters" data-details-open="close"><details class="moose-section-content"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">control_tags</span><span class="moose-parameter-header-description">Adds user-defined labels for accessing object parameters via control logic.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;std::string&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Adds user-defined labels for accessing object parameters via control logic.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">diag_save_in</span><span class="moose-parameter-header-description">The name of auxiliary variables to save this BC's diagonal jacobian contributions to.  Everything about that variable must match everything about this variable (the type, what blocks it's on, etc.)</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;AuxVariableName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The name of auxiliary variables to save this BC's diagonal jacobian contributions to.  Everything about that variable must match everything about this variable (the type, what blocks it's on, etc.)</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">enable</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Set the enabled status of the MooseObject.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>Yes</p><p class="moose-parameter-description"><span>Description:</span>Set the enabled status of the MooseObject.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">implicit</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Determines whether this object is calculated using an implicit or explicit form</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Determines whether this object is calculated using an implicit or explicit form</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">save_in</span><span class="moose-parameter-header-description">The name of auxiliary variables to save this BC's residual contributions to.  Everything about that variable must match everything about this variable (the type, what blocks it's on, etc.)</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;AuxVariableName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The name of auxiliary variables to save this BC's residual contributions to.  Everything about that variable must match everything about this variable (the type, what blocks it's on, etc.)</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">seed</span><span class="moose-parameter-header-default">0</span><span class="moose-parameter-header-description">The seed for the master random number generator</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>0</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>unsigned int</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The seed for the master random number generator</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">use_displaced_mesh</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">Whether or not this object should use the displaced mesh for computation.  Note that in the case this is true but no displacements are provided in the Mesh block the undisplaced mesh will still be used.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Whether or not this object should use the displaced mesh for computation.  Note that in the case this is true but no displacements are provided in the Mesh block the undisplaced mesh will still be used.</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Advanced Parameters</h3></summary></details></section><section id="6da8eded-7e22-495b-bf37-81f879f3d3e0" data-section-level="3" data-section-text="Tagging Parameters" data-details-open="close"><details class="moose-section-content"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">extra_matrix_tags</span><span class="moose-parameter-header-description">The extra tags for the matrices this Kernel should fill</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;TagName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The extra tags for the matrices this Kernel should fill</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">extra_vector_tags</span><span class="moose-parameter-header-description">The extra tags for the vectors this Kernel should fill</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;TagName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The extra tags for the vectors this Kernel should fill</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">matrix_tags</span><span class="moose-parameter-header-default">system</span><span class="moose-parameter-header-description">The tag for the matrices this Kernel should fill</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>system</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MultiMooseEnum</p><p class="moose-parameter-description-options"><span>Options:</span>nontime, system</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The tag for the matrices this Kernel should fill</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">vector_tags</span><span class="moose-parameter-header-default">nontime</span><span class="moose-parameter-header-description">The tag for the vectors this Kernel should fill</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>nontime</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MultiMooseEnum</p><p class="moose-parameter-description-options"><span>Options:</span>nontime, time</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The tag for the vectors this Kernel should fill</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Tagging Parameters</h3></summary></details></section></section><section class="scrollspy" id="9e294236-21db-4856-88a9-da69d53bf82c" data-section-level="2" data-section-text="Input Files"><h2 id="input-files">Input Files</h2><ul class="moose-list-inputs browser-default"><li><a class="moose-source-filename tooltipped modal-trigger" href="#79c13f31-2418-4461-96e3-523d95137236">(test/tests/accelerations/Acceleration_By_Averaging_main.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#8f4771a5-1c89-404e-835e-04e90579cbf2">(test/tests/DriftDiffusionAction/RF_Plasma_no_actions.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#ec27108a-3dc0-4116-975e-e35b4095b666">(test/tests/Lymberopoulos_rf_discharge/Lymberopoulos_with_argon_metastables.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#61eb921c-0be6-4147-9ef3-360a2f04d559">(test/tests/accelerations/Acceleration_By_Shooting_Method.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#1419b0f0-cf3a-458c-94dc-ccbb457d156a">(test/tests/accelerations/Acceleration_By_Averaging_acceleration_sub.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#1fb17f18-6ebb-470f-9f70-95dd216bd46b">(tutorial/tutorial06-Building-InputFile/RF_Plasma_WithOut_Metastables.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#7ae0e14e-a268-481d-b934-57b286d7d7c2">(test/tests/accelerations/Acceleration_By_Shooting_Method_SensitivityMatrix.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#c145a067-bfb9-4d4b-939d-48073747f169">(test/tests/DriftDiffusionAction/RF_Plasma_actions.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#406bf7e6-1c6c-455d-8dae-1cb7fb730c29">(test/tests/crane_action/rate_units.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#87941387-6707-40da-ac00-b38af5691433">(test/tests/Conference_Syntax_Tests/Lymberopoulos_with_argon_metastables.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#0ecf710f-6093-4c89-8095-d211fd4008f1">(tutorial/tutorial06-Building-InputFile/RF_Plasma_Blank.i)</a></li></ul></section></section><div class="moose-modal modal" id="79c13f31-2418-4461-96e3-523d95137236"><div class="modal-content"><h4>(test/tests/accelerations/Acceleration_By_Averaging_main.i)</h4><pre class="moose-pre"><code class="language-text">#This test runs the simulation for 10 rf cycle, then accelerates
#once and stops at 11 rf cycles

dom0Scale=25.4e-3

[GlobalParams]
  potential_units = kV
  use_moles = true
[]

[Mesh]
  [./file]
    type = FileMeshGenerator
    file = &#x27;Lymberopoulos_paper.msh&#x27;
  [../]
  [./left]
    type = SideSetsFromNormalsGenerator
    normals = &#x27;-1 0 0&#x27;
    new_boundary = &#x27;left&#x27;
    input = file
  [../]
  [./right]
    type = SideSetsFromNormalsGenerator
    normals = &#x27;1 0 0&#x27;
    new_boundary = &#x27;right&#x27;
    input = left
  [../]
[]

[Problem]
  type = FEProblem
[]

[Variables]
  [./em]
  [../]

  [./Ar+]
  [../]

  [./Ar*]
  [../]

  [./mean_en]
  [../]

  [./potential]
  [../]
[]

[Kernels]
  #Electron Equations
    #Time Derivative term of electron
    [./em_time_deriv]
      type = ElectronTimeDerivative
      variable = em
    [../]
    #Advection term of electron
    [./em_advection]
      type = EFieldAdvection
      variable = em
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons
    [./em_diffusion]
      type = CoeffDiffusion
      variable = em
      position_units = ${dom0Scale}
    [../]
    #Net electron production from ionization
    [./em_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      mean_energy = mean_en
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from step-wise ionization
    [./em_stepwise_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      mean_energy = mean_en
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from metastable pooling
    [./em_pooling]
      type = ReactionSecondOrderLog
      variable = em
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

  #Argon Ion Equations
    #Time Derivative term of the ions
    [./Ar+_time_deriv]
      type = ElectronTimeDerivative
      variable = Ar+
    [../]
    #Advection term of ions
    [./Ar+_advection]
      type = EFieldAdvection
      variable = Ar+
      potential = potential
      position_units = ${dom0Scale}
    [../]
    [./Ar+_diffusion]
      type = CoeffDiffusion
      variable = Ar+
      position_units = ${dom0Scale}
    [../]
    #Net ion production from ionization
    [./Ar+_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      mean_energy = mean_en
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from step-wise ionization
    [./Ar+_stepwise_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      mean_energy = mean_en
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from metastable pooling
    [./Ar+_pooling]
      type = ReactionSecondOrderLog
      variable = Ar+
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

    #Argon Excited Equations
      #Time Derivative term of excited Argon
      [./Ar*_time_deriv]
        type = ElectronTimeDerivative
        variable = Ar*
      [../]
      #Diffusion term of excited Argon
      [./Ar*_diffusion]
        type = CoeffDiffusion
        variable = Ar*
        position_units = ${dom0Scale}
      [../]
      #Net excited Argon production from excitation
      [./Ar*_excitation]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar
        mean_energy = mean_en
        reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
        coefficient = 1
      [../]
      #Net excited Argon loss from step-wise ionization
      [./Ar*_stepwise_ionization]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from superelastic collisions
      [./Ar*_collisions]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from quenching to resonant
      [./Ar*_quenching]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from  metastable pooling
      [./Ar*_pooling]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar*
        reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
        coefficient = -2
        _v_eq_u = true
        _w_eq_u = true
      [../]
      #Net excited Argon loss from two-body quenching
      [./Ar*_2B_quenching]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]
      #Net excited Argon loss from three-body quenching
      [./Ar*_3B_quenching]
        type = ReactionThirdOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        x = Ar
        reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]

  #Voltage Equations
    #Voltage term in Poissons Eqaution
    [./potential_diffusion_dom0]
      type = CoeffDiffusionLin
      variable = potential
      position_units = ${dom0Scale}
    [../]
    #Ion term in Poissons Equation
    [./Ar+_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = Ar+
    [../]
    #Electron term in Poissons Equation
    [./em_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = em
    [../]


  #Electron Energy Equations
    #Time Derivative term of electron energy
    [./mean_en_time_deriv]
      type = ElectronTimeDerivative
      variable = mean_en
    [../]
    #Advection term of electron energy
    [./mean_en_advection]
      type = EFieldAdvection
      variable = mean_en
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons energy
    [./mean_en_diffusion]
      type = CoeffDiffusion
      variable = mean_en
      position_units = ${dom0Scale}
    [../]
    #Joule Heating term
    [./mean_en_joule_heating]
      type = JouleHeating
      variable = mean_en
      potential = potential
      em = em
      position_units = ${dom0Scale}
    [../]
    #Energy loss from ionization
    [./Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      threshold_energy = -15.7
    [../]
    #Energy loss from excitation
    [./Excitation_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
      threshold_energy = -11.56
    [../]
    #Energy loss from step-wise ionization
    [./Stepwise_Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      threshold_energy = -4.14
    [../]
    #Energy gain from superelastic collisions
    [./Collisions_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
      threshold_energy = 11.56
    [../]
  []


[AuxVariables]
  [./Te]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./x]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./x_node]
  [../]

  [./em_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar+_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar*_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar]
  [../]

  [./Efield]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Current_em]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./Current_Ar]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./emRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./exRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./swRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./deexRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./quRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./poolRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./TwoBRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./ThreeBRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
[]

[AuxKernels]
  [./emRate]
    type = ProcRateForRateCoeff
    variable = emRate
    v = em
    w = Ar
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
  [../]
  [./exRate]
    type = ProcRateForRateCoeff
    variable = exRate
    v = em
    w = Ar
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
  [../]
  [./swRate]
    type = ProcRateForRateCoeff
    variable = swRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
  [../]
  [./deexRate]
    type = ProcRateForRateCoeff
    variable = deexRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
  [../]
  [./quRate]
    type = ProcRateForRateCoeff
    variable = quRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
  [../]
  [./poolRate]
    type = ProcRateForRateCoeff
    variable = poolRate
    v = Ar*
    w = Ar*
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
  [../]
  [./TwoBRate]
    type = ProcRateForRateCoeff
    variable = TwoBRate
    v = Ar*
    w = Ar
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
  [../]
  [./ThreeBRate]
    type = ProcRateForRateCoeffThreeBody
    variable = ThreeBRate
    v = Ar*
    w = Ar
    vv = Ar
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
  [../]
  [./Te]
    type = ElectronTemperature
    variable = Te
    electron_density = em
    mean_en = mean_en
  [../]
  [./x_g]
    type = Position
    variable = x
    position_units = ${dom0Scale}
  [../]

  [./x_ng]
    type = Position
    variable = x_node
    position_units = ${dom0Scale}
  [../]

  [./em_lin]
    type = DensityMoles
    variable = em_lin
    density_log = em
  [../]
  [./Ar+_lin]
    type = DensityMoles
    variable = Ar+_lin
    density_log = Ar+
  [../]
  [./Ar*_lin]
    type = DensityMoles
    variable = Ar*_lin
    density_log = Ar*
  [../]

  [./Ar_val]
    type = ConstantAux
    variable = Ar
    # value = 3.22e22
    value = -2.928623
    execute_on = INITIAL
  [../]

  [./Efield_calc]
    type = Efield
    component = 0
    potential = potential
    variable = Efield
    position_units = ${dom0Scale}
  [../]
  [./Current_em]
    type = ADCurrent
    potential = potential
    density_log = em
    variable = Current_em
    art_diff = false
    block = 0
    position_units = ${dom0Scale}
  [../]
  [./Current_Ar]
    type = ADCurrent
    potential = potential
    density_log = Ar+
    variable = Current_Ar
    art_diff = false
    block = 0
    position_units = ${dom0Scale}
  [../]
[]


[BCs]
#Voltage Boundary Condition
  [./potential_left]
    type = FunctionDirichletBC
    variable = potential
    boundary = &#x27;left&#x27;
    function = potential_bc_func
    preset = false
  [../]
  [./potential_dirichlet_right]
    type = DirichletBC
    variable = potential
    boundary = &#x27;right&#x27;
    value = 0
    preset = false
  [../]

#Boundary conditions for electons
  [./em_physical_right]
    type = LymberopoulosElectronBC
    variable = em
    boundary = &#x27;right&#x27;
    gamma = 0.01
    #gamma = 1
    ks = 1.19e5
    #ks = 0.0
    ion = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]
  [./em_physical_left]
    type = LymberopoulosElectronBC
    variable = em
    boundary = &#x27;left&#x27;
    gamma = 0.01
    #gamma = 1
    ks = 1.19e5
    #ks = 0.0
    ion = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]

#Boundary conditions for ions
  [./Ar+_physical_right_advection]
    type = LymberopoulosIonBC
    variable = Ar+
    potential = potential
    boundary = &#x27;right&#x27;
    position_units = ${dom0Scale}
  [../]
  [./Ar+_physical_left_advection]
    type = LymberopoulosIonBC
    variable = Ar+
    potential = potential
    boundary = &#x27;left&#x27;
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for metastables
  [./Ar*_physical_right_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;right&#x27;
    value = 1e-5
  [../]
  [./Ar*_physical_left_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;left&#x27;
    value = 1e-5
  [../]

#Boundary conditions for electron mean energy
  [./mean_en_physical_right]
    type = ElectronTemperatureDirichletBC
    variable = mean_en
    em = em
    value = 0.5
    boundary = &#x27;right&#x27;
  [../]
  [./mean_en_physical_left]
    type = ElectronTemperatureDirichletBC
    variable = mean_en
    em = em
    value = 0.5
    boundary = &#x27;left&#x27;
  [../]
[]


[ICs]
  [./em_ic]
    type = FunctionIC
    variable = em
    function = density_ic_func
  [../]
  [./Ar+_ic]
    type = FunctionIC
    variable = Ar+
    function = density_ic_func
  [../]
  [./Ar*_ic]
    type = FunctionIC
    variable = Ar*
    function = density_ic_func
  [../]
  [./mean_en_ic]
    type = FunctionIC
    variable = mean_en
    function = energy_density_ic_func
  [../]
[]

[Functions]
  [./potential_bc_func]
    type = ParsedFunction
    value = &#x27;0.100*sin(2*pi*13.56e6*t)&#x27;
  [../]
  [./density_ic_func]
    type = ParsedFunction
    value = &#x27;log((1e14)/6.022e23)&#x27;
  [../]
  [./energy_density_ic_func]
    type = ParsedFunction
    value = &#x27;log((3./2.) * ((1e14)/6.022e23))&#x27;
  [../]
[]

[Materials]
  [./GasBasics]
    type = GasElectronMoments
    interp_trans_coeffs = false
    interp_elastic_coeff = false
    ramp_trans_coeffs = false
    user_p_gas = 133.322
    em = em
    potential = potential
    mean_en = mean_en
    user_electron_mobility = 30.0
    user_electron_diffusion_coeff = 119.8757763975
    property_tables_file = Argon_reactions_paper_RateCoefficients/electron_moments.txt
  [../]
  [./gas_species_0]
    type = ADHeavySpecies
    heavy_species_name = Ar+
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 1.0
    mobility = 0.144409938
    diffusivity = 6.428571e-3
  [../]
  [./gas_species_1]
    type = ADHeavySpecies
    heavy_species_name = Ar*
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
    diffusivity = 7.515528e-3
  [../]
  [./gas_species_2]
    type = ADHeavySpecies
    heavy_species_name = Ar
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
  [../]
  [./reaction_0]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/reaction_em + Ar -&gt; em + Ar*.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_1]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/reaction_em + Ar -&gt; em + em + Ar+.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_2]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/reaction_em + Ar* -&gt; em + Ar.txt&#x27;
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_3]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/reaction_em + Ar* -&gt; em + em + Ar+.txt&#x27;
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_4]
    type = GenericRateConstant
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
    #reaction_rate_value = 2e-13
    reaction_rate_value = 1.2044e11
  [../]
  [./reaction_5]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
    #reaction_rate_value = 6.2e-16
    reaction_rate_value = 373364000
  [../]
  [./reaction_6]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
    #reaction_rate_value = 3e-21
    reaction_rate_value = 1806.6
  [../]
  [./reaction_7]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
    #reaction_rate_value = 1.1e-43
    reaction_rate_value = 39890.9324
  [../]
[]

[MultiApps]
  #MultiApp of Acceleration by Averaging
  [./Averaging_Acceleration]
    type = FullSolveMultiApp
    input_files = &#x27;Acceleration_By_Averaging_acceleration.i&#x27;
    execute_on = &#x27;TIMESTEP_END&#x27;
    enable = false
  [../]
[]

[Transfers]
  #MultiApp Transfers for Acceleration by Averaging
  [./em_to_Averaging]
    type = MultiAppCopyTransfer
    to_multi_app = Averaging_Acceleration
    source_variable = em
    variable = em
    enable = false
  [../]
  [./Ar+_to_Averaging]
    type = MultiAppCopyTransfer
    to_multi_app = Averaging_Acceleration
    source_variable = Ar+
    variable = Ar+
    enable = false
  [../]
  [./mean_en_to_Averaging]
    type = MultiAppCopyTransfer
    to_multi_app = Averaging_Acceleration
    source_variable = mean_en
    variable = mean_en
    enable = false
  [../]
  [./potential_to_Averaging]
    type = MultiAppCopyTransfer
    to_multi_app = Averaging_Acceleration
    source_variable = potential
    variable = potential
    enable = false
  [../]
  [./Ar*_to_Averaging]
    type = MultiAppCopyTransfer
    to_multi_app = Averaging_Acceleration
    source_variable = Ar*
    variable = Ar*
    enable = false
  [../]
  [./Ar*S_to_Averaging]
    type = MultiAppCopyTransfer
    to_multi_app = Averaging_Acceleration
    source_variable = Ar*
    variable = Ar*S
    enable = false
  [../]


  [./Ar*New_from_Averaging]
    type = MultiAppCopyTransfer
    from_multi_app = Averaging_Acceleration
    source_variable = Ar*
    variable = Ar*
    enable = false
  [../]
[]

#The Action the add the TimePeriod Controls to turn off and on the MultiApps
[PeriodicControllers]
  [./Averaging_Acceleration]
    Enable_at_cycle_start = &#x27;MultiApps::Averaging_Acceleration
                              Transfers::em_to_Averaging *::Ar+_to_Averaging *::mean_en_to_Averaging
                              *::potential_to_Averaging *::Ar*_to_Averaging *::Ar*S_to_Averaging
                              Transfers::Ar*New_from_Averaging&#x27;
    starting_cycle = 10
    cycle_frequency = 13.56e6
    cycles_between_controls = 10
    num_controller_set = 15
    name = Averaging_Acceleration
  [../]
[]

#New postprocessor that calculates the inverse of the plasma frequency
[Postprocessors]
  [./InversePlasmaFreq]
    type = PlasmaFrequencyInverse
    variable = em
    use_moles = true
    execute_on = &#x27;INITIAL TIMESTEP_BEGIN&#x27;
  [../]
[]

[Preconditioning]
  active = &#x27;smp&#x27;
  [./smp]
    type = SMP
    full = true
  [../]

  [./fdp]
    type = FDP
    full = true
  [../]
[]


[Executioner]
  type = Transient
  end_time = 8.2e-7
  petsc_options = &#x27;-snes_converged_reason -snes_linesearch_monitor&#x27;
  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_shift_amount -ksp_type -snes_linesearch_minlambda&#x27;
  petsc_options_value = &#x27;lu NONZERO 1.e-10 fgmres 1e-3&#x27;

  dtmin = 1e-14
  l_max_its = 20

  scheme = bdf2
  dt = 1e-9
[]

[Outputs]
  perf_graph = true
  [./out]
    type = Exodus
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="8f4771a5-1c89-404e-835e-04e90579cbf2"><div class="modal-content"><h4>(test/tests/DriftDiffusionAction/RF_Plasma_no_actions.i)</h4><pre class="moose-pre"><code class="language-text">#This is the input file that supplied the gold output file.
#It is the same as the input file in
#tests/Lymberopoulos_rf_discharge/Lymberopoulos_with_argon_metastables.i,
#execpt some of the Aux Variables are renamed for the Action test

dom0Scale=25.4e-3

[GlobalParams]
  potential_units = kV
  use_moles = true
[]

[Mesh]
  [./file]
    type = FileMeshGenerator
    file = &#x27;Lymberopoulos.msh&#x27;
  [../]
  [./left]
    type = SideSetsFromNormalsGenerator
    normals = &#x27;-1 0 0&#x27;
    new_boundary = &#x27;left&#x27;
    input = file
  [../]
  [./right]
    type = SideSetsFromNormalsGenerator
    normals = &#x27;1 0 0&#x27;
    new_boundary = &#x27;right&#x27;
    input = left
  [../]
[]

[Problem]
  type = FEProblem
[]

[Variables]
  [./em]
  [../]

  [./Ar+]
  [../]

  [./Ar*]
  [../]

  [./mean_en]
  [../]

  [./potential]
  [../]
[]

[Kernels]
  #Electron Equations (Same as in paper)
    #Time Derivative term of electron
    [./em_time_deriv]
      type = ElectronTimeDerivative
      variable = em
    [../]
    #Advection term of electron
    [./em_advection]
      type = EFieldAdvection
      variable = em
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons
    [./em_diffusion]
      type = CoeffDiffusion
      variable = em
      position_units = ${dom0Scale}
    [../]
    #Net electron production from ionization
    [./em_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      target = Ar
      mean_energy = mean_en
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from step-wise ionization
    [./em_stepwise_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      target = Ar*
      mean_energy = mean_en
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from metastable pooling
    [./em_pooling]
      type = ReactionSecondOrderLog
      variable = em
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

  #Argon Ion Equations (Same as in paper)
    #Time Derivative term of the ions
    [./Ar+_time_deriv]
      type = ElectronTimeDerivative
      variable = Ar+
    [../]
    #Advection term of ions
    [./Ar+_advection]
      type = EFieldAdvection
      variable = Ar+
      potential = potential
      position_units = ${dom0Scale}
    [../]
    [./Ar+_diffusion]
      type = CoeffDiffusion
      variable = Ar+
      position_units = ${dom0Scale}
    [../]
    #Net ion production from ionization
    [./Ar+_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      target = Ar
      mean_energy = mean_en
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from step-wise ionization
    [./Ar+_stepwise_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      target = Ar*
      mean_energy = mean_en
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from metastable pooling
    [./Ar+_pooling]
      type = ReactionSecondOrderLog
      variable = Ar+
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

    #Argon Excited Equations (Same as in paper)
      #Time Derivative term of excited Argon
      [./Ar*_time_deriv]
        type = ElectronTimeDerivative
        variable = Ar*
      [../]
      #Diffusion term of excited Argon
      [./Ar*_diffusion]
        type = CoeffDiffusion
        variable = Ar*
        position_units = ${dom0Scale}
      [../]
      #Net excited Argon production from excitation
      [./Ar*_excitation]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar
        mean_energy = mean_en
        reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
        coefficient = 1
      [../]
      #Net excited Argon loss from step-wise ionization
      [./Ar*_stepwise_ionization]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from superelastic collisions
      [./Ar*_collisions]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from quenching to resonant
      [./Ar*_quenching]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from  metastable pooling
      [./Ar*_pooling]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar*
        reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
        coefficient = -2
        _v_eq_u = true
        _w_eq_u = true
      [../]
      #Net excited Argon loss from two-body quenching
      [./Ar*_2B_quenching]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]
      #Net excited Argon loss from three-body quenching
      [./Ar*_3B_quenching]
        type = ReactionThirdOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        x = Ar
        reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]

  #Voltage Equations (Same as in paper)
    #Voltage term in Poissons Eqaution
    [./potential_diffusion_dom0]
      type = CoeffDiffusionLin
      variable = potential
      position_units = ${dom0Scale}
    [../]
    #Ion term in Poissons Equation
    [./Ar+_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = Ar+
    [../]
    #Electron term in Poissons Equation
    [./em_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = em
    [../]


  #Since the paper uses electron temperature as a variable, the energy equation is in
  #a different form but should be the same physics
    #Time Derivative term of electron energy
    [./mean_en_time_deriv]
      type = ElectronTimeDerivative
      variable = mean_en
    [../]
    #Advection term of electron energy
    [./mean_en_advection]
      type = EFieldAdvection
      variable = mean_en
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons energy
    [./mean_en_diffusion]
      type = CoeffDiffusion
      variable = mean_en
      position_units = ${dom0Scale}
    [../]
    #Joule Heating term
    [./mean_en_joule_heating]
      type = JouleHeating
      variable = mean_en
      potential = potential
      em = em
      position_units = ${dom0Scale}
    [../]
    #Energy loss from ionization
    [./Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      threshold_energy = -15.7
    [../]
    #Energy loss from excitation
    [./Excitation_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
      threshold_energy = -11.56
    [../]
    #Energy loss from step-wise ionization
    [./Stepwise_Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      threshold_energy = -4.14
    [../]
    #Energy gain from superelastic collisions
    [./Collisions_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
      threshold_energy = 11.56
    [../]
  []


[AuxVariables]
  [./e_temp]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./position]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./x_node]
  [../]

  [./rho]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./em_density]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar+_density]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar*_density]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar]
  [../]

  [./EFieldx]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Current_em]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./Current_Ar+]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./emRate]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./exRate]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./swRate]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./deexRate]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./quRate]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./poolRate]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./TwoBRate]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./ThreeBRate]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./emRate]
    type = ProcRateForRateCoeff
    variable = emRate
    v = em
    w = Ar
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
  [../]
  [./exRate]
    type = ProcRateForRateCoeff
    variable = exRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
  [../]
  [./swRate]
    type = ProcRateForRateCoeff
    variable = swRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
  [../]
  [./deexRate]
    type = ProcRateForRateCoeff
    variable = deexRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
  [../]
  [./quRate]
    type = ProcRateForRateCoeff
    variable = quRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
  [../]
  [./poolRate]
    type = ProcRateForRateCoeff
    variable = poolRate
    v = Ar*
    w = Ar*
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
  [../]
  [./TwoBRate]
    type = ProcRateForRateCoeff
    variable = TwoBRate
    v = Ar*
    w = Ar
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
  [../]
  [./ThreeBRate]
    type = ProcRateForRateCoeffThreeBody
    variable = ThreeBRate
    v = Ar*
    w = Ar
    vv = Ar
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
  [../]
  [./e_temp]
    type = ElectronTemperature
    variable = e_temp
    electron_density = em
    mean_en = mean_en
  [../]
  [./x_g]
    type = Position
    variable = position
    position_units = ${dom0Scale}
  [../]

  [./x_ng]
    type = Position
    variable = x_node
    position_units = ${dom0Scale}
  [../]

  [./em_density]
    type = DensityMoles
    variable = em_density
    density_log = em
  [../]
  [./Ar+_density]
    type = DensityMoles
    variable = Ar+_density
    density_log = Ar+
  [../]
  [./Ar*_density]
    type = DensityMoles
    variable = Ar*_density
    density_log = Ar*
  [../]

  [./Ar_val]
    type = ConstantAux
    variable = Ar
    # value = 3.22e22
    value = -2.928623
    execute_on = INITIAL
  [../]

  [./Efield_calc]
    type = Efield
    component = 0
    potential = potential
    variable = EFieldx
    position_units = ${dom0Scale}
  [../]
  [./Current_em]
    type = ADCurrent
    potential = potential
    density_log = em
    variable = Current_em
    art_diff = false
    position_units = ${dom0Scale}
  [../]
  [./Current_Ar+]
    type = ADCurrent
    potential = potential
    density_log = Ar+
    variable = Current_Ar+
    art_diff = false
    position_units = ${dom0Scale}
  [../]
[]


[BCs]
#Voltage Boundary Condition, same as in paper
  [./potential_left]
    type = FunctionDirichletBC
    variable = potential
    boundary = &#x27;left&#x27;
    function = potential_bc_func
  [../]
  [./potential_dirichlet_right]
    type = DirichletBC
    variable = potential
    boundary = &#x27;right&#x27;
    value = 0
  [../]

#New Boundary conditions for electons, same as in paper
  [./em_physical_right]
    type = LymberopoulosElectronBC
    variable = em
    boundary = &#x27;right&#x27;
    gamma = 0.01
    #gamma = 1
    ks = 1.19e5
    #ks = 0.0
    ion = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]
  [./em_physical_left]
    type = LymberopoulosElectronBC
    variable = em
    boundary = &#x27;left&#x27;
    gamma = 0.01
    #gamma = 1
    ks = 1.19e5
    #ks = 0.0
    ion = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
  [./Ar+_physical_right_advection]
    type = LymberopoulosIonBC
    variable = Ar+
    potential = potential
    boundary = &#x27;right&#x27;
    position_units = ${dom0Scale}
  [../]
  [./Ar+_physical_left_advection]
    type = LymberopoulosIonBC
    variable = Ar+
    potential = potential
    boundary = &#x27;left&#x27;
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
#(except the metastables are not set to zero, since Zapdos uses log form)
  [./Ar*_physical_right_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;right&#x27;
    value = 100
  [../]
  [./Ar*_physical_left_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;left&#x27;
    value = 100
  [../]

#New Boundary conditions for mean energy, should be the same as in paper
  [./mean_en_physical_right]
    type = ElectronTemperatureDirichletBC
    variable = mean_en
    em = em
    value = 0.5
    boundary = &#x27;right&#x27;
  [../]
  [./mean_en_physical_left]
    type = ElectronTemperatureDirichletBC
    variable = mean_en
    em = em
    value = 0.5
    boundary = &#x27;left&#x27;
  [../]

[]


[ICs]
  [./em_ic]
    type = FunctionIC
    variable = em
    function = density_ic_func
  [../]
  [./Ar+_ic]
    type = FunctionIC
    variable = Ar+
    function = density_ic_func
  [../]
  [./Ar*_ic]
    type = FunctionIC
    variable = Ar*
    function = density_ic_func
  [../]
  [./mean_en_ic]
    type = FunctionIC
    variable = mean_en
    function = energy_density_ic_func
  [../]

  [./potential_ic]
    type = FunctionIC
    variable = potential
    function = potential_ic_func
  [../]
[]

[Functions]
  [./potential_bc_func]
    type = ParsedFunction
    value = &#x27;0.100*sin(2*3.1415926*13.56e6*t)&#x27;
  [../]
  [./potential_ic_func]
    type = ParsedFunction
    value = &#x27;0.100 * (25.4e-3 - x)&#x27;
  [../]
  [./density_ic_func]
    type = ParsedFunction
    value = &#x27;log((1e13 + 1e15 * (1-x/1)^2 * (x/1)^2)/6.022e23)&#x27;
  [../]
  [./energy_density_ic_func]
    type = ParsedFunction
    value = &#x27;log(3./2.) + log((1e13 + 1e15 * (1-x/1)^2 * (x/1)^2)/6.022e23)&#x27;
  [../]
[]

[Materials]
  [./GasBasics]
    type = GasElectronMoments
    interp_trans_coeffs = false
    interp_elastic_coeff = false
    ramp_trans_coeffs = false
    user_p_gas = 133.322
    em = em
    potential = potential
    mean_en = mean_en
    user_electron_mobility = 30.0
    user_electron_diffusion_coeff = 119.8757763975
    property_tables_file = Argon_reactions_paper_RateCoefficients/electron_moments.txt
  [../]
  [./gas_species_0]
    type = ADHeavySpecies
    heavy_species_name = Ar+
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 1.0
    mobility = 0.144409938
    diffusivity = 6.428571e-3
  [../]
  [./gas_species_1]
    type = ADHeavySpecies
    heavy_species_name = Ar*
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
    diffusivity = 7.515528e-3
  [../]
  [./gas_species_2]
    type = ADHeavySpecies
    heavy_species_name = Ar
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
  [../]
  [./reaction_0]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_excitation.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_1]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_ionization.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_2]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_deexcitation.txt&#x27;
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_3]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_excited_ionization.txt&#x27;
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_4]
    type = GenericRateConstant
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
    #reaction_rate_value = 2e-13
    reaction_rate_value = 1.2044e11
  [../]
  [./reaction_5]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
    #reaction_rate_value = 6.2e-16
    reaction_rate_value = 373364000
  [../]
  [./reaction_6]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
    #reaction_rate_value = 3e-21
    reaction_rate_value = 1806.6
  [../]
  [./reaction_7]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
    #reaction_rate_value = 1.1e-42
    reaction_rate_value = 398909.324
  [../]
[]

#New postprocessor that calculates the inverse of the plasma frequency
[Postprocessors]
  [./InversePlasmaFreq]
    type = PlasmaFrequencyInverse
    variable = em
    use_moles = true
    execute_on = &#x27;INITIAL TIMESTEP_BEGIN&#x27;
  [../]
[]


[Preconditioning]
  active = &#x27;smp&#x27;
  [./smp]
    type = SMP
    full = true
  [../]

  [./fdp]
    type = FDP
    full = true
  [../]
[]


[Executioner]
  type = Transient
  end_time = 3e-7
  petsc_options = &#x27;-snes_converged_reason -snes_linesearch_monitor&#x27;
  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_shift_amount -ksp_type -snes_linesearch_minlambda&#x27;
  petsc_options_value = &#x27;lu NONZERO 1.e-10 fgmres 1e-3&#x27;

  dtmin = 1e-14
  l_max_its = 20

  scheme = bdf2
  dt = 1e-9
[]

[Outputs]
  file_base = &#x27;RF_out&#x27;
  perf_graph = true
  [./out]
    type = Exodus
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="ec27108a-3dc0-4116-975e-e35b4095b666"><div class="modal-content"><h4>(test/tests/Lymberopoulos_rf_discharge/Lymberopoulos_with_argon_metastables.i)</h4><pre class="moose-pre"><code class="language-text">dom0Scale=25.4e-3

[GlobalParams]
  potential_units = kV
  use_moles = true
[]

[Mesh]
  [./file]
    type = FileMeshGenerator
    file = &#x27;Lymberopoulos.msh&#x27;
  [../]
  [./left]
    type = SideSetsFromNormalsGenerator
    normals = &#x27;-1 0 0&#x27;
    new_boundary = &#x27;left&#x27;
    input = file
  [../]
  [./right]
    type = SideSetsFromNormalsGenerator
    normals = &#x27;1 0 0&#x27;
    new_boundary = &#x27;right&#x27;
    input = left
  [../]
[]

[Problem]
  type = FEProblem
[]

[Variables]
  [./em]
  [../]

  [./Ar+]
  [../]

  [./Ar*]
  [../]

  [./mean_en]
  [../]

  [./potential]
  [../]
[]

[Kernels]
  #Electron Equations (Same as in paper)
    #Time Derivative term of electron
    [./em_time_deriv]
      type = ElectronTimeDerivative
      variable = em
    [../]
    #Advection term of electron
    [./em_advection]
      type = EFieldAdvection
      variable = em
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons
    [./em_diffusion]
      type = CoeffDiffusion
      variable = em
      position_units = ${dom0Scale}
    [../]
    #Net electron production from ionization
    [./em_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      target = Ar
      mean_energy = mean_en
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from step-wise ionization
    [./em_stepwise_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      target = Ar*
      mean_energy = mean_en
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from metastable pooling
    [./em_pooling]
      type = ReactionSecondOrderLog
      variable = em
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

  #Argon Ion Equations (Same as in paper)
    #Time Derivative term of the ions
    [./Ar+_time_deriv]
      type = ElectronTimeDerivative
      variable = Ar+
    [../]
    #Advection term of ions
    [./Ar+_advection]
      type = EFieldAdvection
      variable = Ar+
      potential = potential
      position_units = ${dom0Scale}
    [../]
    [./Ar+_diffusion]
      type = CoeffDiffusion
      variable = Ar+
      position_units = ${dom0Scale}
    [../]
    #Net ion production from ionization
    [./Ar+_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      target = Ar
      mean_energy = mean_en
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from step-wise ionization
    [./Ar+_stepwise_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      target = Ar*
      mean_energy = mean_en
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from metastable pooling
    [./Ar+_pooling]
      type = ReactionSecondOrderLog
      variable = Ar+
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

    #Argon Excited Equations (Same as in paper)
      #Time Derivative term of excited Argon
      [./Ar*_time_deriv]
        type = ElectronTimeDerivative
        variable = Ar*
      [../]
      #Diffusion term of excited Argon
      [./Ar*_diffusion]
        type = CoeffDiffusion
        variable = Ar*
        position_units = ${dom0Scale}
      [../]
      #Net excited Argon production from excitation
      [./Ar*_excitation]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar
        mean_energy = mean_en
        reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
        coefficient = 1
      [../]
      #Net excited Argon loss from step-wise ionization
      [./Ar*_stepwise_ionization]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from superelastic collisions
      [./Ar*_collisions]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from quenching to resonant
      [./Ar*_quenching]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from  metastable pooling
      [./Ar*_pooling]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar*
        reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
        coefficient = -2
        _v_eq_u = true
        _w_eq_u = true
      [../]
      #Net excited Argon loss from two-body quenching
      [./Ar*_2B_quenching]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]
      #Net excited Argon loss from three-body quenching
      [./Ar*_3B_quenching]
        type = ReactionThirdOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        x = Ar
        reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]

  #Voltage Equations (Same as in paper)
    #Voltage term in Poissons Eqaution
    [./potential_diffusion_dom0]
      type = CoeffDiffusionLin
      variable = potential
      position_units = ${dom0Scale}
    [../]
    #Ion term in Poissons Equation
    [./Ar+_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = Ar+
    [../]
    #Electron term in Poissons Equation
    [./em_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = em
    [../]


  #Since the paper uses electron temperature as a variable, the energy equation is in
  #a different form but should be the same physics
    #Time Derivative term of electron energy
    [./mean_en_time_deriv]
      type = ElectronTimeDerivative
      variable = mean_en
    [../]
    #Advection term of electron energy
    [./mean_en_advection]
      type = EFieldAdvection
      variable = mean_en
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons energy
    [./mean_en_diffusion]
      type = CoeffDiffusion
      variable = mean_en
      position_units = ${dom0Scale}
    [../]
    #Joule Heating term
    [./mean_en_joule_heating]
      type = JouleHeating
      variable = mean_en
      potential = potential
      em = em
      position_units = ${dom0Scale}
    [../]
    #Energy loss from ionization
    [./Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      threshold_energy = -15.7
    [../]
    #Energy loss from excitation
    [./Excitation_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
      threshold_energy = -11.56
    [../]
    #Energy loss from step-wise ionization
    [./Stepwise_Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      threshold_energy = -4.14
    [../]
    #Energy gain from superelastic collisions
    [./Collisions_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
      threshold_energy = 11.56
    [../]
  []


[AuxVariables]
  #[./emDeBug]
  #[../]
  #[./Ar+_DeBug]
  #[../]
  #[./Ar*_DeBug]
  #[../]
  #[./mean_enDeBug]
  #[../]

  [./Te]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./x]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./x_node]
  [../]

  [./rho]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./em_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar+_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar*_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar]
  [../]

  [./Efield]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Current_em]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./Current_Ar]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./emRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./exRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./swRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./deexRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./quRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./poolRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./TwoBRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./ThreeBRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
[]

[AuxKernels]
  #[./emDeBug]
  #  type = DebugResidualAux
  #  variable = emDeBug
  #  debug_variable = em
  #  #execute_on = &#x27;LINEAR NONLINEAR TIMESTEP_BEGIN&#x27;
  #[../]
  #[./Ar+_DeBug]
  #  type = DebugResidualAux
  #  variable = Ar+_DeBug
  #  debug_variable = Ar+
  #  #execute_on = &#x27;LINEAR NONLINEAR TIMESTEP_BEGIN&#x27;
  #[../]
  #[./mean_enDeBug]
  #  type = DebugResidualAux
  #  variable = mean_enDeBug
  #  debug_variable = mean_en
  #  #execute_on = &#x27;LINEAR NONLINEAR TIMESTEP_BEGIN&#x27;
  #[../]
  #[./Ar*_DeBug]
  #  type = DebugResidualAux
  #  variable = Ar*_DeBug
  #  debug_variable = Ar*
  #  #execute_on = &#x27;LINEAR NONLINEAR TIMESTEP_BEGIN&#x27;
  #[../]

  [./emRate]
    type = ProcRateForRateCoeff
    variable = emRate
    v = em
    w = Ar
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
  [../]
  [./exRate]
    type = ProcRateForRateCoeff
    variable = exRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
  [../]
  [./swRate]
    type = ProcRateForRateCoeff
    variable = swRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
  [../]
  [./deexRate]
    type = ProcRateForRateCoeff
    variable = deexRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
  [../]
  [./quRate]
    type = ProcRateForRateCoeff
    variable = quRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
  [../]
  [./poolRate]
    type = ProcRateForRateCoeff
    variable = poolRate
    v = Ar*
    w = Ar*
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
  [../]
  [./TwoBRate]
    type = ProcRateForRateCoeff
    variable = TwoBRate
    v = Ar*
    w = Ar
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
  [../]
  [./ThreeBRate]
    type = ProcRateForRateCoeffThreeBody
    variable = ThreeBRate
    v = Ar*
    w = Ar
    vv = Ar
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
  [../]
  [./Te]
    type = ElectronTemperature
    variable = Te
    electron_density = em
    mean_en = mean_en
  [../]
  [./x_g]
    type = Position
    variable = x
    position_units = ${dom0Scale}
  [../]

  [./x_ng]
    type = Position
    variable = x_node
    position_units = ${dom0Scale}
  [../]

  [./em_lin]
    type = DensityMoles
    variable = em_lin
    density_log = em
  [../]
  [./Ar+_lin]
    type = DensityMoles
    variable = Ar+_lin
    density_log = Ar+
  [../]
  [./Ar*_lin]
    type = DensityMoles
    variable = Ar*_lin
    density_log = Ar*
  [../]

  [./Ar_val]
    type = ConstantAux
    variable = Ar
    # value = 3.22e22
    value = -2.928623
    execute_on = INITIAL
  [../]

  [./Efield_calc]
    type = Efield
    component = 0
    potential = potential
    variable = Efield
    position_units = ${dom0Scale}
  [../]
  [./Current_em]
    type = ADCurrent
    potential = potential
    density_log = em
    variable = Current_em
    art_diff = false
    block = 0
    position_units = ${dom0Scale}
  [../]
  [./Current_Ar]
    type = ADCurrent
    potential = potential
    density_log = Ar+
    variable = Current_Ar
    art_diff = false
    block = 0
    position_units = ${dom0Scale}
  [../]
[]


[BCs]
#Voltage Boundary Condition, same as in paper
  [./potential_left]
    type = FunctionDirichletBC
    variable = potential
    boundary = &#x27;left&#x27;
    function = potential_bc_func
    preset = false
  [../]
  [./potential_dirichlet_right]
    type = DirichletBC
    variable = potential
    boundary = &#x27;right&#x27;
    value = 0
    preset = false
  [../]

#New Boundary conditions for electons, same as in paper
  [./em_physical_right]
    type = LymberopoulosElectronBC
    variable = em
    boundary = &#x27;right&#x27;
    gamma = 0.01
    #gamma = 1
    ks = 1.19e5
    #ks = 0.0
    ion = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]
  [./em_physical_left]
    type = LymberopoulosElectronBC
    variable = em
    boundary = &#x27;left&#x27;
    gamma = 0.01
    #gamma = 1
    ks = 1.19e5
    #ks = 0.0
    ion = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
  [./Ar+_physical_right_advection]
    type = LymberopoulosIonBC
    variable = Ar+
    potential = potential
    boundary = &#x27;right&#x27;
    position_units = ${dom0Scale}
  [../]
  [./Ar+_physical_left_advection]
    type = LymberopoulosIonBC
    variable = Ar+
    potential = potential
    boundary = &#x27;left&#x27;
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
#(except the metastables are not set to zero, since Zapdos uses log form)
  [./Ar*_physical_right_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;right&#x27;
    value = 100
  [../]
  [./Ar*_physical_left_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;left&#x27;
    value = 100
  [../]

#New Boundary conditions for mean energy, should be the same as in paper
  [./mean_en_physical_right]
    type = ElectronTemperatureDirichletBC
    variable = mean_en
    em = em
    value = 0.5
    boundary = &#x27;right&#x27;
  [../]
  [./mean_en_physical_left]
    type = ElectronTemperatureDirichletBC
    variable = mean_en
    em = em
    value = 0.5
    boundary = &#x27;left&#x27;
  [../]

[]


[ICs]
  [./em_ic]
    type = FunctionIC
    variable = em
    function = density_ic_func
  [../]
  [./Ar+_ic]
    type = FunctionIC
    variable = Ar+
    function = density_ic_func
  [../]
  [./Ar*_ic]
    type = FunctionIC
    variable = Ar*
    function = density_ic_func
  [../]
  [./mean_en_ic]
    type = FunctionIC
    variable = mean_en
    function = energy_density_ic_func
  [../]

  [./potential_ic]
    type = FunctionIC
    variable = potential
    function = potential_ic_func
  [../]
[]

[Functions]
  [./potential_bc_func]
    type = ParsedFunction
    value = &#x27;0.100*sin(2*3.1415926*13.56e6*t)&#x27;
  [../]
  [./potential_ic_func]
    type = ParsedFunction
    value = &#x27;0.100 * (25.4e-3 - x)&#x27;
  [../]
  [./density_ic_func]
    type = ParsedFunction
    value = &#x27;log((1e13 + 1e15 * (1-x/1)^2 * (x/1)^2)/6.022e23)&#x27;
  [../]
  [./energy_density_ic_func]
    type = ParsedFunction
    value = &#x27;log(3./2.) + log((1e13 + 1e15 * (1-x/1)^2 * (x/1)^2)/6.022e23)&#x27;
  [../]
[]

[Materials]
  [./GasBasics]
    type = GasElectronMoments
    interp_trans_coeffs = false
    interp_elastic_coeff = false
    ramp_trans_coeffs = false
    user_p_gas = 133.322
    em = em
    potential = potential
    mean_en = mean_en
    user_electron_mobility = 30.0
    user_electron_diffusion_coeff = 119.8757763975
    property_tables_file = Argon_reactions_paper_RateCoefficients/electron_moments.txt
  [../]
  [./gas_species_0]
    type = ADHeavySpecies
    heavy_species_name = Ar+
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 1.0
    mobility = 0.144409938
    diffusivity = 6.428571e-3
  [../]
  [./gas_species_1]
    type = ADHeavySpecies
    heavy_species_name = Ar*
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
    diffusivity = 7.515528e-3
  [../]
  [./gas_species_2]
    type = ADHeavySpecies
    heavy_species_name = Ar
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
  [../]
  [./reaction_0]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_excitation.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_1]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_ionization.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_2]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_deexcitation.txt&#x27;
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_3]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_excited_ionization.txt&#x27;
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_4]
    type = GenericRateConstant
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
    #reaction_rate_value = 2e-13
    reaction_rate_value = 1.2044e11
  [../]
  [./reaction_5]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
    #reaction_rate_value = 6.2e-16
    reaction_rate_value = 373364000
  [../]
  [./reaction_6]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
    #reaction_rate_value = 3e-21
    reaction_rate_value = 1806.6
  [../]
  [./reaction_7]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
    #reaction_rate_value = 1.1e-42
    reaction_rate_value = 398909.324
  [../]
[]

#New postprocessor that calculates the inverse of the plasma frequency
[Postprocessors]
  [./InversePlasmaFreq]
    type = PlasmaFrequencyInverse
    variable = em
    use_moles = true
    execute_on = &#x27;INITIAL TIMESTEP_BEGIN&#x27;
  [../]
[]


[Preconditioning]
  active = &#x27;smp&#x27;
  [./smp]
    type = SMP
    full = true
  [../]

  [./fdp]
    type = FDP
    full = true
  [../]
[]


[Executioner]
  type = Transient
  #end_time = 0.00737463126
  end_time = 3e-7
  petsc_options = &#x27;-snes_converged_reason -snes_linesearch_monitor&#x27;
  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_shift_amount -ksp_type -snes_linesearch_minlambda&#x27;
  petsc_options_value = &#x27;lu NONZERO 1.e-10 fgmres 1e-3&#x27;
  nl_rel_tol = 1e-08
  #nl_abs_tol = 7.6e-5 #Commit out do to test falure on Mac
  dtmin = 1e-14
  l_max_its = 20

  #Time steps based on the inverse of the plasma frequency
  [./TimeStepper]
    type = PostprocessorDT
    postprocessor = InversePlasmaFreq
  [../]
[]

[Outputs]
  perf_graph = true
  [./out]
    type = Exodus
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="61eb921c-0be6-4147-9ef3-360a2f04d559"><div class="modal-content"><h4>(test/tests/accelerations/Acceleration_By_Shooting_Method.i)</h4><pre class="moose-pre"><code class="language-text">#This test starts the simulation at 50 rf cycle, then accelerates
#at the 55 rf cycle mark and stops at 57 rf cycles

dom0Scale=25.4e-3

[GlobalParams]
  potential_units = kV
  use_moles = true
[]

[Mesh]
  file = &#x27;Acceleration_By_Shooting_Method_Initial_Conditions.e&#x27;
[]

[Problem]
  type = FEProblem
[]

[Variables]
  [./em]
    initial_from_file_var = em
  [../]

  [./Ar+]
    initial_from_file_var = Ar+
  [../]

  [./Ar*]
    initial_from_file_var = Ar*
  [../]

  [./mean_en]
    initial_from_file_var = mean_en
  [../]

  [./potential]
    initial_from_file_var = potential
  [../]
[]

[Kernels]
  #Electron Equations
    #Time Derivative term of electron
    [./em_time_deriv]
      type = ElectronTimeDerivative
      variable = em
    [../]
    #Advection term of electron
    [./em_advection]
      type = EFieldAdvection
      variable = em
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons
    [./em_diffusion]
      type = CoeffDiffusion
      variable = em
      position_units = ${dom0Scale}
    [../]
    #Net electron production from ionization
    [./em_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      mean_energy = mean_en
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from step-wise ionization
    [./em_stepwise_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      mean_energy = mean_en
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from metastable pooling
    [./em_pooling]
      type = ReactionSecondOrderLog
      variable = em
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

  #Argon Ion Equations
    #Time Derivative term of the ions
    [./Ar+_time_deriv]
      type = ElectronTimeDerivative
      variable = Ar+
    [../]
    #Advection term of ions
    [./Ar+_advection]
      type = EFieldAdvection
      variable = Ar+
      potential = potential
      position_units = ${dom0Scale}
    [../]
    [./Ar+_diffusion]
      type = CoeffDiffusion
      variable = Ar+
      position_units = ${dom0Scale}
    [../]
    #Net ion production from ionization
    [./Ar+_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      mean_energy = mean_en
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from step-wise ionization
    [./Ar+_stepwise_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      mean_energy = mean_en
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from metastable pooling
    [./Ar+_pooling]
      type = ReactionSecondOrderLog
      variable = Ar+
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

    #Argon Excited Equations
      #Time Derivative term of excited Argon
      [./Ar*_time_deriv]
        type = ElectronTimeDerivative
        variable = Ar*
      [../]
      #Diffusion term of excited Argon
      [./Ar*_diffusion]
        type = CoeffDiffusion
        variable = Ar*
        position_units = ${dom0Scale}
      [../]
      #Net excited Argon production from excitation
      [./Ar*_excitation]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar
        mean_energy = mean_en
        reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
        coefficient = 1
      [../]
      #Net excited Argon loss from step-wise ionization
      [./Ar*_stepwise_ionization]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from superelastic collisions
      [./Ar*_collisions]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from quenching to resonant
      [./Ar*_quenching]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from  metastable pooling
      [./Ar*_pooling]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar*
        reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
        coefficient = -2
        _v_eq_u = true
        _w_eq_u = true
      [../]
      #Net excited Argon loss from two-body quenching
      [./Ar*_2B_quenching]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]
      #Net excited Argon loss from three-body quenching
      [./Ar*_3B_quenching]
        type = ReactionThirdOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        x = Ar
        reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]

  #Voltage Equations
    #Voltage term in Poissons Eqaution
    [./potential_diffusion_dom0]
      type = CoeffDiffusionLin
      variable = potential
      position_units = ${dom0Scale}
    [../]
    #Ion term in Poissons Equation
    [./Ar+_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = Ar+
    [../]
    #Electron term in Poissons Equation
    [./em_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = em
    [../]


  #Electron Energy Equations
    #Time Derivative term of electron energy
    [./mean_en_time_deriv]
      type = ElectronTimeDerivative
      variable = mean_en
    [../]
    #Advection term of electron energy
    [./mean_en_advection]
      type = EFieldAdvection
      variable = mean_en
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons energy
    [./mean_en_diffusion]
      type = CoeffDiffusion
      variable = mean_en
      position_units = ${dom0Scale}
    [../]
    #Joule Heating term
    [./mean_en_joule_heating]
      type = JouleHeating
      variable = mean_en
      potential = potential
      em = em
      position_units = ${dom0Scale}
    [../]
    #Energy loss from ionization
    [./Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      threshold_energy = -15.7
    [../]
    #Energy loss from excitation
    [./Excitation_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
      threshold_energy = -11.56
    [../]
    #Energy loss from step-wise ionization
    [./Stepwise_Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      threshold_energy = -4.14
    [../]
    #Energy gain from superelastic collisions
    [./Collisions_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
      threshold_energy = 11.56
    [../]
  []


[AuxVariables]
  [./Te]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./x]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./x_node]
  [../]

  [./em_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar+_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar*_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar]
  [../]

  [./Efield]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Current_em]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./Current_Ar]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./emRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./exRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./swRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./deexRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./quRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./poolRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./TwoBRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./ThreeBRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
[]

[AuxKernels]
  [./emRate]
    type = ProcRateForRateCoeff
    variable = emRate
    v = em
    w = Ar
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
  [../]
  [./exRate]
    type = ProcRateForRateCoeff
    variable = exRate
    v = em
    w = Ar
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
  [../]
  [./swRate]
    type = ProcRateForRateCoeff
    variable = swRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
  [../]
  [./deexRate]
    type = ProcRateForRateCoeff
    variable = deexRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
  [../]
  [./quRate]
    type = ProcRateForRateCoeff
    variable = quRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
  [../]
  [./poolRate]
    type = ProcRateForRateCoeff
    variable = poolRate
    v = Ar*
    w = Ar*
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
  [../]
  [./TwoBRate]
    type = ProcRateForRateCoeff
    variable = TwoBRate
    v = Ar*
    w = Ar
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
  [../]
  [./ThreeBRate]
    type = ProcRateForRateCoeffThreeBody
    variable = ThreeBRate
    v = Ar*
    w = Ar
    vv = Ar
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
  [../]
  [./Te]
    type = ElectronTemperature
    variable = Te
    electron_density = em
    mean_en = mean_en
  [../]
  [./x_g]
    type = Position
    variable = x
    position_units = ${dom0Scale}
  [../]

  [./x_ng]
    type = Position
    variable = x_node
    position_units = ${dom0Scale}
  [../]

  [./em_lin]
    type = DensityMoles
    variable = em_lin
    density_log = em
  [../]
  [./Ar+_lin]
    type = DensityMoles
    variable = Ar+_lin
    density_log = Ar+
  [../]
  [./Ar*_lin]
    type = DensityMoles
    variable = Ar*_lin
    density_log = Ar*
  [../]

  [./Ar_val]
    type = ConstantAux
    variable = Ar
    # value = 3.22e22
    value = -2.928623
    execute_on = INITIAL
  [../]

  [./Efield_calc]
    type = Efield
    component = 0
    potential = potential
    variable = Efield
    position_units = ${dom0Scale}
  [../]
  [./Current_em]
    type = ADCurrent
    potential = potential
    density_log = em
    variable = Current_em
    art_diff = false
    block = 0
    position_units = ${dom0Scale}
  [../]
  [./Current_Ar]
    type = ADCurrent
    potential = potential
    density_log = Ar+
    variable = Current_Ar
    art_diff = false
    block = 0
    position_units = ${dom0Scale}
  [../]
[]


[BCs]
#Voltage Boundary Condition
  [./potential_left]
    type = FunctionDirichletBC
    variable = potential
    boundary = &#x27;left&#x27;
    function = potential_bc_func
    preset = false
  [../]
  [./potential_dirichlet_right]
    type = DirichletBC
    variable = potential
    boundary = &#x27;right&#x27;
    value = 0
    preset = false
  [../]

#Boundary conditions for electons
  [./em_physical_right]
    type = LymberopoulosElectronBC
    variable = em
    boundary = &#x27;right&#x27;
    gamma = 0.01
    #gamma = 1
    ks = 1.19e5
    #ks = 0.0
    ion = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]
  [./em_physical_left]
    type = LymberopoulosElectronBC
    variable = em
    boundary = &#x27;left&#x27;
    gamma = 0.01
    #gamma = 1
    ks = 1.19e5
    #ks = 0.0
    ion = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]

#Boundary conditions for ions
  [./Ar+_physical_right_advection]
    type = LymberopoulosIonBC
    variable = Ar+
    potential = potential
    boundary = &#x27;right&#x27;
    position_units = ${dom0Scale}
  [../]
  [./Ar+_physical_left_advection]
    type = LymberopoulosIonBC
    variable = Ar+
    potential = potential
    boundary = &#x27;left&#x27;
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for metastables
  [./Ar*_physical_right_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;right&#x27;
    value = 1e-5
  [../]
  [./Ar*_physical_left_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;left&#x27;
    value = 1e-5
  [../]

#Boundary conditions for electron mean energy
  [./mean_en_physical_right]
    type = ElectronTemperatureDirichletBC
    variable = mean_en
    em = em
    value = 0.5
    boundary = &#x27;right&#x27;
  [../]
  [./mean_en_physical_left]
    type = ElectronTemperatureDirichletBC
    variable = mean_en
    em = em
    value = 0.5
    boundary = &#x27;left&#x27;
  [../]
[]

[Functions]
  [./potential_bc_func]
    type = ParsedFunction
    value = &#x27;0.100*sin(2*pi*13.56e6*t)&#x27;
  [../]
[]

[Materials]
  [./GasBasics]
    type = GasElectronMoments
    interp_trans_coeffs = false
    interp_elastic_coeff = false
    ramp_trans_coeffs = false
    user_p_gas = 133.322
    em = em
    potential = potential
    mean_en = mean_en
    user_electron_mobility = 30.0
    user_electron_diffusion_coeff = 119.8757763975
    property_tables_file = Argon_reactions_paper_RateCoefficients/electron_moments.txt
  [../]
  [./gas_species_0]
    type = ADHeavySpecies
    heavy_species_name = Ar+
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 1.0
    mobility = 0.144409938
    diffusivity = 6.428571e-3
  [../]
  [./gas_species_1]
    type = ADHeavySpecies
    heavy_species_name = Ar*
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
    diffusivity = 7.515528e-3
  [../]
  [./gas_species_2]
    type = ADHeavySpecies
    heavy_species_name = Ar
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
  [../]
  [./reaction_0]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/reaction_em + Ar -&gt; em + Ar*.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_1]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/reaction_em + Ar -&gt; em + em + Ar+.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_2]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/reaction_em + Ar* -&gt; em + Ar.txt&#x27;
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_3]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/reaction_em + Ar* -&gt; em + em + Ar+.txt&#x27;
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_4]
    type = GenericRateConstant
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
    #reaction_rate_value = 2e-13
    reaction_rate_value = 1.2044e11
  [../]
  [./reaction_5]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
    #reaction_rate_value = 6.2e-16
    reaction_rate_value = 373364000
  [../]
  [./reaction_6]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
    #reaction_rate_value = 3e-21
    reaction_rate_value = 1806.6
  [../]
  [./reaction_7]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
    #reaction_rate_value = 1.1e-43
    reaction_rate_value = 39890.9324
  [../]
[]

[MultiApps]
  #MultiApp of Acceleration by Shooting Method
  [./Shooting]
    type = FullSolveMultiApp
    input_files = &#x27;Acceleration_By_Shooting_Method_Shooting.i&#x27;
    execute_on = &#x27;TIMESTEP_END&#x27;
    enable = false
  [../]
[]

[Transfers]
  #MultiApp Transfers for Acceleration by Shooting Method
  [./em_to_Shooting]
    type = MultiAppCopyTransfer
    to_multi_app = Shooting
    source_variable = em
    variable = em
    enable = false
  [../]
  [./Ar+_to_Shooting]
    type = MultiAppCopyTransfer
    to_multi_app = Shooting
    source_variable = Ar+
    variable = Ar+
    enable = false
  [../]
  [./mean_en_to_Shooting]
    type = MultiAppCopyTransfer
    to_multi_app = Shooting
    source_variable = mean_en
    variable = mean_en
    enable = false
  [../]
  [./potential_to_Shooting]
    type = MultiAppCopyTransfer
    to_multi_app = Shooting
    source_variable = potential
    variable = potential
    enable = false
  [../]
  [./Ar*_to_Shooting]
    type = MultiAppCopyTransfer
    to_multi_app = Shooting
    source_variable = Ar*
    variable = Ar*
    enable = false
  [../]
  [./Ar*S_to_Shooting]
    type = MultiAppCopyTransfer
    to_multi_app = Shooting
    source_variable = Ar*
    variable = Ar*S
    enable = false
  [../]

  [./Ar*New_from_Shooting]
    type = MultiAppCopyTransfer
    from_multi_app = Shooting
    source_variable = Ar*
    variable = Ar*
    enable = false
  [../]
[]

#The Action the add the TimePeriod Controls to turn off and on the MultiApps
[PeriodicControllers]
  [./Shooting]
    Enable_at_cycle_start = &#x27;MultiApps::Shooting
                              Transfers::em_to_Shooting *::Ar+_to_Shooting *::mean_en_to_Shooting
                              *::potential_to_Shooting *::Ar*_to_Shooting *::Ar*S_to_Shooting
                              Transfers::Ar*New_from_Shooting&#x27;
    starting_cycle = 55
    cycle_frequency = 13.56e6
    cycles_between_controls = 30
    num_controller_set = 2000
    name = Shooting
  [../]
[]

#New postprocessor that calculates the inverse of the plasma frequency
[Postprocessors]
  [./InversePlasmaFreq]
    type = PlasmaFrequencyInverse
    variable = em
    use_moles = true
    execute_on = &#x27;INITIAL TIMESTEP_BEGIN&#x27;
  [../]
[]


[Preconditioning]
  active = &#x27;smp&#x27;
  [./smp]
    type = SMP
    full = true
  [../]

  [./fdp]
    type = FDP
    full = true
  [../]
[]


[Executioner]
  type = Transient
  start_time = 3.68731563e-6
  end_time = 4.20353982e-6
  petsc_options = &#x27;-snes_converged_reason -snes_linesearch_monitor&#x27;
  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_shift_amount -ksp_type -snes_linesearch_minlambda&#x27;
  petsc_options_value = &#x27;lu NONZERO 1.e-10 fgmres 1e-3&#x27;

  dtmin = 1e-14
  l_max_its = 20

  scheme = bdf2
  dt = 1e-9
[]

[Outputs]
  perf_graph = true
  [./out]
    type = Exodus
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="1419b0f0-cf3a-458c-94dc-ccbb457d156a"><div class="modal-content"><h4>(test/tests/accelerations/Acceleration_By_Averaging_acceleration_sub.i)</h4><pre class="moose-pre"><code class="language-text">dom0Scale = 25.4e-3

[GlobalParams]
  potential_units = kV
  use_moles = true
[]

[Mesh]
  [./file]
    type = FileMeshGenerator
    file = &#x27;Lymberopoulos_paper.msh&#x27;
  [../]
  [./left]
    type = SideSetsFromNormalsGenerator
    normals = &#x27;-1 0 0&#x27;
    new_boundary = &#x27;left&#x27;
    input = file
  [../]
  [./right]
    type = SideSetsFromNormalsGenerator
    normals = &#x27;1 0 0&#x27;
    new_boundary = &#x27;right&#x27;
    input = left
  [../]
[]

[Problem]
  type = FEProblem
[]

[Variables]
  [./em]
  [../]

  [./Ar+]
  [../]

  [./Ar*]
  [../]

  [./mean_en]
  [../]

  [./potential]
  [../]
[]

[Kernels]
#Electron Equations
#Time Derivative term of electron
  [./em_time_deriv]
    type = ElectronTimeDerivative
    variable = em
  [../]
#Advection term of electron
  [./em_advection]
    type = EFieldAdvection
    variable = em
    potential = potential
    position_units = ${dom0Scale}
  [../]
#Diffusion term of electrons
  [./em_diffusion]
    type = CoeffDiffusion
    variable = em
    position_units = ${dom0Scale}
  [../]
#Net electron production from ionization
  [./em_ionization]
    type = EEDFReactionLog
    variable = em
    electrons = em
    mean_energy = mean_en
    target = Ar
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
    coefficient = 1
  [../]
#Net electron production from step - wise ionization
  [./em_stepwise_ionization]
    type = EEDFReactionLog
    variable = em
    electrons = em
    mean_energy = mean_en
    target = Ar*
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
    coefficient = 1
  [../]
#Net electron production from metastable pooling
  [./em_pooling]
    type = ReactionSecondOrderLog
    variable = em
    v = Ar*
    w = Ar*
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
    coefficient = 1
  [../]

#Argon Ion Equations
#Time Derivative term of the ions
  [./Ar+_time_deriv]
    type = ElectronTimeDerivative
    variable = Ar+
  [../]
#Advection term of ions
  [./Ar+_advection]
    type = EFieldAdvection
    variable = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]
  [./Ar+_diffusion]
    type = CoeffDiffusion
    variable = Ar+
    position_units = ${dom0Scale}
  [../]
#Net ion production from ionization
  [./Ar+_ionization]
    type = EEDFReactionLog
    variable = Ar+
    electrons = em
    mean_energy = mean_en
    target = Ar
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
    coefficient = 1
  [../]
#Net ion production from step - wise ionization
  [./Ar+_stepwise_ionization]
    type = EEDFReactionLog
    variable = Ar+
    electrons = em
    mean_energy = mean_en
    target = Ar*
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
    coefficient = 1
  [../]
#Net ion production from metastable pooling
  [./Ar+_pooling]
    type = ReactionSecondOrderLog
    variable = Ar+
    v = Ar*
    w = Ar*
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
    coefficient = 1
  [../]

#Argon Excited Equations
#Time Derivative term of excited Argon
  [./Ar*_time_deriv]
    type = ElectronTimeDerivative
    variable = Ar*
  [../]
#Diffusion term of excited Argon
  [./Ar*_diffusion]
    type = CoeffDiffusion
    variable = Ar*
    position_units = ${dom0Scale}
  [../]
#Net excited Argon production from excitation
  [./Ar*_excitation]
    type = EEDFReactionLog
    variable = Ar*
    electrons = em
    target = Ar
    mean_energy = mean_en
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
    coefficient = 1
  [../]
#Net excited Argon loss from step - wise ionization
  [./Ar*_stepwise_ionization]
    type = EEDFReactionLog
    variable = Ar*
    electrons = em
    target = Ar*
    mean_energy = mean_en
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
    coefficient = -1
  [../]
#Net excited Argon loss from superelastic collisions
  [./Ar*_collisions]
    type = EEDFReactionLog
    variable = Ar*
    electrons = em
    target = Ar*
    mean_energy = mean_en
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
    coefficient = -1
  [../]
#Net excited Argon loss from quenching to resonant
  [./Ar*_quenching]
    type = EEDFReactionLog
    variable = Ar*
    electrons = em
    target = Ar*
    mean_energy = mean_en
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
    coefficient = -1
  [../]
#Net excited Argon loss from metastable pooling
  [./Ar*_pooling]
    type = ReactionSecondOrderLog
    variable = Ar*
    v = Ar*
    w = Ar*
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
    coefficient = -2
    _v_eq_u = true
    _w_eq_u = true
  [../]
#Net excited Argon loss from two - body quenching
  [./Ar*_2B_quenching]
    type = ReactionSecondOrderLog
    variable = Ar*
    v = Ar*
    w = Ar
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
    coefficient = -1
    _v_eq_u = true
  [../]
#Net excited Argon loss from three - body quenching
  [./Ar*_3B_quenching]
    type = ReactionThirdOrderLog
    variable = Ar*
    v = Ar*
    w = Ar
    x = Ar
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
    coefficient = -1
    _v_eq_u = true
  [../]
#Voltage Equations
#Voltage term in Poissons Eqaution
  [./potential_diffusion_dom0]
    type = CoeffDiffusionLin
    variable = potential
    position_units = ${dom0Scale}
  [../]
#Ion term in Poissons Equation
  [./Ar+_charge_source]
    type = ChargeSourceMoles_KV
    variable = potential
    charged = Ar+
  [../]
#Electron term in Poissons Equation
  [./em_charge_source]
    type = ChargeSourceMoles_KV
    variable = potential
    charged = em
  [../]

#Electron Energy Equations
#Time Derivative term of electron energy
  [./mean_en_time_deriv]
    type = ElectronTimeDerivative
    variable = mean_en
  [../]
#Advection term of electron energy
  [./mean_en_advection]
    type = EFieldAdvection
    variable = mean_en
    potential = potential
    position_units = ${dom0Scale}
  [../]
#Diffusion term of electrons energy
  [./mean_en_diffusion]
    type = CoeffDiffusion
    variable = mean_en
    position_units = ${dom0Scale}
  [../]
#Joule Heating term
  [./mean_en_joule_heating]
    type = JouleHeating
    variable = mean_en
    potential = potential
    em = em
    position_units = ${dom0Scale}
  [../]
#Energy loss from ionization
  [./Ionization_Loss]
    type = EEDFEnergyLog
    variable = mean_en
    electrons = em
    target = Ar
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
    threshold_energy = -15.7
  [../]
#Energy loss from excitation
  [./Excitation_Loss]
    type = EEDFEnergyLog
    variable = mean_en
    electrons = em
    target = Ar
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
    threshold_energy = -11.56
  [../]
#Energy loss from step - wise ionization
  [./Stepwise_Ionization_Loss]
    type = EEDFEnergyLog
    variable = mean_en
    electrons = em
    target = Ar*
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
    threshold_energy = -4.14
  [../]
#Energy gain from superelastic collisions
  [./Collisions_Loss]
    type = EEDFEnergyLog
    variable = mean_en
    electrons = em
    target = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
    threshold_energy = 11.56
  [../]
[]

[AuxVariables]
  [./Ar]
  [../]
[]

[AuxKernels]
  [./Ar_val]
    type = ConstantAux
    variable = Ar
    #value = 3.22e22
    value = -2.928623
    execute_on = INITIAL
  [../]
[]

[BCs]
#Voltage Boundary Condition
  [./potential_left]
    type = FunctionDirichletBC
    variable = potential
    boundary = &#x27;left&#x27;
    function = potential_bc_func
    preset = false
  [../]
  [./potential_dirichlet_right]
    type = DirichletBC
    variable = potential
    boundary = &#x27;right&#x27;
    value = 0
    preset = false
  [../]

#Boundary conditions for electons
  [./em_physical_right]
    type = LymberopoulosElectronBC
    variable = em
    boundary = &#x27;right&#x27;
    gamma = 0.01
    #gamma = 1
    ks = 1.19e5
    #ks = 0.0
    ion = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]
  [./em_physical_left]
    type = LymberopoulosElectronBC
    variable = em
    boundary = &#x27;left&#x27;
    gamma = 0.01
    #gamma = 1
    ks = 1.19e5
    #ks = 0.0
    ion = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]

#Boundary conditions for ions
  [./Ar+_physical_right_advection]
    type = LymberopoulosIonBC
    variable = Ar+
    potential = potential
    boundary = &#x27;right&#x27;
    position_units = ${dom0Scale}
  [../]
  [./Ar+_physical_left_advection]
    type = LymberopoulosIonBC
    variable = Ar+
    potential = potential
    boundary = &#x27;left&#x27;
    position_units = ${dom0Scale}
  [../]

#Boundary conditions for ions Metastable
  [./Ar*_physical_right_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;right&#x27;
    value = 1e-5
  [../]
  [./Ar*_physical_left_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;left&#x27;
    value = 1e-5
  [../]

#Boundary conditions for electron mean energy
  [./mean_en_physical_right]
    type = ElectronTemperatureDirichletBC
    variable = mean_en
    em = em
    value = 0.5
    boundary = &#x27;right&#x27;
  [../]
  [./mean_en_physical_left]
    type = ElectronTemperatureDirichletBC
    variable = mean_en
    em = em
    value = 0.5
    boundary = &#x27;left&#x27;
  [../]
[]

[Functions]
  [./potential_bc_func]
    type = ParsedFunction
    value = &#x27;0.100*sin(2*pi*13.56e6*t)&#x27;
  [../]
[]

[Materials]
  [./GasBasics]
    type = GasElectronMoments
    interp_trans_coeffs = false
    interp_elastic_coeff = false
    ramp_trans_coeffs = false
    user_p_gas = 133.322
    em = em
    potential = potential
    mean_en = mean_en
    user_electron_mobility = 30.0
    user_electron_diffusion_coeff = 119.8757763975
    property_tables_file = Argon_reactions_paper_RateCoefficients/electron_moments.txt
  [../]
  [./gas_species_0]
    type = ADHeavySpecies
    heavy_species_name = Ar+
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 1.0
    mobility = 0.144409938
    diffusivity = 6.428571e-3
  [../]
  [./gas_species_1]
    type = ADHeavySpecies
    heavy_species_name = Ar*
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
    diffusivity = 7.515528e-3
  [../]
  [./gas_species_2]
    type = ADHeavySpecies
    heavy_species_name = Ar
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
  [../]
  [./reaction_0]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/reaction_em + Ar -&gt; em + Ar*.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_1]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/reaction_em + Ar -&gt; em + em + Ar+.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_2]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/reaction_em + Ar* -&gt; em + Ar.txt&#x27;
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_3]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/reaction_em + Ar* -&gt; em + em + Ar+.txt&#x27;
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_4]
    type = GenericRateConstant
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
    #reaction_rate_value = 2e-13
    reaction_rate_value = 1.2044e11
  [../]
  [./reaction_5]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
    #reaction_rate_value = 6.2e-16
    reaction_rate_value = 373364000
  [../]
  [./reaction_6]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
    #reaction_rate_value = 3e-21
    reaction_rate_value = 1806.6
  [../]
  [./reaction_7]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
    #reaction_rate_value = 1.1e-43
    reaction_rate_value = 39890.9324
  [../]
[]

#New postprocessor that calculates the inverse of the plasma frequency
[Postprocessors]
  [./InversePlasmaFreq]
    type = PlasmaFrequencyInverse
    variable = em
    use_moles = true
    execute_on = &#x27;INITIAL TIMESTEP_BEGIN&#x27;
  [../]
[]

[Preconditioning]
  active = &#x27;smp&#x27;
  [./smp]
    type = SMP
    full = true
  [../]

  [./fdp]
    type = FDP
    full = true
  [../]
[]

[Executioner]
  type = Transient
  end_time = 73.74631268e-9
  petsc_options = &#x27;-snes_converged_reason -snes_linesearch_monitor&#x27;
  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_shift_amount -ksp_type -snes_linesearch_minlambda&#x27;
  petsc_options_value = &#x27;lu NONZERO 1.e-10 fgmres 1e-3&#x27;
  dtmin = 1e-14
  l_max_its = 20
  scheme = bdf2
  dt = 1e-9
[]

[Outputs]
  perf_graph = true
  [./out]
    type = Exodus
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="1fb17f18-6ebb-470f-9f70-95dd216bd46b"><div class="modal-content"><h4>(tutorial/tutorial06-Building-InputFile/RF_Plasma_WithOut_Metastables.i)</h4><pre class="moose-pre"><code class="language-text">dom0Scale=25.4e-3

[GlobalParams]
  potential_units = kV
  use_moles = true
[]

[Mesh]
  [./geo]
    type = FileMeshGenerator
    file = &#x27;Lymberopoulos_paper.msh&#x27;
  [../]
  [./left]
    type = SideSetsFromNormalsGenerator
    normals = &#x27;-1 0 0&#x27;
    new_boundary = &#x27;left&#x27;
    input = geo
  [../]
  [./right]
    type = SideSetsFromNormalsGenerator
    normals = &#x27;1 0 0&#x27;
    new_boundary = &#x27;right&#x27;
    input = left
  [../]
[]

[Problem]
  type = FEProblem
[]

[DriftDiffusionAction]
  [./Plasma]
    electrons = em
    charged_particle = Ar+
    potential = potential
    Is_potential_unique = true
    mean_energy = mean_en
    position_units = ${dom0Scale}
    Additional_Outputs = &#x27;ElectronTemperature Current EField&#x27;
  [../]
[]

[Reactions]
  [./Argon]
    species = &#x27;em Ar+&#x27;
    aux_species = &#x27;Ar&#x27;
    reaction_coefficient_format = &#x27;rate&#x27;
    gas_species = &#x27;Ar&#x27;
    electron_energy = &#x27;mean_en&#x27;
    electron_density = &#x27;em&#x27;
    include_electrons = true
    file_location = &#x27;rate_coefficients&#x27;
    potential = &#x27;potential&#x27;
    use_log = true
    use_ad = true
    position_units = ${dom0Scale}
    block = 0
    reactions = &#x27;em + Ar -&gt; em + Ar*        : EEDF [-11.56] (reaction1)
                 em + Ar -&gt; em + em + Ar+   : EEDF [-15.7] (reaction2)&#x27;
  [../]
[]

[AuxVariables]
  [./x_node]
  [../]

  [./Ar]
  [../]
[]

[AuxKernels]
  [./x_ng]
    type = Position
    variable = x_node
    position_units = ${dom0Scale}
  [../]

  [./Ar_val]
    type = FunctionAux
    variable = Ar
    function = &#x27;log(3.22e22/6.022e23)&#x27;
    execute_on = INITIAL
  [../]
[]


[BCs]
#Voltage Boundary Condition
  [./potential_left]
    type = FunctionDirichletBC
    variable = potential
    boundary = &#x27;left&#x27;
    function = potential_bc_func
    preset = false
  [../]
  [./potential_dirichlet_right]
    type = DirichletBC
    variable = potential
    boundary = &#x27;right&#x27;
    value = 0
    preset = false
  [../]

#Boundary conditions for electons
  [./em_physical_right]
    type = LymberopoulosElectronBC
    variable = em
    boundary = &#x27;right&#x27;
    gamma = 0.01
    ks = 1.19e5
    ion = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]
  [./em_physical_left]
    type = LymberopoulosElectronBC
    variable = em
    boundary = &#x27;left&#x27;
    gamma = 0.01
    ks = 1.19e5
    ion = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]

#Boundary conditions for ions
  [./Ar+_physical_right_advection]
    type = LymberopoulosIonBC
    variable = Ar+
    potential = potential
    boundary = &#x27;right&#x27;
    position_units = ${dom0Scale}
  [../]
  [./Ar+_physical_left_advection]
    type = LymberopoulosIonBC
    variable = Ar+
    potential = potential
    boundary = &#x27;left&#x27;
    position_units = ${dom0Scale}
  [../]

#Boundary conditions for mean energy
  [./mean_en_physical_right]
    type = ElectronTemperatureDirichletBC
    variable = mean_en
    em = em
    value = 0.5
    boundary = &#x27;right&#x27;
  [../]
  [./mean_en_physical_left]
    type = ElectronTemperatureDirichletBC
    variable = mean_en
    em = em
    value = 0.5
    boundary = &#x27;left&#x27;
  [../]

[]


[ICs]
  [./em_ic]
    type = FunctionIC
    variable = em
    function = density_ic_func
  [../]
  [./Ar+_ic]
    type = FunctionIC
    variable = Ar+
    function = density_ic_func
  [../]

  [./mean_en_ic]
    type = FunctionIC
    variable = mean_en
    function = energy_density_ic_func
  [../]

  [./potential_ic]
    type = FunctionIC
    variable = potential
    function = potential_ic_func
  [../]
[]

[Functions]
  [./potential_bc_func]
    type = ParsedFunction
    value = &#x27;0.100*sin(2*3.1415926*13.56e6*t)&#x27;
  [../]
  [./potential_ic_func]
    type = ParsedFunction
    value = &#x27;0.100 * (25.4e-3 - x)&#x27;
  [../]
  [./density_ic_func]
    type = ParsedFunction
    value = &#x27;log((1e13 + 1e15 * (1-x/1)^2 * (x/1)^2)/6.022e23)&#x27;
  [../]
  [./energy_density_ic_func]
    type = ParsedFunction
    value = &#x27;log(3./2.) + log((1e13 + 1e15 * (1-x/1)^2 * (x/1)^2)/6.022e23)&#x27;
  [../]
[]

[Materials]
  [./GasBasics]
    type = GasElectronMoments
    interp_trans_coeffs = false
    interp_elastic_coeff = false
    ramp_trans_coeffs = false
    user_p_gas = 133.322
    em = em
    potential = potential
    mean_en = mean_en
    user_electron_mobility = 30.0
    user_electron_diffusion_coeff = 119.8757763975
    property_tables_file = rate_coefficients/electron_moments.txt
  [../]
  [./gas_species_0]
    type = ADHeavySpecies
    heavy_species_name = Ar+
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 1.0
    mobility = 0.144409938
    diffusivity = 6.428571e-3
  [../]
  [./gas_species_2]
    type = ADHeavySpecies
    heavy_species_name = Ar
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
  [../]
[]

[Preconditioning]
  active = &#x27;smp&#x27;
  [./smp]
    type = SMP
    full = true
  [../]

  [./fdp]
    type = FDP
    full = true
  [../]
[]


[Executioner]
  type = Transient
  end_time = 7.3746e-5
  dt = 1e-9
  dtmin = 1e-14
  scheme = bdf2
  solve_type = NEWTON

  petsc_options = &#x27;-snes_converged_reason -snes_linesearch_monitor&#x27;
  petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_shift_amount -snes_linesearch_minlambda&#x27;
  petsc_options_value = &#x27;lu NONZERO 1.e-10 1e-3&#x27;

  nl_rel_tol = 1e-08
  l_max_its = 20
[]

[Outputs]
  perf_graph = true
  [./out]
    type = Exodus
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="7ae0e14e-a268-481d-b934-57b286d7d7c2"><div class="modal-content"><h4>(test/tests/accelerations/Acceleration_By_Shooting_Method_SensitivityMatrix.i)</h4><pre class="moose-pre"><code class="language-text">dom0Scale=25.4e-3

[GlobalParams]
  potential_units = kV
  use_moles = true
[]

[Mesh]
  [./file]
    type = FileMeshGenerator
    file = &#x27;Lymberopoulos_paper.msh&#x27;
  [../]
  [./left]
    type = SideSetsFromNormalsGenerator
    normals = &#x27;-1 0 0&#x27;
    new_boundary = &#x27;left&#x27;
    input = file
  [../]
  [./right]
    type = SideSetsFromNormalsGenerator
    normals = &#x27;1 0 0&#x27;
    new_boundary = &#x27;right&#x27;
    input = left
  [../]
[]

[Problem]
  type = FEProblem
[]

[Variables]
  [./em]
  [../]

  [./Ar+]
  [../]

  [./Ar*]
  [../]

  [./mean_en]
  [../]

  [./potential]
  [../]

  [./SMDeriv]
  [../]
[]

[Kernels]
  #Electron Equations (Same as in paper)
    #Time Derivative term of electron
    [./em_time_deriv]
      type = ElectronTimeDerivative
      variable = em
    [../]
    #Advection term of electron
    [./em_advection]
      type = EFieldAdvection
      variable = em
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons
    [./em_diffusion]
      type = CoeffDiffusion
      variable = em
      position_units = ${dom0Scale}
    [../]
    #Net electron production from ionization
    [./em_ionization]
      type = ADEEDFReactionLog
      variable = em
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from step-wise ionization
    [./em_stepwise_ionization]
      type = ADEEDFReactionLog
      variable = em
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from metastable pooling
    [./em_pooling]
      type = ADReactionSecondOrderLog
      variable = em
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

  #Argon Ion Equations (Same as in paper)
    #Time Derivative term of the ions
    [./Ar+_time_deriv]
      type = ElectronTimeDerivative
      variable = Ar+
    [../]
    #Advection term of ions
    [./Ar+_advection]
      type = EFieldAdvection
      variable = Ar+
      potential = potential
      position_units = ${dom0Scale}
    [../]
    [./Ar+_diffusion]
      type = CoeffDiffusion
      variable = Ar+
      position_units = ${dom0Scale}
    [../]
    #Net ion production from ionization
    [./Ar+_ionization]
      type = ADEEDFReactionLog
      variable = Ar+
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from step-wise ionization
    [./Ar+_stepwise_ionization]
      type = ADEEDFReactionLog
      variable = Ar+
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from metastable pooling
    [./Ar+_pooling]
      type = ADReactionSecondOrderLog
      variable = Ar+
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

    #Argon Excited Equations (Same as in paper)
      #Time Derivative term of excited Argon
      [./Ar*_time_deriv]
        type = ElectronTimeDerivative
        variable = Ar*
      [../]
      #Diffusion term of excited Argon
      [./Ar*_diffusion]
        type = CoeffDiffusion
        variable = Ar*
        position_units = ${dom0Scale}
      [../]
      #Net excited Argon production from excitation
      [./Ar*_excitation]
        type = ADEEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar
        reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
        coefficient = 1
      [../]
      #Net excited Argon loss from step-wise ionization
      [./Ar*_stepwise_ionization]
        type = ADEEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from superelastic collisions
      [./Ar*_collisions]
        type = ADEEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from quenching to resonant
      [./Ar*_quenching]
        type = ADEEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from  metastable pooling
      [./Ar*_pooling]
        type = ADReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar*
        reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
        coefficient = -2
        _v_eq_u = true
        _w_eq_u = true
      [../]
      #Net excited Argon loss from two-body quenching
      [./Ar*_2B_quenching]
        type = ADReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]
      #Net excited Argon loss from three-body quenching
      [./Ar*_3B_quenching]
        type = ADReactionThirdOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        x = Ar
        reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]

  #Voltage Equations (Same as in paper)
    #Voltage term in Poissons Eqaution
    [./potential_diffusion_dom0]
      type = CoeffDiffusionLin
      variable = potential
      position_units = ${dom0Scale}
    [../]
    #Ion term in Poissons Equation
    [./Ar+_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = Ar+
    [../]
    #Electron term in Poissons Equation
    [./em_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = em
    [../]


  #Since the paper uses electron temperature as a variable, the energy equation is in
  #a different form but should be the same physics
    #Time Derivative term of electron energy
    [./mean_en_time_deriv]
      type = ElectronTimeDerivative
      variable = mean_en
    [../]
    #Advection term of electron energy
    [./mean_en_advection]
      type = EFieldAdvection
      variable = mean_en
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons energy
    [./mean_en_diffusion]
      type = CoeffDiffusion
      variable = mean_en
      position_units = ${dom0Scale}
    [../]
    #Joule Heating term
    [./mean_en_joule_heating]
      type = JouleHeating
      variable = mean_en
      potential = potential
      em = em
      position_units = ${dom0Scale}
    [../]
    #Energy loss from ionization
    [./Ionization_Loss]
      type = ADEEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      threshold_energy = -15.7
    [../]
    #Energy loss from excitation
    [./Excitation_Loss]
      type = ADEEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
      threshold_energy = -11.56
    [../]
    #Energy loss from step-wise ionization
    [./Stepwise_Ionization_Loss]
      type = ADEEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      threshold_energy = -4.14
    [../]
    #Energy gain from superelastic collisions
    [./Collisions_Loss]
      type = ADEEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
      threshold_energy = 11.56
    [../]

  #Argon Excited Equations For Shooting Method
  #Time Derivative term of excited Argon
  [./SM_Ar*_time_deriv]
    type = TimeDerivative
    variable = SMDeriv
  [../]
  #Diffusion term of excited Argon
  [./SM_Ar*_diffusion]
    type = CoeffDiffusionForShootMethod
    variable = SMDeriv
    density = Ar*
    position_units = ${dom0Scale}
  [../]
  #Net excited Argon loss from step-wise ionization
  [./SM_Ar*_stepwise_ionization]
    type = EEDFReactionLogForShootMethod
    variable = SMDeriv
    density = Ar*
    electron = em
    energy = mean_en
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
    coefficient = -1
  [../]
  #Net excited Argon loss from superelastic collisions
  [./SM_Ar*_collisions]
    type = EEDFReactionLogForShootMethod
    variable = SMDeriv
    density = Ar*
    electron = em
    energy = mean_en
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
    coefficient = -1
  [../]
  #Net excited Argon loss from quenching to resonant
  [./SM_Ar*_quenching]
    type = ReactionSecondOrderLogForShootMethod
    variable = SMDeriv
    density = Ar*
    v = em
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
    coefficient = -1
  [../]
  #Net excited Argon loss from  metastable pooling
  [./SM_Ar*_pooling]
    type = ReactionSecondOrderLogForShootMethod
    variable = SMDeriv
    density = Ar*
    v = Ar*
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
    coefficient = -2
  [../]
  #Net excited Argon loss from two-body quenching
  [./SM_Ar*_2B_quenching]
    type = ReactionSecondOrderLogForShootMethod
    variable = SMDeriv
    density = Ar*
    v = Ar
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
    coefficient = -1
  [../]
  #Net excited Argon loss from three-body quenching
  [./SM_Ar*_3B_quenching]
    type = ReactionThirdOrderLogForShootMethod
    variable = SMDeriv
    density = Ar*
    v = Ar
    w = Ar
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
    coefficient = -1
  [../]
[]


[AuxVariables]
  [./emDeBug]
  [../]
  [./Ar+_DeBug]
  [../]
  [./Ar*_DeBug]
  [../]
  [./mean_enDeBug]
  [../]

  [./Te]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./x]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./x_node]
  [../]

  [./rho]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./em_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar+_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar*_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar]
  [../]

  [./Efield]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Current_em]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./Current_Ar]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./emRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./exRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./swRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./deexRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./quRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./poolRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./TwoBRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./ThreeBRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
[]

[AuxKernels]
  [./emDeBug]
    type = DebugResidualAux
    variable = emDeBug
    debug_variable = em
    #execute_on = &#x27;LINEAR NONLINEAR TIMESTEP_BEGIN&#x27;
  [../]
  [./Ar+_DeBug]
    type = DebugResidualAux
    variable = Ar+_DeBug
    debug_variable = Ar+
    #execute_on = &#x27;LINEAR NONLINEAR TIMESTEP_BEGIN&#x27;
  [../]
  [./mean_enDeBug]
    type = DebugResidualAux
    variable = mean_enDeBug
    debug_variable = mean_en
    #execute_on = &#x27;LINEAR NONLINEAR TIMESTEP_BEGIN&#x27;
  [../]
  [./Ar*_DeBug]
    type = DebugResidualAux
    variable = Ar*_DeBug
    debug_variable = Ar*
    #execute_on = &#x27;LINEAR NONLINEAR TIMESTEP_BEGIN&#x27;
  [../]

  [./emRate]
    type = ADProcRateForRateCoeff
    variable = emRate
    v = em
    w = Ar
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
  [../]
  [./exRate]
    type = ADProcRateForRateCoeff
    variable = exRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
  [../]
  [./swRate]
    type = ADProcRateForRateCoeff
    variable = swRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
  [../]
  [./deexRate]
    type = ADProcRateForRateCoeff
    variable = deexRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
  [../]
  [./quRate]
    type = ADProcRateForRateCoeff
    variable = quRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
  [../]
  [./poolRate]
    type = ADProcRateForRateCoeff
    variable = poolRate
    v = Ar*
    w = Ar*
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
  [../]
  [./TwoBRate]
    type = ADProcRateForRateCoeff
    variable = TwoBRate
    v = Ar*
    w = Ar
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
  [../]
  [./ThreeBRate]
    type = ADProcRateForRateCoeffThreeBody
    variable = ThreeBRate
    v = Ar*
    w = Ar
    vv = Ar
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
  [../]
  [./Te]
    type = ElectronTemperature
    variable = Te
    electron_density = em
    mean_en = mean_en
  [../]
  [./x_g]
    type = Position
    variable = x
    position_units = ${dom0Scale}
  [../]

  [./x_ng]
    type = Position
    variable = x_node
    position_units = ${dom0Scale}
  [../]

  [./em_lin]
    type = DensityMoles
    variable = em_lin
    density_log = em
  [../]
  [./Ar+_lin]
    type = DensityMoles
    variable = Ar+_lin
    density_log = Ar+
  [../]
  [./Ar*_lin]
    type = DensityMoles
    variable = Ar*_lin
    density_log = Ar*
  [../]

  [./Ar_val]
    type = ConstantAux
    variable = Ar
    # value = 3.22e22
    value = -2.928623
    execute_on = INITIAL
  [../]

  [./Efield_calc]
    type = Efield
    component = 0
    potential = potential
    variable = Efield
    position_units = ${dom0Scale}
  [../]
  [./Current_em]
    type = ADCurrent
    potential = potential
    density_log = em
    variable = Current_em
    art_diff = false
    block = 0
    position_units = ${dom0Scale}
  [../]
  [./Current_Ar]
    type = ADCurrent
    potential = potential
    density_log = Ar+
    variable = Current_Ar
    art_diff = false
    block = 0
    position_units = ${dom0Scale}
  [../]
[]


[BCs]
#Voltage Boundary Condition, same as in paper
  [./potential_left]
    type = FunctionDirichletBC
    variable = potential
    boundary = &#x27;left&#x27;
    function = potential_bc_func
    preset = false
  [../]
  [./potential_dirichlet_right]
    type = DirichletBC
    variable = potential
    boundary = &#x27;right&#x27;
    value = 0
    preset = false
  [../]

#New Boundary conditions for electons, same as in paper
  [./em_physical_right]
    type = LymberopoulosElectronBC
    variable = em
    boundary = &#x27;right&#x27;
    gamma = 0.01
    #gamma = 1
    ks = 1.19e5
    #ks = 0.0
    ion = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]
  [./em_physical_left]
    type = LymberopoulosElectronBC
    variable = em
    boundary = &#x27;left&#x27;
    gamma = 0.01
    #gamma = 1
    ks = 1.19e5
    #ks = 0.0
    ion = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
  [./Ar+_physical_right_advection]
    type = LymberopoulosIonBC
    variable = Ar+
    potential = potential
    boundary = &#x27;right&#x27;
    position_units = ${dom0Scale}
  [../]
  [./Ar+_physical_left_advection]
    type = LymberopoulosIonBC
    variable = Ar+
    potential = potential
    boundary = &#x27;left&#x27;
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
#(except the metastables are not set to zero, since Zapdos uses log form)
  [./Ar*_physical_right_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;right&#x27;
    value = 1e-5
  [../]
  [./Ar*_physical_left_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;left&#x27;
    value = 1e-5
  [../]

#New Boundary conditions for mean energy, should be the same as in paper
  [./mean_en_physical_right]
    type = ElectronTemperatureDirichletBC
    variable = mean_en
    em = em
    value = 0.5
    boundary = &#x27;right&#x27;
  [../]
  [./mean_en_physical_left]
    type = ElectronTemperatureDirichletBC
    variable = mean_en
    em = em
    value = 0.5
    boundary = &#x27;left&#x27;
  [../]

[]

[Functions]
  [./potential_bc_func]
    type = ParsedFunction
    value = &#x27;0.100*sin(2*pi*13.56e6*t)&#x27;
  [../]
[]

[Materials]
  [./GasBasics]
    type = GasElectronMoments
    interp_trans_coeffs = false
    interp_elastic_coeff = false
    ramp_trans_coeffs = false
    user_p_gas = 133.322
    em = em
    potential = potential
    mean_en = mean_en
    user_electron_mobility = 30.0
    user_electron_diffusion_coeff = 119.8757763975
    property_tables_file = Argon_reactions_paper_RateCoefficients/electron_moments.txt
  [../]
  [./gas_species_0]
    type = ADHeavySpecies
    heavy_species_name = Ar+
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 1.0
    mobility = 0.144409938
    diffusivity = 6.428571e-3
  [../]
  [./gas_species_1]
    type = ADHeavySpecies
    heavy_species_name = Ar*
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
    diffusivity = 7.515528e-3
  [../]
  [./gas_species_2]
    type = ADHeavySpecies
    heavy_species_name = Ar
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
  [../]
  [./reaction_0]
    type = ADZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/reaction_em + Ar -&gt; em + Ar*.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_1]
    type = ADZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/reaction_em + Ar -&gt; em + em + Ar+.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_2]
    type = ADZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/reaction_em + Ar* -&gt; em + Ar.txt&#x27;
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_3]
    type = ADZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/reaction_em + Ar* -&gt; em + em + Ar+.txt&#x27;
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_4]
    type = ADGenericRateConstant
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
    #reaction_rate_value = 2e-13
    reaction_rate_value = 1.2044e11
  [../]
  [./reaction_5]
    type = ADGenericRateConstant
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
    #reaction_rate_value = 6.2e-16
    reaction_rate_value = 373364000
  [../]
  [./reaction_6]
    type = ADGenericRateConstant
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
    #reaction_rate_value = 3e-21
    reaction_rate_value = 1806.6
  [../]
  [./reaction_7]
    type = ADGenericRateConstant
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
    #reaction_rate_value = 1.1e-43
    reaction_rate_value = 39890.9324
  [../]
[]

#New postprocessor that calculates the inverse of the plasma frequency
[Postprocessors]
  [./InversePlasmaFreq]
    type = PlasmaFrequencyInverse
    variable = em
    use_moles = true
    execute_on = &#x27;INITIAL TIMESTEP_BEGIN&#x27;
  [../]
[]


[Preconditioning]
  active = &#x27;smp&#x27;
  [./smp]
    type = SMP
    full = true
  [../]

  [./fdp]
    type = FDP
    full = true
  [../]
[]


[Executioner]
  type = Transient
  end_time = 73.74631268e-9
  petsc_options = &#x27;-snes_converged_reason -snes_linesearch_monitor&#x27;
  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_shift_amount -ksp_type -snes_linesearch_minlambda&#x27;
  petsc_options_value = &#x27;lu NONZERO 1.e-10 fgmres 1e-3&#x27;
  nl_rel_tol = 1e-08
  #nl_abs_tol = 7.6e-5 #Commit out do to test falure on Mac
  dtmin = 1e-14
  l_max_its = 20

  scheme = bdf2
  dt = 1e-9
[]

[Outputs]
  perf_graph = true
  [./out]
    type = Exodus
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="c145a067-bfb9-4d4b-939d-48073747f169"><div class="modal-content"><h4>(test/tests/DriftDiffusionAction/RF_Plasma_actions.i)</h4><pre class="moose-pre"><code class="language-text">dom0Scale=25.4e-3

[GlobalParams]
  potential_units = kV
  use_moles = true
[]

[Mesh]
  [./file]
    type = FileMeshGenerator
    file = &#x27;Lymberopoulos.msh&#x27;
  [../]
  [./left]
    type = SideSetsFromNormalsGenerator
    normals = &#x27;-1 0 0&#x27;
    new_boundary = &#x27;left&#x27;
    input = file
  [../]
  [./right]
    type = SideSetsFromNormalsGenerator
    normals = &#x27;1 0 0&#x27;
    new_boundary = &#x27;right&#x27;
    input = left
  [../]
[]

[Problem]
  type = FEProblem
[]

#Action the supplies the drift-diffusion equations
#This action also adds JouleHeating and the ChargeSourceMoles_KV Kernels
[DriftDiffusionAction]
  [./Plasma]
    electrons = em
    charged_particle = Ar+
    Neutrals = Ar*
    mean_energy = mean_en
    potential = potential
    Is_potential_unique = true
    using_offset = false
    position_units = ${dom0Scale}
    Additional_Outputs = &#x27;ElectronTemperature Current EField&#x27;
  [../]
[]

#The Kernels supply the sources terms
[Kernels]
    #Net electron production from ionization
    [./em_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      target = Ar
      mean_energy = mean_en
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from step-wise ionization
    [./em_stepwise_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      target = Ar*
      mean_energy = mean_en
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from metastable pooling
    [./em_pooling]
      type = ReactionSecondOrderLog
      variable = em
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

    #Net ion production from ionization
    [./Ar+_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      target = Ar
      mean_energy = mean_en
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from step-wise ionization
    [./Ar+_stepwise_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      target = Ar*
      mean_energy = mean_en
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from metastable pooling
    [./Ar+_pooling]
      type = ReactionSecondOrderLog
      variable = Ar+
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

      #Net excited Argon production from excitation
      [./Ar*_excitation]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar
        mean_energy = mean_en
        reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
        coefficient = 1
      [../]
      #Net excited Argon loss from step-wise ionization
      [./Ar*_stepwise_ionization]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from superelastic collisions
      [./Ar*_collisions]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from quenching to resonant
      [./Ar*_quenching]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from  metastable pooling
      [./Ar*_pooling]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar*
        reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
        coefficient = -2
        _v_eq_u = true
        _w_eq_u = true
      [../]
      #Net excited Argon loss from two-body quenching
      [./Ar*_2B_quenching]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]
      #Net excited Argon loss from three-body quenching
      [./Ar*_3B_quenching]
        type = ReactionThirdOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        x = Ar
        reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]

    #Energy loss from ionization
    [./Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      threshold_energy = -15.7
    [../]
    #Energy loss from excitation
    [./Excitation_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
      threshold_energy = -11.56
    [../]
    #Energy loss from step-wise ionization
    [./Stepwise_Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      threshold_energy = -4.14
    [../]
    #Energy gain from superelastic collisions
    [./Collisions_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
      threshold_energy = 11.56
    [../]
  []


[AuxVariables]
  [./x_node]
  [../]

  [./rho]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar]
  [../]

  [./emRate]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./exRate]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./swRate]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./deexRate]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./quRate]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./poolRate]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./TwoBRate]
    order = CONSTANT
    family = MONOMIAL
  [../]
  [./ThreeBRate]
    order = CONSTANT
    family = MONOMIAL
  [../]
[]

[AuxKernels]
  [./emRate]
    type = ProcRateForRateCoeff
    variable = emRate
    v = em
    w = Ar
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
  [../]
  [./exRate]
    type = ProcRateForRateCoeff
    variable = exRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
  [../]
  [./swRate]
    type = ProcRateForRateCoeff
    variable = swRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
  [../]
  [./deexRate]
    type = ProcRateForRateCoeff
    variable = deexRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
  [../]
  [./quRate]
    type = ProcRateForRateCoeff
    variable = quRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
  [../]
  [./poolRate]
    type = ProcRateForRateCoeff
    variable = poolRate
    v = Ar*
    w = Ar*
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
  [../]
  [./TwoBRate]
    type = ProcRateForRateCoeff
    variable = TwoBRate
    v = Ar*
    w = Ar
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
  [../]
  [./ThreeBRate]
    type = ProcRateForRateCoeffThreeBody
    variable = ThreeBRate
    v = Ar*
    w = Ar
    vv = Ar
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
  [../]

  [./x_ng]
    type = Position
    variable = x_node
    position_units = ${dom0Scale}
  [../]

  [./Ar_val]
    type = ConstantAux
    variable = Ar
    # value = 3.22e22
    value = -2.928623
    execute_on = INITIAL
  [../]
[]


[BCs]
#Voltage Boundary Condition, same as in paper
  [./potential_left]
    type = FunctionDirichletBC
    variable = potential
    boundary = &#x27;left&#x27;
    function = potential_bc_func
    preset = false
  [../]
  [./potential_dirichlet_right]
    type = DirichletBC
    variable = potential
    boundary = &#x27;right&#x27;
    value = 0
    preset = false
  [../]

#New Boundary conditions for electons, same as in paper
  [./em_physical_right]
    type = LymberopoulosElectronBC
    variable = em
    boundary = &#x27;right&#x27;
    gamma = 0.01
    #gamma = 1
    ks = 1.19e5
    #ks = 0.0
    ion = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]
  [./em_physical_left]
    type = LymberopoulosElectronBC
    variable = em
    boundary = &#x27;left&#x27;
    gamma = 0.01
    #gamma = 1
    ks = 1.19e5
    #ks = 0.0
    ion = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
  [./Ar+_physical_right_advection]
    type = LymberopoulosIonBC
    variable = Ar+
    potential = potential
    boundary = &#x27;right&#x27;
    position_units = ${dom0Scale}
  [../]
  [./Ar+_physical_left_advection]
    type = LymberopoulosIonBC
    variable = Ar+
    potential = potential
    boundary = &#x27;left&#x27;
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
#(except the metastables are not set to zero, since Zapdos uses log form)
  [./Ar*_physical_right_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;right&#x27;
    value = 100
  [../]
  [./Ar*_physical_left_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;left&#x27;
    value = 100
  [../]

#New Boundary conditions for mean energy, should be the same as in paper
  [./mean_en_physical_right]
    type = ElectronTemperatureDirichletBC
    variable = mean_en
    em = em
    value = 0.5
    boundary = &#x27;right&#x27;
  [../]
  [./mean_en_physical_left]
    type = ElectronTemperatureDirichletBC
    variable = mean_en
    em = em
    value = 0.5
    boundary = &#x27;left&#x27;
  [../]

[]


[ICs]
  [./em_ic]
    type = FunctionIC
    variable = em
    function = density_ic_func
  [../]
  [./Ar+_ic]
    type = FunctionIC
    variable = Ar+
    function = density_ic_func
  [../]
  [./Ar*_ic]
    type = FunctionIC
    variable = Ar*
    function = density_ic_func
  [../]
  [./mean_en_ic]
    type = FunctionIC
    variable = mean_en
    function = energy_density_ic_func
  [../]

  [./potential_ic]
    type = FunctionIC
    variable = potential
    function = potential_ic_func
  [../]
[]

[Functions]
  [./potential_bc_func]
    type = ParsedFunction
    value = &#x27;0.100*sin(2*3.1415926*13.56e6*t)&#x27;
  [../]
  [./potential_ic_func]
    type = ParsedFunction
    value = &#x27;0.100 * (25.4e-3 - x)&#x27;
  [../]
  [./density_ic_func]
    type = ParsedFunction
    value = &#x27;log((1e13 + 1e15 * (1-x/1)^2 * (x/1)^2)/6.022e23)&#x27;
  [../]
  [./energy_density_ic_func]
    type = ParsedFunction
    value = &#x27;log(3./2.) + log((1e13 + 1e15 * (1-x/1)^2 * (x/1)^2)/6.022e23)&#x27;
  [../]
[]

[Materials]
  [./GasBasics]
    type = GasElectronMoments
    interp_trans_coeffs = false
    interp_elastic_coeff = false
    ramp_trans_coeffs = false
    user_p_gas = 133.322
    em = em
    potential = potential
    mean_en = mean_en
    user_electron_mobility = 30.0
    user_electron_diffusion_coeff = 119.8757763975
    property_tables_file = Argon_reactions_paper_RateCoefficients/electron_moments.txt
  [../]
  [./gas_species_0]
    type = ADHeavySpecies
    heavy_species_name = Ar+
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 1.0
    mobility = 0.144409938
    diffusivity = 6.428571e-3
  [../]
  [./gas_species_1]
    type = ADHeavySpecies
    heavy_species_name = Ar*
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
    diffusivity = 7.515528e-3
  [../]
  [./gas_species_2]
    type = ADHeavySpecies
    heavy_species_name = Ar
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
  [../]
  [./reaction_0]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_excitation.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_1]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_ionization.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_2]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_deexcitation.txt&#x27;
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_3]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_excited_ionization.txt&#x27;
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_4]
    type = GenericRateConstant
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
    #reaction_rate_value = 2e-13
    reaction_rate_value = 1.2044e11
  [../]
  [./reaction_5]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
    #reaction_rate_value = 6.2e-16
    reaction_rate_value = 373364000
  [../]
  [./reaction_6]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
    #reaction_rate_value = 3e-21
    reaction_rate_value = 1806.6
  [../]
  [./reaction_7]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
    #reaction_rate_value = 1.1e-42
    reaction_rate_value = 398909.324
  [../]
[]

#New postprocessor that calculates the inverse of the plasma frequency
[Postprocessors]
  [./InversePlasmaFreq]
    type = PlasmaFrequencyInverse
    variable = em
    use_moles = true
    execute_on = &#x27;INITIAL TIMESTEP_BEGIN&#x27;
  [../]
[]


[Preconditioning]
  active = &#x27;smp&#x27;
  [./smp]
    type = SMP
    full = true
  [../]

  [./fdp]
    type = FDP
    full = true
  [../]
[]


[Executioner]
  type = Transient
  end_time = 3e-7
  petsc_options = &#x27;-snes_converged_reason -snes_linesearch_monitor&#x27;
  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_shift_amount -ksp_type -snes_linesearch_minlambda&#x27;
  petsc_options_value = &#x27;lu NONZERO 1.e-10 fgmres 1e-3&#x27;

  dtmin = 1e-14
  l_max_its = 20

  scheme = bdf2
  dt = 1e-9
[]

[Outputs]
  file_base = &#x27;RF_out&#x27;
  perf_graph = true
  [./out]
    type = Exodus
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="406bf7e6-1c6c-455d-8dae-1cb7fb730c29"><div class="modal-content"><h4>(test/tests/crane_action/rate_units.i)</h4><pre class="moose-pre"><code class="language-text"># THIS FILE IS BASED ON Lymberopoulos_with_argon_metastables.i

dom0Scale=25.4e-3

[GlobalParams]
  potential_units = kV
  use_moles = true
[]

[Mesh]
  [./geo]
    type = FileMeshGenerator
    file = &#x27;rate_units.msh&#x27;
  [../]
  [./left]
    type = SideSetsFromNormalsGenerator
    normals = &#x27;-1 0 0&#x27;
    new_boundary = &#x27;left&#x27;
    input = geo
  [../]
  [./right]
    type = SideSetsFromNormalsGenerator
    normals = &#x27;1 0 0&#x27;
    new_boundary = &#x27;right&#x27;
    input = left
  [../]
[]

[Problem]
  type = FEProblem
[]

[Variables]
  [./em]
  [../]

  [./Ar+]
  [../]

  [./Ar*]
  [../]

  [./mean_en]
  [../]

  [./potential]
  [../]
[]

[Kernels]
  #Electron Equations (Same as in paper)
    #Time Derivative term of electron
    [./em_time_deriv]
      type = ElectronTimeDerivative
      variable = em
    [../]
    #Advection term of electron
    [./em_advection]
      type = EFieldAdvection
      variable = em
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons
    [./em_diffusion]
      type = CoeffDiffusion
      variable = em
      position_units = ${dom0Scale}
    [../]

  #Argon Ion Equations (Same as in paper)
    #Time Derivative term of the ions
    [./Ar+_time_deriv]
      type = ElectronTimeDerivative
      variable = Ar+
    [../]
    #Advection term of ions
    [./Ar+_advection]
      type = EFieldAdvection
      variable = Ar+
      potential = potential
      position_units = ${dom0Scale}
    [../]
    [./Ar+_diffusion]
      type = CoeffDiffusion
      variable = Ar+
      position_units = ${dom0Scale}
    [../]
      #Time Derivative term of excited Argon
      [./Ar*_time_deriv]
        type = ElectronTimeDerivative
        variable = Ar*
      [../]
      #Diffusion term of excited Argon
      [./Ar*_diffusion]
        type = CoeffDiffusion
        variable = Ar*
        position_units = ${dom0Scale}
      [../]

  #Voltage Equations (Same as in paper)
    #Voltage term in Poissons Eqaution
    [./potential_diffusion_dom0]
      type = CoeffDiffusionLin
      variable = potential
      position_units = ${dom0Scale}
    [../]
    #Ion term in Poissons Equation
    [./Ar+_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = Ar+
    [../]
    #Electron term in Poissons Equation
    [./em_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = em
    [../]


  #Since the paper uses electron temperature as a variable, the energy equation is in
  #a different form but should be the same physics
    #Time Derivative term of electron energy
    [./mean_en_time_deriv]
      type = ElectronTimeDerivative
      variable = mean_en
    [../]
    #Advection term of electron energy
    [./mean_en_advection]
      type = EFieldAdvection
      variable = mean_en
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons energy
    [./mean_en_diffusion]
      type = CoeffDiffusion
      variable = mean_en
      position_units = ${dom0Scale}
    [../]
    #Joule Heating term
    [./mean_en_joule_heating]
      type = JouleHeating
      variable = mean_en
      potential = potential
      em = em
      position_units = ${dom0Scale}
    [../]
  []


[AuxVariables]
  [./Te]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./x]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./x_node]
  [../]

  [./rho]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./em_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar+_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar*_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar]
  [../]

  [./Efield]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Current_em]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./Current_Ar]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
[]

[AuxKernels]
  [./Te]
    type = ElectronTemperature
    variable = Te
    electron_density = em
    mean_en = mean_en
  [../]
  [./x_g]
    type = Position
    variable = x
    position_units = ${dom0Scale}
  [../]

  [./x_ng]
    type = Position
    variable = x_node
    position_units = ${dom0Scale}
  [../]

  [./em_lin]
    type = DensityMoles
    variable = em_lin
    density_log = em
  [../]
  [./Ar+_lin]
    type = DensityMoles
    variable = Ar+_lin
    density_log = Ar+
  [../]
  [./Ar*_lin]
    type = DensityMoles
    variable = Ar*_lin
    density_log = Ar*
  [../]

  [./Ar_val]
    type = ConstantAux
    variable = Ar
    # value = 3.22e22
    value = -2.928623
    execute_on = INITIAL
  [../]

  [./Efield_calc]
    type = Efield
    component = 0
    potential = potential
    variable = Efield
    position_units = ${dom0Scale}
  [../]
  [./Current_em]
    type = ADCurrent
    potential = potential
    density_log = em
    variable = Current_em
    art_diff = false
    block = 0
    position_units = ${dom0Scale}
  [../]
  [./Current_Ar]
    type = ADCurrent
    potential = potential
    density_log = Ar+
    variable = Current_Ar
    art_diff = false
    block = 0
    position_units = ${dom0Scale}
  [../]
[]


[BCs]
#Voltage Boundary Condition, same as in paper
  [./potential_left]
    type = FunctionDirichletBC
    variable = potential
    boundary = &#x27;left&#x27;
    function = potential_bc_func
    preset = false
  [../]
  [./potential_dirichlet_right]
    type = DirichletBC
    variable = potential
    boundary = &#x27;right&#x27;
    value = 0
    preset = false
  [../]

#New Boundary conditions for electons, same as in paper
  [./em_physical_right]
    type = LymberopoulosElectronBC
    variable = em
    boundary = &#x27;right&#x27;
    gamma = 0.01
    #gamma = 1
    ks = 1.19e5
    #ks = 0.0
    ion = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]
  [./em_physical_left]
    type = LymberopoulosElectronBC
    variable = em
    boundary = &#x27;left&#x27;
    gamma = 0.01
    #gamma = 1
    ks = 1.19e5
    #ks = 0.0
    ion = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
  [./Ar+_physical_right_advection]
    type = LymberopoulosIonBC
    variable = Ar+
    potential = potential
    boundary = &#x27;right&#x27;
    position_units = ${dom0Scale}
  [../]
  [./Ar+_physical_left_advection]
    type = LymberopoulosIonBC
    variable = Ar+
    potential = potential
    boundary = &#x27;left&#x27;
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
#(except the metastables are not set to zero, since Zapdos uses log form)
  [./Ar*_physical_right_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;right&#x27;
    value = 100
  [../]
  [./Ar*_physical_left_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;left&#x27;
    value = 100
  [../]

#New Boundary conditions for mean energy, should be the same as in paper
  [./mean_en_physical_right]
    type = ElectronTemperatureDirichletBC
    variable = mean_en
    em = em
    value = 0.5
    boundary = &#x27;right&#x27;
  [../]
  [./mean_en_physical_left]
    type = ElectronTemperatureDirichletBC
    variable = mean_en
    em = em
    value = 0.5
    boundary = &#x27;left&#x27;
  [../]

[]


[ICs]
  [./em_ic]
    type = FunctionIC
    variable = em
    function = density_ic_func
  [../]
  [./Ar+_ic]
    type = FunctionIC
    variable = Ar+
    function = density_ic_func
  [../]
  [./Ar*_ic]
    type = FunctionIC
    variable = Ar*
    function = density_ic_func
  [../]
  [./mean_en_ic]
    type = FunctionIC
    variable = mean_en
    function = energy_density_ic_func
  [../]

  [./potential_ic]
    type = FunctionIC
    variable = potential
    function = potential_ic_func
  [../]
[]

[Functions]
  [./potential_bc_func]
    type = ParsedFunction
    value = &#x27;0.100*sin(2*3.1415926*13.56e6*t)&#x27;
  [../]
  [./potential_ic_func]
    type = ParsedFunction
    value = &#x27;0.100 * (25.4e-3 - x)&#x27;
  [../]
  [./density_ic_func]
    type = ParsedFunction
    value = &#x27;log((1e13 + 1e15 * (1-x/1)^2 * (x/1)^2)/6.022e23)&#x27;
  [../]
  [./energy_density_ic_func]
    type = ParsedFunction
    value = &#x27;log(3./2.) + log((1e13 + 1e15 * (1-x/1)^2 * (x/1)^2)/6.022e23)&#x27;
  [../]
[]

[Materials]
  [./GasBasics]
    type = GasElectronMoments
    interp_trans_coeffs = false
    interp_elastic_coeff = false
    ramp_trans_coeffs = false
    user_p_gas = 133.322
    em = em
    potential = potential
    mean_en = mean_en
    user_electron_mobility = 30.0
    user_electron_diffusion_coeff = 119.8757763975
    property_tables_file = rate_coefficients/electron_moments.txt
  [../]
  [./gas_species_0]
    type = ADHeavySpecies
    heavy_species_name = Ar+
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 1.0
    mobility = 0.144409938
    diffusivity = 6.428571e-3
  [../]
  [./gas_species_1]
    type = ADHeavySpecies
    heavy_species_name = Ar*
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
    diffusivity = 7.515528e-3
  [../]
  [./gas_species_2]
    type = ADHeavySpecies
    heavy_species_name = Ar
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
  [../]
[]

#New postprocessor that calculates the inverse of the plasma frequency
[Postprocessors]
  [./InversePlasmaFreq]
    type = PlasmaFrequencyInverse
    variable = em
    use_moles = true
    execute_on = &#x27;INITIAL TIMESTEP_BEGIN&#x27;
  [../]
[]


[Preconditioning]
  active = &#x27;smp&#x27;
  [./smp]
    type = SMP
    full = true
  [../]

  [./fdp]
    type = FDP
    full = true
  [../]
[]


[Executioner]
  type = Transient
  #end_time = 0.00737463126
  end_time = 3e-7
  petsc_options = &#x27;-snes_converged_reason -snes_linesearch_monitor&#x27;
  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_shift_amount -ksp_type -snes_linesearch_minlambda&#x27;
  petsc_options_value = &#x27;lu NONZERO 1.e-10 fgmres 1e-3&#x27;
  nl_rel_tol = 1e-08
  #nl_abs_tol = 7.6e-5 #Commit out do to test falure on Mac
  dtmin = 1e-14
  l_max_its = 20

  #Time steps based on the inverse of the plasma frequency
  [./TimeStepper]
    type = PostprocessorDT
    postprocessor = InversePlasmaFreq
  [../]
[]

[Outputs]
  perf_graph = true
  [./out]
    type = Exodus
    execute_on = &#x27;final&#x27;
  [../]
[]

[Reactions]
  [./Argon]
    species = &#x27;Ar* em Ar+&#x27;
    aux_species = &#x27;Ar&#x27;
    reaction_coefficient_format = &#x27;rate&#x27;
    gas_species = &#x27;Ar&#x27;
    electron_energy = &#x27;mean_en&#x27;
    electron_density = &#x27;em&#x27;
    include_electrons = true
    file_location = &#x27;rate_coefficients&#x27;
    potential = &#x27;potential&#x27;
    use_log = true
    position_units = ${dom0Scale}
    block = 0
    reactions = &#x27;em + Ar -&gt; em + Ar*        : EEDF [-11.56] (reaction1)
                 em + Ar -&gt; em + em + Ar+   : EEDF [-15.7] (reaction2)
                 em + Ar* -&gt; em + Ar        : EEDF [11.56] (reaction3)
                 em + Ar* -&gt; em + em + Ar+  : EEDF [-4.14] (reaction4)
                 em + Ar* -&gt; em + Ar_r      : 1.2044e11
                 Ar* + Ar* -&gt; Ar+ + Ar + em : 373364000
                 Ar* + Ar -&gt; Ar + Ar        : 1806.6
                 Ar* + Ar + Ar -&gt; Ar_2 + Ar : 398909.324&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="87941387-6707-40da-ac00-b38af5691433"><div class="modal-content"><h4>(test/tests/Conference_Syntax_Tests/Lymberopoulos_with_argon_metastables.i)</h4><pre class="moose-pre"><code class="language-text">dom0Scale=25.4e-3

[GlobalParams]
  potential_units = kV
  use_moles = true
[]

[Mesh]
  [./file]
    type = FileMeshGenerator
    file = &#x27;Lymberopoulos.msh&#x27;
  [../]
  [./left]
    type = SideSetsFromNormalsGenerator
    normals = &#x27;-1 0 0&#x27;
    new_boundary = &#x27;left&#x27;
    input = file
  [../]
  [./right]
    type = SideSetsFromNormalsGenerator
    normals = &#x27;1 0 0&#x27;
    new_boundary = &#x27;right&#x27;
    input = left
  [../]
[]

[Problem]
  type = FEProblem
[]

[Variables]
  [./em]
  [../]

  [./Ar+]
  [../]

  [./Ar*]
  [../]

  [./mean_en]
  [../]

  [./potential]
  [../]
[]

[Kernels]
  #Electron Equations (Same as in paper)
    #Time Derivative term of electron
    [./em_time_deriv]
      type = ElectronTimeDerivative
      variable = em
    [../]
    #Advection term of electron
    [./em_advection]
      type = EFieldAdvection
      variable = em
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons
    [./em_diffusion]
      type = CoeffDiffusion
      variable = em
      position_units = ${dom0Scale}
    [../]
    #Net electron production from ionization
    [./em_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      target = Ar
      mean_energy = mean_en
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from step-wise ionization
    [./em_stepwise_ionization]
      type = EEDFReactionLog
      variable = em
      electrons = em
      target = Ar*
      mean_energy = mean_en
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net electron production from metastable pooling
    [./em_pooling]
      type = ReactionSecondOrderLog
      variable = em
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

  #Argon Ion Equations (Same as in paper)
    #Time Derivative term of the ions
    [./Ar+_time_deriv]
      type = ElectronTimeDerivative
      variable = Ar+
    [../]
    #Advection term of ions
    [./Ar+_advection]
      type = EFieldAdvection
      variable = Ar+
      potential = potential
      position_units = ${dom0Scale}
    [../]
    [./Ar+_diffusion]
      type = CoeffDiffusion
      variable = Ar+
      position_units = ${dom0Scale}
    [../]
    #Net ion production from ionization
    [./Ar+_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      target = Ar
      mean_energy = mean_en
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from step-wise ionization
    [./Ar+_stepwise_ionization]
      type = EEDFReactionLog
      variable = Ar+
      electrons = em
      target = Ar*
      mean_energy = mean_en
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      coefficient = 1
    [../]
    #Net ion production from metastable pooling
    [./Ar+_pooling]
      type = ReactionSecondOrderLog
      variable = Ar+
      v = Ar*
      w = Ar*
      reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
      coefficient = 1
    [../]

    #Argon Excited Equations (Same as in paper)
      #Time Derivative term of excited Argon
      [./Ar*_time_deriv]
        type = ElectronTimeDerivative
        variable = Ar*
      [../]
      #Diffusion term of excited Argon
      [./Ar*_diffusion]
        type = CoeffDiffusion
        variable = Ar*
        position_units = ${dom0Scale}
      [../]
      #Net excited Argon production from excitation
      [./Ar*_excitation]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar
        mean_energy = mean_en
        reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
        coefficient = 1
      [../]
      #Net excited Argon loss from step-wise ionization
      [./Ar*_stepwise_ionization]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from superelastic collisions
      [./Ar*_collisions]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from quenching to resonant
      [./Ar*_quenching]
        type = EEDFReactionLog
        variable = Ar*
        electrons = em
        target = Ar*
        mean_energy = mean_en
        reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
        coefficient = -1
      [../]
      #Net excited Argon loss from  metastable pooling
      [./Ar*_pooling]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar*
        reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
        coefficient = -2
        _v_eq_u = true
        _w_eq_u = true
      [../]
      #Net excited Argon loss from two-body quenching
      [./Ar*_2B_quenching]
        type = ReactionSecondOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]
      #Net excited Argon loss from three-body quenching
      [./Ar*_3B_quenching]
        type = ReactionThirdOrderLog
        variable = Ar*
        v = Ar*
        w = Ar
        x = Ar
        reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
        coefficient = -1
        _v_eq_u = true
      [../]

  #Voltage Equations (Same as in paper)
    #Voltage term in Poissons Eqaution
    [./potential_diffusion_dom0]
      type = CoeffDiffusionLin
      variable = potential
      position_units = ${dom0Scale}
    [../]
    #Ion term in Poissons Equation
    [./Ar+_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = Ar+
    [../]
    #Electron term in Poissons Equation
    [./em_charge_source]
      type = ChargeSourceMoles_KV
      variable = potential
      charged = em
    [../]


  #Since the paper uses electron temperature as a variable, the energy equation is in
  #a different form but should be the same physics
    #Time Derivative term of electron energy
    [./mean_en_time_deriv]
      type = ElectronTimeDerivative
      variable = mean_en
    [../]
    #Advection term of electron energy
    [./mean_en_advection]
      type = EFieldAdvection
      variable = mean_en
      potential = potential
      position_units = ${dom0Scale}
    [../]
    #Diffusion term of electrons energy
    [./mean_en_diffusion]
      type = CoeffDiffusion
      variable = mean_en
      position_units = ${dom0Scale}
    [../]
    #Joule Heating term
    [./mean_en_joule_heating]
      type = JouleHeating
      variable = mean_en
      potential = potential
      em = em
      position_units = ${dom0Scale}
    [../]
    #Energy loss from ionization
    [./Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
      threshold_energy = -15.7
    [../]
    #Energy loss from excitation
    [./Excitation_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar
      reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
      threshold_energy = -11.56
    [../]
    #Energy loss from step-wise ionization
    [./Stepwise_Ionization_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
      threshold_energy = -4.14
    [../]
    #Energy gain from superelastic collisions
    [./Collisions_Loss]
      type = EEDFEnergyLog
      variable = mean_en
      electrons = em
      target = Ar*
      reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
      threshold_energy = 11.56
    [../]
  []


[AuxVariables]
  #[./emDeBug]
  #[../]
  #[./Ar+_DeBug]
  #[../]
  #[./Ar*_DeBug]
  #[../]
  #[./mean_enDeBug]
  #[../]

  [./Te]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./x]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./x_node]
  [../]

  [./rho]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./em_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar+_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar*_lin]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Ar]
  [../]

  [./Efield]
    order = CONSTANT
    family = MONOMIAL
  [../]

  [./Current_em]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./Current_Ar]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./emRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./exRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./swRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./deexRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./quRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./poolRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./TwoBRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
  [./ThreeBRate]
    order = CONSTANT
    family = MONOMIAL
    block = 0
  [../]
[]

[AuxKernels]
  #[./emDeBug]
  #  type = DebugResidualAux
  #  variable = emDeBug
  #  debug_variable = em
  #  #execute_on = &#x27;LINEAR NONLINEAR TIMESTEP_BEGIN&#x27;
  #[../]
  #[./Ar+_DeBug]
  #  type = DebugResidualAux
  #  variable = Ar+_DeBug
  #  debug_variable = Ar+
  #  #execute_on = &#x27;LINEAR NONLINEAR TIMESTEP_BEGIN&#x27;
  #[../]
  #[./mean_enDeBug]
  #  type = DebugResidualAux
  #  variable = mean_enDeBug
  #  debug_variable = mean_en
  #  #execute_on = &#x27;LINEAR NONLINEAR TIMESTEP_BEGIN&#x27;
  #[../]
  #[./Ar*_DeBug]
  #  type = DebugResidualAux
  #  variable = Ar*_DeBug
  #  debug_variable = Ar*
  #  #execute_on = &#x27;LINEAR NONLINEAR TIMESTEP_BEGIN&#x27;
  #[../]

  [./emRate]
    type = ProcRateForRateCoeff
    variable = emRate
    v = em
    w = Ar
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
  [../]
  [./exRate]
    type = ProcRateForRateCoeff
    variable = exRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
  [../]
  [./swRate]
    type = ProcRateForRateCoeff
    variable = swRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
  [../]
  [./deexRate]
    type = ProcRateForRateCoeff
    variable = deexRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
  [../]
  [./quRate]
    type = ProcRateForRateCoeff
    variable = quRate
    v = em
    w = Ar*
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
  [../]
  [./poolRate]
    type = ProcRateForRateCoeff
    variable = poolRate
    v = Ar*
    w = Ar*
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
  [../]
  [./TwoBRate]
    type = ProcRateForRateCoeff
    variable = TwoBRate
    v = Ar*
    w = Ar
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
  [../]
  [./ThreeBRate]
    type = ProcRateForRateCoeffThreeBody
    variable = ThreeBRate
    v = Ar*
    w = Ar
    vv = Ar
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
  [../]
  [./Te]
    type = ElectronTemperature
    variable = Te
    electron_density = em
    mean_en = mean_en
  [../]
  [./x_g]
    type = Position
    variable = x
    position_units = ${dom0Scale}
  [../]

  [./x_ng]
    type = Position
    variable = x_node
    position_units = ${dom0Scale}
  [../]

  [./em_lin]
    type = DensityMoles
    variable = em_lin
    density_log = em
  [../]
  [./Ar+_lin]
    type = DensityMoles
    variable = Ar+_lin
    density_log = Ar+
  [../]
  [./Ar*_lin]
    type = DensityMoles
    variable = Ar*_lin
    density_log = Ar*
  [../]

  [./Ar_val]
    type = ConstantAux
    variable = Ar
    # value = 3.22e22
    value = -2.928623
    execute_on = INITIAL
  [../]

  [./Efield_calc]
    type = Efield
    component = 0
    potential = potential
    variable = Efield
    position_units = ${dom0Scale}
  [../]
  [./Current_em]
    type = ADCurrent
    potential = potential
    density_log = em
    variable = Current_em
    art_diff = false
    block = 0
    position_units = ${dom0Scale}
  [../]
  [./Current_Ar]
    type = ADCurrent
    potential = potential
    density_log = Ar+
    variable = Current_Ar
    art_diff = false
    block = 0
    position_units = ${dom0Scale}
  [../]
[]


[BCs]
#Voltage Boundary Condition, same as in paper
  [./potential_left]
    type = FunctionDirichletBC
    variable = potential
    boundary = &#x27;left&#x27;
    function = potential_bc_func
  [../]
  [./potential_dirichlet_right]
    type = DirichletBC
    variable = potential
    boundary = &#x27;right&#x27;
    value = 0
  [../]

#New Boundary conditions for electons, same as in paper
  [./em_physical_right]
    type = LymberopoulosElectronBC
    variable = em
    boundary = &#x27;right&#x27;
    gamma = 0.01
    #gamma = 1
    ks = 1.19e5
    #ks = 0.0
    ion = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]
  [./em_physical_left]
    type = LymberopoulosElectronBC
    variable = em
    boundary = &#x27;left&#x27;
    gamma = 0.01
    #gamma = 1
    ks = 1.19e5
    #ks = 0.0
    ion = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
  [./Ar+_physical_right_advection]
    type = LymberopoulosIonBC
    variable = Ar+
    potential = potential
    boundary = &#x27;right&#x27;
    position_units = ${dom0Scale}
  [../]
  [./Ar+_physical_left_advection]
    type = LymberopoulosIonBC
    variable = Ar+
    potential = potential
    boundary = &#x27;left&#x27;
    position_units = ${dom0Scale}
  [../]

#New Boundary conditions for ions, should be the same as in paper
#(except the metastables are not set to zero, since Zapdos uses log form)
  [./Ar*_physical_right_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;right&#x27;
    value = 100
  [../]
  [./Ar*_physical_left_diffusion]
    type = LogDensityDirichletBC
    variable = Ar*
    boundary = &#x27;left&#x27;
    value = 100
  [../]

#New Boundary conditions for mean energy, should be the same as in paper
  [./mean_en_physical_right]
    type = ElectronTemperatureDirichletBC
    variable = mean_en
    em = em
    value = 0.5
    boundary = &#x27;right&#x27;
  [../]
  [./mean_en_physical_left]
    type = ElectronTemperatureDirichletBC
    variable = mean_en
    em = em
    value = 0.5
    boundary = &#x27;left&#x27;
  [../]

[]


[ICs]
  [./em_ic]
    type = FunctionIC
    variable = em
    function = density_ic_func
  [../]
  [./Ar+_ic]
    type = FunctionIC
    variable = Ar+
    function = density_ic_func
  [../]
  [./Ar*_ic]
    type = FunctionIC
    variable = Ar*
    function = density_ic_func
  [../]
  [./mean_en_ic]
    type = FunctionIC
    variable = mean_en
    function = energy_density_ic_func
  [../]

  [./potential_ic]
    type = FunctionIC
    variable = potential
    function = potential_ic_func
  [../]
[]

[Functions]
  [./potential_bc_func]
    type = ParsedFunction
    value = &#x27;0.100*sin(2*3.1415926*13.56e6*t)&#x27;
  [../]
  [./potential_ic_func]
    type = ParsedFunction
    value = &#x27;0.100 * (25.4e-3 - x)&#x27;
  [../]
  [./density_ic_func]
    type = ParsedFunction
    value = &#x27;log((1e13 + 1e15 * (1-x/1)^2 * (x/1)^2)/6.022e23)&#x27;
  [../]
  [./energy_density_ic_func]
    type = ParsedFunction
    value = &#x27;log(3./2.) + log((1e13 + 1e15 * (1-x/1)^2 * (x/1)^2)/6.022e23)&#x27;
  [../]
[]

[Materials]
  [./GasBasics]
    type = GasElectronMoments
    interp_trans_coeffs = false
    interp_elastic_coeff = false
    ramp_trans_coeffs = false
    user_p_gas = 133.322
    em = em
    potential = potential
    mean_en = mean_en
    user_electron_mobility = 30.0
    user_electron_diffusion_coeff = 119.8757763975
    property_tables_file = Argon_reactions_paper_RateCoefficients/electron_moments.txt
  [../]
  [./gas_species_0]
    type = ADHeavySpecies
    heavy_species_name = Ar+
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 1.0
    mobility = 0.144409938
    diffusivity = 6.428571e-3
  [../]
  [./gas_species_1]
    type = ADHeavySpecies
    heavy_species_name = Ar*
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
    diffusivity = 7.515528e-3
  [../]
  [./gas_species_2]
    type = ADHeavySpecies
    heavy_species_name = Ar
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
  [../]
  [./reaction_0]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_excitation.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + Ar*&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_1]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_ionization.txt&#x27;
    reaction = &#x27;em + Ar -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_2]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_deexcitation.txt&#x27;
    reaction = &#x27;em + Ar* -&gt; em + Ar&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_3]
    type = ZapdosEEDFRateConstant
    mean_energy = mean_en
    property_file = &#x27;Argon_reactions_paper_RateCoefficients/ar_excited_ionization.txt&#x27;
    reaction = &#x27;em + Ar* -&gt; em + em + Ar+&#x27;
    file_location = &#x27;&#x27;
    electrons = em
  [../]
  [./reaction_4]
    type = GenericRateConstant
    reaction = &#x27;em + Ar* -&gt; em + Ar_r&#x27;
    #reaction_rate_value = 2e-13
    reaction_rate_value = 1.2044e11
  [../]
  [./reaction_5]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar* -&gt; Ar+ + Ar + em&#x27;
    #reaction_rate_value = 6.2e-16
    reaction_rate_value = 373364000
  [../]
  [./reaction_6]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar -&gt; Ar + Ar&#x27;
    #reaction_rate_value = 3e-21
    reaction_rate_value = 1806.6
  [../]
  [./reaction_7]
    type = GenericRateConstant
    reaction = &#x27;Ar* + Ar + Ar -&gt; Ar_2 + Ar&#x27;
    #reaction_rate_value = 1.1e-42
    reaction_rate_value = 398909.324
  [../]
[]

#New postprocessor that calculates the inverse of the plasma frequency
[Postprocessors]
  [./InversePlasmaFreq]
    type = PlasmaFrequencyInverse
    variable = em
    use_moles = true
    execute_on = &#x27;INITIAL TIMESTEP_BEGIN&#x27;
  [../]
[]


[Preconditioning]
  active = &#x27;smp&#x27;
  [./smp]
    type = SMP
    full = true
  [../]

  [./fdp]
    type = FDP
    full = true
  [../]
[]


[Executioner]
  type = Transient
  end_time = 0.00737463126
  #end_time = 3e-7
  petsc_options = &#x27;-snes_converged_reason -snes_linesearch_monitor&#x27;
  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_shift_amount -ksp_type -snes_linesearch_minlambda&#x27;
  petsc_options_value = &#x27;lu NONZERO 1.e-10 fgmres 1e-3&#x27;
  nl_rel_tol = 1e-08
  #nl_abs_tol = 7.6e-5 #Commit out do to test falure on Mac
  dtmin = 1e-14
  l_max_its = 20

  #Time steps based on the inverse of the plasma frequency
  [./TimeStepper]
    type = PostprocessorDT
    postprocessor = InversePlasmaFreq
  [../]
[]

[Outputs]
  perf_graph = true
  [./out]
    type = Exodus
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="0ecf710f-6093-4c89-8095-d211fd4008f1"><div class="modal-content"><h4>(tutorial/tutorial06-Building-InputFile/RF_Plasma_Blank.i)</h4><pre class="moose-pre"><code class="language-text">#In this tutorial, users input the missing data for
#Zapdos’s Drift-Diffusion Action and CRANE’s Reactions Action.
#The simulation is a simple electron and ion only argon plasma,
#where “reaction1” is the metastable excitation reaction
#and “reaction2” is ionization.  The reaction coefficients are in “rate” form.

#A uniform scaling factor of the mesh.
#E.g if set to 1.0, there is not scaling
# and if set to 0.010, there mesh is scaled by a cm
dom0Scale=25.4e-3

[GlobalParams]
  #Scales the potential by V or kV
  potential_units = kV
  #Converts density from #/m^3 to moles/m^3
  use_moles = true
[]

[Mesh]
  #Mesh is define by a Gmsh file
  [./geo]
    type = FileMeshGenerator
    file = &#x27;Lymberopoulos_paper.msh&#x27;
  [../]
  #Renames all sides with the specified normal
  #For 1D, this is used to rename the end points of the mesh
  [./left]
    type = SideSetsFromNormalsGenerator
    normals = &#x27;-1 0 0&#x27;
    new_boundary = &#x27;left&#x27;
    input = geo
  [../]
  [./right]
    type = SideSetsFromNormalsGenerator
    normals = &#x27;1 0 0&#x27;
    new_boundary = &#x27;right&#x27;
    input = left
  [../]
[]

#Defines the problem type, such as FE, eigen value problem, etc.
[Problem]
  type = FEProblem
[]

[DriftDiffusionAction]
  [./Plasma]
    #User define name for electrons (usually &#x27;em&#x27;)
    electrons =
    #User define name for ions
    charged_particle =
    #User define name for potential (usually &#x27;potential&#x27;)
    potential =
    #Defines if this potential exist in only one block/material (set &#x27;true&#x27; for single gases)
    Is_potential_unique =
    #User define name for the electron mean energy density (usually &#x27;mean_en&#x27;)
    mean_energy =
    #The position scaling for the mesh, define at top of input file
    position_units = ${dom0Scale}
    #Additional outputs, such as ElectronTemperature, Current, and EField.
    Additional_Outputs =
  [../]
[]

[Reactions]
  [./Gas]
    #Name of reactant species that are variables
    species =
    #Name of reactant species that are auxvariables
    aux_species =
    #Type of coefficient (rate or townsend)
    reaction_coefficient_format =
    #Name of background gas
    gas_species =
    #Name of the electron mean energy density (usually &#x27;mean_en&#x27;)
    electron_energy =
    #Name of the electrons (usually &#x27;em&#x27;)
    electron_density =
    #Defines if electrons are tracked
    include_electrons =
    #Defines directory holding rate text files
    file_location =
    #Name of name for potential (usually &#x27;potential&#x27;)
    potential =
    #Defines if log form is used (true for Zapdos)
    use_log = true
    #Defines if automatic differentiation is used (true for Zapdos)
    use_ad = true
    #The position scaling for the mesh, define at top of input file
    position_units = ${dom0Scale}
    #Name of material block (&#x27;0&#x27; for an user undefined block)
    block = 0
    #Inputs of the plasma chemsity
    #e.g. Reaction : Constant or EEDF dependent [Threshold Energy] (Text file name)
    #     em + Ar -&gt; em + Ar*        : EEDF [-11.56] (reaction1)
    reactions =
  [../]
[]

[AuxVariables]
  #Add a scaled position units used for plotting other element AuxVariables
  [./x_node]
  [../]

  #Background gas (e.g Ar)
  [./Ar]
  [../]
[]

[AuxKernels]
  #Add at scaled position units used for plotting other element AuxVariables
  [./x_ng]
    type = Position
    variable = x_node
    position_units = ${dom0Scale}
  [../]

  #Background gas number density (e.g. for 1Torr)
  [./Ar_val]
    type = FunctionAux
    variable = Ar
    function = &#x27;log(3.22e22/6.022e23)&#x27;
    execute_on = INITIAL
  [../]
[]

#Currently there is no Action for BC (but one is currently in development)
#Below is the Lymberopulos family of BC
#(For other BC example, please look at Tutorial 04 and Tutorial 06)
[BCs]
#Voltage Boundary Condition Ffor a Power-Ground RF Discharge
  [./potential_left]
    type = FunctionDirichletBC
    variable = potential
    boundary = &#x27;left&#x27;
    function = potential_bc_func
    preset = false
  [../]
  [./potential_dirichlet_right]
    type = DirichletBC
    variable = potential
    boundary = &#x27;right&#x27;
    value = 0
    preset = false
  [../]

#Boundary conditions for electons
  [./em_physical_right]
    type = LymberopoulosElectronBC
    variable = em
    boundary = &#x27;right left&#x27;
    gamma = 0.01  #Secondary electron coeff.
    ks = 1.19e5 #Thermal electron velocity
    ion = Ar+
    potential = potential
    position_units = ${dom0Scale}
  [../]

#Boundary conditions for ions
  [./Ar+_physical_right_advection]
    type = LymberopoulosIonBC
    variable = Ar+
    potential = potential
    boundary = &#x27;right left&#x27;
    position_units = ${dom0Scale}
  [../]

#Boundary conditions for mean energy
  [./mean_en_physical_right]
    type = ElectronTemperatureDirichletBC
    variable = mean_en
    em = em
    value = 0.5 #Electron Temperature in eV
    boundary = &#x27;right left&#x27;
  [../]
[]

#Initial conditions for variables.
#If left undefine, the IC is zero
[ICs]
  [./em_ic]
    type = FunctionIC
    variable = em
    function = density_ic_func
  [../]
  [./Ar+_ic]
    type = FunctionIC
    variable = Ar+
    function = density_ic_func
  [../]
  [./mean_en_ic]
    type = FunctionIC
    variable = mean_en
    function = energy_density_ic_func
  [../]
  [./potential_ic]
    type = FunctionIC
    variable = potential
    function = potential_ic_func
  [../]
[]

#Define function used throughout the input file (e.g. BCs and ICs)
[Functions]
  [./potential_bc_func]
    type = ParsedFunction
    value = &#x27;0.100*sin(2*3.1415926*13.56e6*t)&#x27;
  [../]
  [./potential_ic_func]
    type = ParsedFunction
    value = &#x27;0.100 * (25.4e-3 - x)&#x27;
  [../]
  [./density_ic_func]
    type = ParsedFunction
    value = &#x27;log((1e13 + 1e15 * (1-x/1)^2 * (x/1)^2)/6.022e23)&#x27;
  [../]
  [./energy_density_ic_func]
    type = ParsedFunction
    value = &#x27;log(3./2.) + log((1e13 + 1e15 * (1-x/1)^2 * (x/1)^2)/6.022e23)&#x27;
  [../]
[]

[Materials]
  #The material properties for electrons.
  #Also hold universal constant, such as Avogadro&#x27;s number, elementary charge, etc.
  [./GasBasics]
    type = GasElectronMoments
    #False means constant electron coeff, defined by user
    interp_trans_coeffs = false
    #Leave as false (CRANE accounts of elastic coeff.)
    interp_elastic_coeff = false
    #Leave as false, unless computational error is due to rapid coeff. changes
    ramp_trans_coeffs = false
    #User difine pressure in pa
    user_p_gas = 133.322
    #Name for electrons (usually &#x27;em&#x27;)
    em = em
    #Name for potential (usually &#x27;potential&#x27;)
    potential = potential
    #Name for the electron mean energy density (usually &#x27;mean_en&#x27;)
    mean_en = mean_en
    #User define electron mobility coeff. (define as 0.0 if not used)
    user_electron_mobility = 30.0
    #User define electron diffusion coeff. (define as 0.0 if not used)
    user_electron_diffusion_coeff = 119.8757763975
    #Name of text file with electron properties
    property_tables_file = rate_coefficients/electron_moments.txt
  [../]
  #The material properties of the ion
  [./gas_species_0]
    type = ADHeavySpecies
    heavy_species_name = Ar+
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 1.0
    mobility = 0.144409938
    diffusivity = 6.428571e-3
  [../]
  #The material properties of the background gas
  [./gas_species_2]
    type = ADHeavySpecies
    heavy_species_name = Ar
    heavy_species_mass = 6.64e-26
    heavy_species_charge = 0.0
  [../]
[]

#Preconditioning options
#Learn more at: https://mooseframework.inl.gov/syntax/Preconditioning/index.html
[Preconditioning]
  active = &#x27;smp&#x27;
  [./smp]
    type = SMP
    full = true
  [../]

  [./fdp]
    type = FDP
    full = true
  [../]
[]

#How to execute the problem.
#Defines type of solve (such as steady or transient),
# solve type (Newton, PJFNK, etc.) and tolerances
[Executioner]
  type = Transient
  end_time = 7.3746e-5
  dt = 1e-9
  dtmin = 1e-14
  scheme = bdf2
  solve_type = NEWTON

  petsc_options = &#x27;-snes_converged_reason -snes_linesearch_monitor&#x27;
  petsc_options_iname = &#x27;-pc_type -pc_factor_shift_type -pc_factor_shift_amount -snes_linesearch_minlambda&#x27;
  petsc_options_value = &#x27;lu NONZERO 1.e-10 1e-3&#x27;

  nl_rel_tol = 1e-08
  l_max_its = 20
[]

#Defines the output type of the file (multiple output files can be define per run)
[Outputs]
  perf_graph = true
  [./out]
    type = Exodus
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#b7d1313d-f637-4cf2-9e3b-7087695bb1f6" class="tooltipped" data-position="left" data-tooltip="Overview">Overview</a></li><li><a href="#01030891-fea5-4b4e-94c2-9af40163c4c9" class="tooltipped" data-position="left" data-tooltip="Example Input File Syntax">Example Input File Syntax</a></li><li><a href="#b1f8d834-7019-4e57-ad38-6bfe84b1b7ac" class="tooltipped" data-position="left" data-tooltip="Input Parameters">Input Parameters</a></li><li><a href="#9e294236-21db-4856-88a9-da69d53bf82c" class="tooltipped" data-position="left" data-tooltip="Input Files">Input Files</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>