<!DOCTYPE html><head><meta charset="UTF-8"><title>Framework Failure Analysis Report | Zapdos</title><link href="../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../css/zapdos.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../contrib/jquery/jquery.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Zapdos</a><a href="https://github.com/shannon-lab/zapdos" class="right"><img src="../media/framework/github-logo.png" alt="GitHub wordmark" class="github-mark"></img><img src="../media/framework/github-mark.png" alt="GitHub logo" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="4b9de4f7-b2cb-4926-9ef6-41fcf6a0197f" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="8e6c4d46-5ea1-4d4d-a880-c47b4479f036" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="980f224b-5e05-4e62-9f2f-8d3f703986ce" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../citing.html">Citing</a></li></ul><a href="#" class="sidenav-trigger" data-target="20c1f690-234b-4e48-bb4b-5ebc26495df5"><i class="material-icons">menu</i></a><ul class="sidenav" id="20c1f690-234b-4e48-bb4b-5ebc26495df5"><li><a href="#!" class="dropdown-trigger" data-target="b5267e76-8c02-4948-8457-9449a50b946c" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="99185762-6f07-4d91-8c60-50d52d481a4d" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="307c2cdc-55e3-4bfd-b106-020fc0b05a70" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../citing.html">Citing</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="4b9de4f7-b2cb-4926-9ef6-41fcf6a0197f"><li><a href="../getting_started/installation.html">Installation</a></li><li><a href="../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../getting_started/zapdos_meshing.html">Generating Meshes</a></li><li><a href="../tutorial/index.html">Tutorial Slides</a></li></ul><ul class="dropdown-content" id="8e6c4d46-5ea1-4d4d-a880-c47b4479f036"><li><a href="../syntax/zapdos_only.html">Zapdos Input Syntax</a></li><li><a href="../syntax/index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../examples/crane_examples.html">CRANE Examples</a></li><li><a href="../development/contributing.html">Contributing Guidelines</a></li><li><a href="../development/code_standards.html">Code Standards</a></li><li><a href="../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="980f224b-5e05-4e62-9f2f-8d3f703986ce"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="../development/zapdos_developer_info.html">Zapdos Developer Information</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul><ul class="dropdown-content" id="b5267e76-8c02-4948-8457-9449a50b946c"><li><a href="../getting_started/installation.html">Installation</a></li><li><a href="../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../getting_started/zapdos_meshing.html">Generating Meshes</a></li><li><a href="../tutorial/index.html">Tutorial Slides</a></li></ul><ul class="dropdown-content" id="99185762-6f07-4d91-8c60-50d52d481a4d"><li><a href="../syntax/zapdos_only.html">Zapdos Input Syntax</a></li><li><a href="../syntax/index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../examples/crane_examples.html">CRANE Examples</a></li><li><a href="../development/contributing.html">Contributing Guidelines</a></li><li><a href="../development/code_standards.html">Code Standards</a></li><li><a href="../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="307c2cdc-55e3-4bfd-b106-020fc0b05a70"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="../development/zapdos_developer_info.html">Zapdos Developer Information</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><span class="breadcrumb">sqa</span><a href="#" class="breadcrumb">framework_far</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="e93b335c-193a-48c3-851c-8a5658507c07" data-section-level="1" data-section-text="Framework Failure Analysis Report"><h1 id="framework-failure-analysis-report">Framework Failure Analysis Report</h1><section class="scrollspy" id="b5170c89-bc9f-4588-ba6b-9f873c24c2c8" data-section-level="2" data-section-text="Introduction"><h2 id="introduction">Introduction</h2><p>MOOSE and MOOSE-based applications are designed to operate as a library of functionality. While each library may be tailored for solving a certain set of equations, the ability to create arbitrary simulations exists. This flexibility exists by design within the framework, modules, and applications. With respect to performing failure analysis, the flexibility is detrimental since there lacks a well-defined problem to assess. To minimize the possibility of failure for a simulation, various automated methods exist for developers. This document discusses these features and includes a list of requirements associated with software failure analysis. </p></section><section class="scrollspy" id="b9112881-969f-4cbc-a849-db4fa6cfb2a0" data-section-level="2" data-section-text="References"><h2 id="references">References</h2>No citations exist within this document.</section><section class="scrollspy" id="d4da2fa1-0518-4612-9999-adf7ebd8bbe0" data-section-level="2" data-section-text="Failure Analysis"><h2 id="failure-analysis">Failure Analysis</h2><p>MOOSE has three primary methods for handling simulation failures that range from input errors to simulation convergence problems. These potential failures and the associated handling of the failure are ubiquitous across MOOSE and MOOSE-based applications. The next three sections detail the handling of these common sources of failures.</p><ol class="browser-default" start="1"><li><p>Input file syntax failure, </p></li><li><p>Input parameter errors, and </p></li><li><p>Convergence failure.</p></li></ol><p>To complement the automatic handling of these three failure mechanisms the MOOSE testing system includes a mechanism for creating tests to verify that errors are captured and reported correctly. This testing method is detailed in the <a href="framework_far.html#failure-testing">Failure Testing</a> section.</p><section id="47daca42-f5c6-490c-b1f7-a0e3c3bb3fae" data-section-level="3" data-section-text="Input File Failure"><h3 id="input-file-failure">Input File Failure</h3><p>The input file parsing <a href="../source/parser/Parser.html">(see Parser)</a> system automatically handles syntax mistakes and reports them as errors. For example, consider the following input file that contains a missing closing bracket.</p><pre style="max-height:350px;"><code class="language-moose">[Mesh]
  file = file.e
[]

[Executioner]
  type = Steady
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#8a882ecd-55ed-4923-af47-5efb1215f83c">(moose/test/tests/parser/hit_error/hit_error.i)</a><p>If this input file is executed with the application, it will automatically report the error and associated line number where it occurred as follows.</p><pre style="max-height:350px;"><code class="language-text">
hit_error.i:5: missing closing &#x27;[]&#x27; for section
</code></pre></section><section id="7558187c-80ef-47e0-9963-f53e35502e22" data-section-level="3" data-section-text="Input Parameter Errors"><h3 id="input-parameter-errors">Input Parameter Errors</h3><p>The input parameter system (see <a href="../source/utils/InputParameters.html">InputParameters</a>) is the second step in input file parsing. The system details the available inputs for an object. The system allows for parameters to be marked as required, provide a default, or check for correct range to name a few. For example, consider the <code>validParams</code> function below that defines a required parameter &quot;D&quot; that must be supplied in an input file.</p><pre style="max-height:350px;"><code class="language-cpp">InputParameters
CoeffParamDiffusion::validParams()
{
  InputParameters params = Diffusion::validParams();
  params.addRequiredParam&lt;Real&gt;(&quot;D&quot;, &quot;The diffusivity coefficient.&quot;);
  return params;
}
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#fe3899d8-805a-4527-97d3-e5d35b3b6b3e">(moose/test/src/kernels/CoeffParamDiffusion.C)</a><p>If an input file does not include this parameter, as shown below then it will provide an error with details regarding the missing parameter.</p><pre style="max-height:350px;"><code class="language-moose">[Kernels&lt;&lt;&lt;{&quot;href&quot;: &quot;../syntax/Kernels/index.html&quot;}&gt;&gt;&gt;]
  [diffusion]
    type = CoeffParamDiffusion
    variable = u
  []
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#f109c4eb-6ab9-41e5-879b-4552539757a6">(moose/test/tests/utils/param_error/param_error.i)</a><pre style="max-height:350px;"><code class="language-text">
param_error.i:10: missing required parameter &#x27;Kernels/diffusion/D&#x27;
	Doc String: &quot;The diffusivity coefficient.&quot;
</code></pre></section><section id="c11c002a-7845-41c9-8f56-c556a2874f4c" data-section-level="3" data-section-text="Convergence Failure"><h3 id="convergence-failure">Convergence Failure</h3><p>MOOSE includes automatic methods to handle convergence failures during the numeric solve. If those attempts fail, it will exit with an error indicating of the failed solve and the reason. By default if a transient simulation fails to solve a time step, the timestep will automatically be cut and the solve re-attempted. This cutback will continue until the solve converges or if the minimum allowed timestep is reached.</p><p>For example, the following input when executed will demonstrate the behavior. This input file includes a custom <code>TimeStepper</code> block, but by default a similar behavior exists.</p><pre style="max-height:350px;"><code class="language-moose">[Executioner&lt;&lt;&lt;{&quot;href&quot;: &quot;../syntax/Executioner/index.html&quot;}&gt;&gt;&gt;]
  type = Transient
  num_steps = 10
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;

  [./TimeStepper&lt;&lt;&lt;{&quot;href&quot;: &quot;../syntax/Executioner/TimeStepper/index.html&quot;}&gt;&gt;&gt;]
    type = ConstantDT
    dt = 0.1
    cutback_factor_at_failure = 0.8
  [../]
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#9022e681-b705-4327-9262-5cbaab9c978d">(moose/test/tests/time_steppers/cutback_factor_at_failure/constant_dt_cutback.i)</a><p>When executed this input file at time step 3 fails to converge, the timestep (&quot;dt&quot;) is cut by the supplied factor and the solve is re-attempted. In both the converged and non-converged iterations the reason for the resulting solve is displayed.</p><pre style="max-height:350px;"><code class="language-text">
Time Step 3, time = 0.3, dt = 0.1
 0 Nonlinear |R| = 7.103698e-02
      0 Linear |R| = 7.103698e-02
      1 Linear |R| = 1.154171e-03
      2 Linear |R| = 4.325671e-06
      3 Linear |R| = 2.434939e-08
  Linear solve converged due to CONVERGED_RTOL iterations 3
 1 Nonlinear |R| = 2.429061e-08
      0 Linear |R| = 2.429061e-08
      1 Linear |R| = 2.035627e-10
      2 Linear |R| = 9.270880e-13
      3 Linear |R| = 6.368586e-15
  Linear solve converged due to CONVERGED_RTOL iterations 3
 2 Nonlinear |R| = 6.368769e-15
Nonlinear solve converged due to CONVERGED_FNORM_RELATIVE iterations 2
 Solve Did NOT Converge!
Aborting as solve did not converge

Time Step 3, time = 0.28, dt = 0.08
 0 Nonlinear |R| = 7.103698e-02
      0 Linear |R| = 7.103698e-02
      1 Linear |R| = 8.875771e-04
      2 Linear |R| = 3.163939e-06
      3 Linear |R| = 1.554863e-08
  Linear solve converged due to CONVERGED_RTOL iterations 3
 1 Nonlinear |R| = 1.565086e-08
      0 Linear |R| = 1.565086e-08
      1 Linear |R| = 1.120313e-10
      2 Linear |R| = 4.275206e-13
      3 Linear |R| = 2.854434e-15
  Linear solve converged due to CONVERGED_RTOL iterations 3
 2 Nonlinear |R| = 2.874867e-15
Nonlinear solve converged due to CONVERGED_FNORM_RELATIVE iterations 2
 Solve Converged!
</code></pre></section><section id="76f4db77-f227-49bf-b105-40de90686580" data-section-level="3" data-section-text="Failure Testing"><h3 id="failure-testing">Failure Testing</h3><p>In general, failures are tested using a test type of <code>RunException</code> (see <a href="framework_stp.html">Framework Software Test Plan</a>). An example of such as test is provided below, which is a test that exists for the previous input parser example in <a href="framework_far.html#input-parameter-errors">Input Parameter Errors</a>. By default all <code>RunException</code> tests are listed below in the list in of requirements (<a href="framework_far.html#failure-analysis-requirements">Failure Analysis Requirements</a>) that comprise failure analysis.</p><pre style="max-height:350px;"><code class="language-text">[Tests]
  issues = &#x27;#16410&#x27;
  design = utils/InputParameters.md
  [error]
    type = RunException
    input = param_error.i
    expect_err = &quot;param_error.i:10.3:(.*)missing required parameter &#x27;Kernels/diffusion/D&#x27;&quot;

    requirement = &quot;The system shall automatically report input errors when a required parameter is not specified.&quot;
  []
[]
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#5f83e088-8f25-4040-9c61-33bf1b7c470a">(moose/test/tests/utils/param_error/tests)</a><p></p></section></section><section class="scrollspy" id="5e7173f7-3412-48bb-a66e-9ef4508e45c3" data-section-level="2" data-section-text="Failure Analysis Requirements"><h2 id="failure-analysis-requirements">Failure Analysis Requirements</h2><p class="moose-disabled">!sqa requirements link=True collections=FAILURE_ANALYSIS category=framework</p></section></section><div class="moose-modal modal" id="8a882ecd-55ed-4923-af47-5efb1215f83c"><div class="modal-content"><h4>(moose/test/tests/parser/hit_error/hit_error.i)</h4><pre style="max-height:350px;"><code class="language-moose">[Mesh]
  file = file.e
[]

[Executioner]
  type = Steady
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="fe3899d8-805a-4527-97d3-e5d35b3b6b3e"><div class="modal-content"><h4>(moose/test/src/kernels/CoeffParamDiffusion.C)</h4><pre style="max-height:350px;"><code class="language-cpp">// This file is part of the MOOSE framework
// https://mooseframework.inl.gov
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#include &quot;CoeffParamDiffusion.h&quot;

registerMooseObject(&quot;MooseTestApp&quot;, CoeffParamDiffusion);

// MooseDocs::start
InputParameters
CoeffParamDiffusion::validParams()
{
  InputParameters params = Diffusion::validParams();
  params.addRequiredParam&lt;Real&gt;(&quot;D&quot;, &quot;The diffusivity coefficient.&quot;);
  return params;
}
// MooseDocs::end

CoeffParamDiffusion::CoeffParamDiffusion(const InputParameters &amp; parameters)
  : Diffusion(parameters),

    _D(getParam&lt;Real&gt;(&quot;D&quot;))
{
}

CoeffParamDiffusion::~CoeffParamDiffusion() {}

Real
CoeffParamDiffusion::computeQpResidual()
{
  return _D * Diffusion::computeQpResidual();
}

Real
CoeffParamDiffusion::computeQpJacobian()
{
  return _D * Diffusion::computeQpJacobian();
}
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="f109c4eb-6ab9-41e5-879b-4552539757a6"><div class="modal-content"><h4>(moose/test/tests/utils/param_error/param_error.i)</h4><pre style="max-height:350px;"><code class="language-moose">[Mesh/gen]
  type = GeneratedMeshGenerator
  dim =1
[]

[Variables/u]
[]

[Kernels]
  [diffusion]
    type = CoeffParamDiffusion
    variable = u
  []
[]

[Problem]
  solve = false
[]

[Executioner]
  type = Steady
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="9022e681-b705-4327-9262-5cbaab9c978d"><div class="modal-content"><h4>(moose/test/tests/time_steppers/cutback_factor_at_failure/constant_dt_cutback.i)</h4><pre style="max-height:350px;"><code class="language-moose">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
[]

[Variables]
  [./u]
  [../]
[]

[Kernels]
  [./diff]
    type = CoefDiffusion
    variable = u
    coef = 0.1
  [../]
  [./time]
    type = TimeDerivative
    variable = u
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
[]

[Problem]
  type = FailingProblem
  fail_steps = &#x27;3&#x27;
[]

[Executioner]
  type = Transient
  num_steps = 10
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;

  [./TimeStepper]
    type = ConstantDT
    dt = 0.1
    cutback_factor_at_failure = 0.8
  [../]
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="5f83e088-8f25-4040-9c61-33bf1b7c470a"><div class="modal-content"><h4>(moose/test/tests/utils/param_error/tests)</h4><pre style="max-height:350px;"><code class="language-text">[Tests]
  issues = &#x27;#16410&#x27;
  design = utils/InputParameters.md
  [error]
    type = RunException
    input = param_error.i
    expect_err = &quot;param_error.i:10.3:(.*)missing required parameter &#x27;Kernels/diffusion/D&#x27;&quot;

    requirement = &quot;The system shall automatically report input errors when a required parameter is not specified.&quot;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#b5170c89-bc9f-4588-ba6b-9f873c24c2c8" class="tooltipped" data-position="left" data-tooltip="Introduction">Introduction</a></li><li><a href="#b9112881-969f-4cbc-a849-db4fa6cfb2a0" class="tooltipped" data-position="left" data-tooltip="References">References</a></li><li><a href="#d4da2fa1-0518-4612-9999-adf7ebd8bbe0" class="tooltipped" data-position="left" data-tooltip="Failure Analysis">Failure Analysis</a></li><li><a href="#5e7173f7-3412-48bb-a66e-9ef4508e45c3" class="tooltipped" data-position="left" data-tooltip="Failure Analysis Requirements">Failure Analysis Requirements</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../js/init.js"></script><script type="text/javascript" src="../js/navigation.js"></script><script type="text/javascript" src="../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../js/search_index.js"></script><script type="text/javascript" src="../js/sqa_moose.js"></script><script type="text/javascript" src="../js/moose_input_parser.js"></script>