<!DOCTYPE html><head><meta charset="UTF-8"><title>Reporter System | Zapdos</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/zapdos.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Zapdos</a><a href="https://github.com/shannon-lab/zapdos" class="right"><img src="../../media/framework/github-logo.png" alt="GitHub wordmark" class="github-mark"></img><img src="../../media/framework/github-mark.png" alt="GitHub logo" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="8830a14c-d9a5-4fdc-8db1-852f107148c8" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="e9ef1158-15d3-426c-bebf-b98db187eace" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="24e04944-ac99-423c-b528-c94713e783b9" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../citing.html">Citing</a></li></ul><a href="#" class="sidenav-trigger" data-target="05a4e9ea-815e-4645-8ae3-569feaac930f"><i class="material-icons">menu</i></a><ul class="sidenav" id="05a4e9ea-815e-4645-8ae3-569feaac930f"><li><a href="#!" class="dropdown-trigger" data-target="88e7f53c-382e-456d-b1df-2a33982e4ad3" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="fdeed72f-42af-4ec5-8a1a-23f12190a92e" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="2cd85e14-f3dc-44ba-bc32-1aef05a57d10" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../citing.html">Citing</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="8830a14c-d9a5-4fdc-8db1-852f107148c8"><li><a href="../../getting_started/installation.html">Installation</a></li><li><a href="../../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../../getting_started/zapdos_meshing.html">Generating Meshes</a></li><li><a href="../../tutorial/index.html">Tutorial Slides</a></li></ul><ul class="dropdown-content" id="e9ef1158-15d3-426c-bebf-b98db187eace"><li><a href="../zapdos_only.html">Zapdos Input Syntax</a></li><li><a href="../index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../../examples/crane_examples.html">CRANE Examples</a></li><li><a href="../../development/contributing.html">Contributing Guidelines</a></li><li><a href="../../development/code_standards.html">Code Standards</a></li><li><a href="../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="24e04944-ac99-423c-b528-c94713e783b9"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="../../development/zapdos_developer_info.html">Zapdos Developer Information</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul><ul class="dropdown-content" id="88e7f53c-382e-456d-b1df-2a33982e4ad3"><li><a href="../../getting_started/installation.html">Installation</a></li><li><a href="../../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../../getting_started/zapdos_meshing.html">Generating Meshes</a></li><li><a href="../../tutorial/index.html">Tutorial Slides</a></li></ul><ul class="dropdown-content" id="fdeed72f-42af-4ec5-8a1a-23f12190a92e"><li><a href="../zapdos_only.html">Zapdos Input Syntax</a></li><li><a href="../index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../../examples/crane_examples.html">CRANE Examples</a></li><li><a href="../../development/contributing.html">Contributing Guidelines</a></li><li><a href="../../development/code_standards.html">Code Standards</a></li><li><a href="../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="2cd85e14-f3dc-44ba-bc32-1aef05a57d10"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="../../development/zapdos_developer_info.html">Zapdos Developer Information</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">syntax</a><a href="." class="breadcrumb">Reporters</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="8de53bcb-a83f-48ab-83d5-d8dda673bd43" data-section-level="1" data-section-text="Reporter System"><h1 id="reporter-system">Reporter System</h1><p>The Reporter system may be considered a generalization of the <a href="../Postprocessors/index.html">Postprocessor</a> and <a href="../VectorPostprocessors/index.html">VectorPostprocessor</a> systems. Each Reporter object may declare any number of values with any types. By contrast, post-processors each declare a single, scalar, <code>Real</code> value, and while vector post-processors declare any number of values, they must all be of type <code>std::vector&lt;Real&gt;</code>. Reporters can declare both scalar and vector data of any type, including complex data and arbitrary classes/structs. The only requirement on the data type is that the types must have associated <code>dataLoad</code> and <code>dataStore</code> specializations (see <a href="../../source/restart/DataIO.html">DataIO</a>).</p><p>The reporter system uses a producer/consumer relationship: reporter objects &quot;produce&quot; data values, which then may be &quot;consumed&quot; by other objects.</p><section class="scrollspy" id="f295c32c-b321-4ec4-8e30-0e4a3ace0c8b" data-section-level="2" data-section-text="Producing Reporter Data"><h2 id="producing-reporter-data">Producing Reporter Data</h2><p>As noted above, Reporter objects declare any number of values of any type. Note that these values are automatically registered as restartable. For complex types, data serialization routines might be needed; see <a href="../../source/restart/DataIO.html">DataIO</a> for more information.</p><p>In the Reporter header file, Reporter values are declared as non-const reference members of the desired types, for example:</p><pre style="max-height:350px;"><code class="language-cpp">int &amp; _int;
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#3b4fd56d-9048-4e91-82bc-36e5fdc4c21d">(moose/test/include/reporters/TestReporter.h)</a><p>These references are initialized using the <code>declareValue</code> and <code>declareValueByName</code> methods. Note that it is possible to indicate how the value is to be computed, with respect to parallelism, by setting the calculation mode; see <a href="index.html#reporter-modes">Reporter Context and Modes</a> for more information. The <code>declareValueByName</code> method uses the supplied string directly as the value name, while the <code>declareValue</code> method gets the value name from the supplied <code>ReporterValueName</code> parameter declared in <code>validParams</code>. For example, in <code>validParams</code>,</p><pre style="max-height:350px;"><code class="language-cpp">  params.addParam&lt;ReporterValueName&gt;(&quot;int_name&quot;, &quot;int&quot;, &quot;The name of the integer data&quot;);
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#2954775e-ee1c-4f10-96e1-afca3c3adaff">(moose/test/src/reporters/TestReporter.C)</a><p>Then the Reporter data can be declared using <code>declareValue</code>:</p><pre style="max-height:350px;"><code class="language-cpp">_int(declareValue&lt;int&gt;(&quot;int_name&quot;, 1980)),
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#a6f36394-06a4-4367-8b52-2885f94e1dc7">(moose/test/src/reporters/TestReporter.C)</a><p>Note that in this example, an initial value is supplied for the data.</p><p>The calculation of the value(s) occurs by overriding the <code>execute</code> method and updating the values:</p><pre style="max-height:350px;"><code class="language-cpp">void
TestDeclareReporter::execute()
{
  _int += 1;
  _real = 1.2345;
  _vector = {1, 1.1, 1.2};
  _string = &quot;string&quot;;

  if (processor_id() == 0)
    _bcast_value = 42;

  _gather_value.resize(1, processor_id());

  if (_distributed_vector)
  {
    _distributed_vector-&gt;resize(_vector.size());
    (*_distributed_vector)[0] = processor_id();
    for (unsigned int i = 1; i &lt; _distributed_vector-&gt;size(); ++i)
      (*_distributed_vector)[i] = (*_distributed_vector)[i - 1] * 10;
  }
}
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#15e2f2e3-155c-4883-9546-fbf8668edb61">(moose/test/src/reporters/TestReporter.C)</a></section><section class="scrollspy" id="d523585e-3f9c-4df2-b07d-33f6590f85fc" data-section-level="2" data-section-text="Consuming Reporter Data"><h2 id="consuming-reporter-data">Consuming Reporter Data</h2><p>Any object that inherits from the <code>ReporterInterface</code> may consume a value produced by a Reporter. Values are retrieved in a similar fashion as declared, but use a constant reference. For example, values to be consumed should create a reference in the class definition:</p><pre style="max-height:350px;"><code class="language-cpp">const int &amp; _int;
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#d6fd2a68-3fa1-46fe-a1ad-8176c921cf11">(moose/test/include/reporters/TestReporter.h)</a><p>In the initialization list, the <code>getReporterValue</code> or <code>getReporterValueByName</code> method is used to initialize the reference:</p><pre style="max-height:350px;"><code class="language-cpp">_int(getReporterValue&lt;int&gt;(&quot;int_reporter&quot;)),
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#d8366676-a3df-458b-bd6c-327870979f32">(moose/test/src/reporters/TestReporter.C)</a><p>Similarly to <code>declareValue</code> and <code>declareValueByName</code>, <code>getReporterValue</code> uses the provided string for the value name, whereas <code>getReporterValueByName</code> gets the value name from the parameter named by the provided string. In the example above, the following appears in <code>validParams</code>:</p><pre style="max-height:350px;"><code class="language-cpp">  params.addRequiredParam&lt;ReporterName&gt;(&quot;int_reporter&quot;, &quot;&#x27;int&#x27; reporter name&quot;);
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#b12aa3f3-f3c0-4e46-9229-cca6b1f9a968">(moose/test/src/reporters/TestReporter.C)</a><p>The get methods accept a <code>ReporterName</code> object, which is simply the combination of the name of the producing Reporter object and the name of the reporter value. In the input file, the ReporterName is provided as follows, where &quot;a&quot; is the name of the Reporter object in the <code>[Reporters]</code> block of the input file that is producing data with the name &quot;int&quot;, which is the name given to the data within the <code>declareValue</code>/<code>declareValueByName</code> method of that object:</p><pre style="max-height:350px;"><code class="language-moose">    int_reporter = a/int</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#e97a99a8-741e-4748-9d92-97fd55406a10">(moose/test/tests/reporters/base/base.i)</a></section><section class="scrollspy" id="1bdbd777-cfab-4913-b532-15d9ad1554ee" data-section-level="2" data-section-text="Outputting Reporter Data"><h2 id="reporter-output">Outputting Reporter Data</h2><p>Reporter values may be output in two formats: <span>comma-separated values (CSV)</span> and <span>JavaScript Object Notation (JSON)</span>. <span class="tooltipped" data-tooltip="comma-separated values" data-position="top" data-delay="50">CSV</span> output is limited to Reporter values with a type of <code>Real</code> or <code>std::vector&lt;Real&gt;</code>. <span class="tooltipped" data-tooltip="JavaScript Object Notation" data-position="top" data-delay="50">JSON</span> output will work for any type that has a <code>to_json</code> function; see <a href="../../source/outputs/JSONOutput.html">JSON</a> for more details.</p></section><section class="scrollspy" id="bba7d2fc-e6bf-4327-a2e5-87e7c395d1f3" data-section-level="2" data-section-text="Reporter Context and Modes"><h2 id="reporter-modes">Reporter Context and Modes</h2><p>Reporter values use a context system for performing parallel operations automatically. The default context allows Reporter values to be produced and consumed in various modes. Depending on the mode produced/consumed, parallel operations will be performed automatically. The following modes exist for the default context:</p><ul class="browser-default"><li><p><strong>REPORTER_MODE_ROOT</strong>: Values exist only on the root processor. </p></li><li><p><strong>REPORTER_MODE_REPLICATED</strong>: Values exist and are identical on all processors. </p></li><li><p><strong>REPORTER_MODE_DISTRIBUTED</strong>: Values exist and are different across processors.</p></li></ul><p>Values can be produced or consumed in any of the prescribed modes. When consumed, the mode of production is checked against the mode of consumption. <a href="#producer-consumer-modes">Table 1</a> details the actions taken by the various possible modes of production and consumption for a Reporter value.</p><div class="card moose-float"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Table 1: </span><span class="moose-caption-text" id="producer-consumer-modes">Default operations for the default context that occur for Reporter values depending                on the modes of production and consumption. The prefix <code>REPORTER_MODE_</code> is omitted                for clarity.</span></p><div recursive form="['left', 'left', 'left']" class="moose-table-div"><table><thead><tr><th style=";text-align:left">Producer Mode</th><th style=";text-align:left">Consumer Mode</th><th style=";text-align:left">Operation</th></tr></thead><tbody><tr><td style=";text-align:left">ROOT</td><td style=";text-align:left">ROOT</td><td style=";text-align:left">Do nothing</td></tr></tbody><tbody><tr><td style=";text-align:left">REPLICATED</td><td style=";text-align:left">ROOT</td><td style=";text-align:left">Do nothing</td></tr></tbody><tbody><tr><td style=";text-align:left">REPLICATED</td><td style=";text-align:left">REPLICATED</td><td style=";text-align:left">Do nothing</td></tr></tbody><tbody><tr><td style=";text-align:left">DISTRIBUTED</td><td style=";text-align:left">DISTRIBUTED</td><td style=";text-align:left">Do nothing</td></tr></tbody><tbody><tr><td style=";text-align:left">ROOT</td><td style=";text-align:left">REPLICATED</td><td style=";text-align:left">MPI Broadcast</td></tr></tbody><tbody><tr><td style=";text-align:left">ROOT</td><td style=";text-align:left">DISTRIBUTED</td><td style=";text-align:left">Error</td></tr></tbody><tbody><tr><td style=";text-align:left">REPLICATED</td><td style=";text-align:left">DISTRIBUTED</td><td style=";text-align:left">Error</td></tr></tbody><tbody><tr><td style=";text-align:left">DISTRIBUTED</td><td style=";text-align:left">ROOT</td><td style=";text-align:left">Error</td></tr></tbody><tbody><tr><td style=";text-align:left">DISTRIBUTED</td><td style=";text-align:left">REPLICATED</td><td style=";text-align:left">Error</td></tr></tbody></table></div></div></div><p>The <code>declareValue</code> and <code>declareValueByName</code> methods allow for non-default context to be defined. For example, the following line declares a Reporter value to use the gather context object. A list of available contexts follows the code snippet.</p><pre style="max-height:350px;"><code class="language-cpp">_gather_value(declareValueByName&lt;std::vector&lt;dof_id_type&gt;, ReporterGatherContext&gt;(&quot;gather&quot;)), </code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#61653b13-7744-4801-af22-380b4e0f7b47">(moose/test/src/reporters/TestReporter.C)</a><p><code>ReporterBroadcastContext</code><br>Automatically performs an MPI broadcast of a specified value on the root processor to all processors.</p><p><code>ReporterScatterContext</code><br>Automatically performs an MPI scatter of a vector of data on the root processor to all processors.</p><p><code>ReporterGatherContext</code><br>Automatically performs an MPI gather to a vector of data on the root processor from all processors.</p></section><section class="scrollspy" id="8409251b-acff-4c37-b5cf-e7bd8919c314" data-section-level="2" data-section-text="Reporter Debug Output"><h2 id="reporter-debug-output">Reporter Debug Output</h2><p>The <a href="../../source/outputs/ReporterDebugOutput.html">ReporterDebugOutput</a> output can be added to output to screen all of the Reporter values that were declared and requested, along with their types, producers, contexts, consumers, and consumer modes. This debug output can also be enabled with the <code>Debug/show_reporters</code> parameter.</p></section><section class="scrollspy" id="0566572f-976d-422a-90f5-d16ffe3bc15d" data-section-level="2" data-section-text="Restore on Rejected Timesteps"><h2 id="restore-on-rejected-timesteps">Restore on Rejected Timesteps</h2><p>When a timestep is rejected due to a failed solve, a failed multiapp solve, or any other reason, the timestep is usually repeated, usually with a smaller timestep size. However, unlike postprocessors, generic reporters are not restored to their old values, i.e. before the initial timestep, unless an old value is requested by another object. This can cause statefulness in objects dependent on the reporter between the repeated timesteps. If you suspect this might be causing indeterminate behavior in your simulation, you can check all the data being restored between the failed and repeated timestep by setting <code>Problem/</code><a href="#aae9563b-2e09-44c5-927e-9e9f0d2b2a33" class="moose-modal-link modal-trigger">&quot;verbose_restore&quot;</a>` = true`.</p></section><section class="scrollspy" id="e5c1ee3f-d761-4bb2-b712-42b47199699f" data-section-level="2" data-section-text="Available Objects"><h2 id="available-objects">Available Objects</h2><ul class="moose-syntax-list collection with-header"><li class="collection-header">Moose App</li><li class="collection-item"><a href="../../source/reporters/ElementExtremeMaterialPropertyReporter.html">ADElementExtremeMaterialPropertyReporter</a>Determines the location of the minimum or maximum value of a material property over a volume, and provides its coordinates and optionally other requested data at that location.</li><li class="collection-item"><a href="../../source/reporters/AccumulateReporter.html">AccumulateReporter</a>Reporter which accumulates the value of a inputted reporter value over time into a vector reporter value of the same type.</li><li class="collection-item"><a href="../../source/reporters/ConstantReporter.html">ConstantReporter</a>Reporter with constant values to be accessed by other objects, can be modified using transfers.</li><li class="collection-item"><a href="../../source/reporters/ElementExtremeMaterialPropertyReporter.html">ElementExtremeMaterialPropertyReporter</a>Determines the location of the minimum or maximum value of a material property over a volume, and provides its coordinates and optionally other requested data at that location.</li><li class="collection-item"><a href="../../source/reporters/ElementVariableStatistics.html">ElementVariableStatistics</a>Element reporter to get statistics for a coupled variable. This can be transfered to other apps.</li><li class="collection-item"><a href="../../source/reporters/ExtraIDIntegralReporter.html">ExtraIDIntegralReporter</a>This ExtraIDIntegralReporter source code is to integrate variables based on parsed extra IDs based on reporter system.</li><li class="collection-item"><a href="../../source/reporters/IterationInfo.html">IterationInfo</a>Report the time and iteration information for the simulation.</li><li class="collection-item"><a href="../../source/reporters/MeshInfo.html">MeshInfo</a>Report mesh information, such as the number of elements, nodes, and degrees of freedom.</li><li class="collection-item"><a href="../../source/reporters/MeshMetaDataReporter.html">MeshMetaDataReporter</a>Reports the mesh meta data.</li><li class="collection-item"><a href="../../source/reporters/NodalVariableStatistics.html">NodalVariableStatistics</a>Nodal reporter to get statistics for a coupled variable. This can be transfered to other apps.</li><li class="collection-item"><a href="../../source/reporters/ParsedScalarReporter.html">ParsedScalarReporter</a>Applies parsed functions to scalar entries held in reporters.</li><li class="collection-item"><a href="../../source/reporters/ParsedVectorRealReductionReporter.html">ParsedVectorRealReductionReporter</a>Use a parsed function to iterate through a vector and reduce it to a scalar.</li><li class="collection-item"><a href="../../source/reporters/ParsedVectorReporter.html">ParsedVectorReporter</a>Apply parsed functions to vector entries held in reporters.</li><li class="collection-item"><a href="../../source/reporters/ParsedVectorVectorRealReductionReporter.html">ParsedVectorVectorRealReductionReporter</a>Use a parsed function to iterate through a rows of a vector of vector and reduce it to a vector.</li><li class="collection-item"><a href="../../source/reporters/PerfGraphReporter.html">PerfGraphReporter</a>Reports the full performance graph from the PerfGraph.</li><li class="collection-item"><a href="../../source/reporters/RestartableDataReporter.html">RestartableDataReporter</a>Reports restartable data and restartable meta data.</li><li class="collection-item"><a href="../../source/reporters/SolutionInvalidityReporter.html">SolutionInvalidityReporter</a>Reports the Summary Table of Solution Invalid Counts.</li></ul></section><section class="scrollspy" id="919cce7e-20aa-4ff4-97b1-618c93fd4086" data-section-level="2" data-section-text="Available Actions"><h2 id="available-actions">Available Actions</h2><ul class="moose-syntax-list collection with-header"><li class="collection-header">Moose App</li><li class="collection-item"><a href="../../source/actions/AddReporterAction.html">AddReporterAction</a>Add a Reporter object to the simulation.</li></ul></section></section><div class="moose-modal modal" id="3b4fd56d-9048-4e91-82bc-36e5fdc4c21d"><div class="modal-content"><h4>(moose/test/include/reporters/TestReporter.h)</h4><pre style="max-height:350px;"><code class="language-cpp">// This file is part of the MOOSE framework
// https://mooseframework.inl.gov
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#pragma once

#include &quot;GeneralReporter.h&quot;

class TestDeclareReporter : public GeneralReporter
{
public:
  static InputParameters validParams();
  TestDeclareReporter(const InputParameters &amp; parameters);
  virtual void initialize() override {}
  virtual void finalize() override {}
  virtual void execute() override;

protected:
  int &amp; _int; // MooseDocs:producer
  Real &amp; _real;
  std::vector&lt;Real&gt; &amp; _vector;
  std::string &amp; _string;
  Real &amp; _bcast_value;

  std::vector&lt;dof_id_type&gt; _values_to_scatter;
  dof_id_type &amp; _scatter_value;

  std::vector&lt;dof_id_type&gt; _values_to_gather;
  std::vector&lt;dof_id_type&gt; &amp; _gather_value;

  std::vector&lt;dof_id_type&gt; * _distributed_vector;
};

class TestGetReporter : public GeneralReporter
{
public:
  static InputParameters validParams();
  TestGetReporter(const InputParameters &amp; parameters);
  virtual void initialize() override {}
  virtual void finalize() override {}
  virtual void execute() override;

protected:
  const int &amp; _int; // MooseDocs:consumer
  const int &amp; _int_old;

  const Real &amp; _real;
  const std::vector&lt;Real&gt; &amp; _vector;
  const std::string &amp; _string;
  const Real &amp; _bcast_value;
  const dof_id_type &amp; _scatter_value;
  const std::vector&lt;dof_id_type&gt; &amp; _gather_value;
};

class TestDeclareInitialSetupReporter : public GeneralReporter
{
public:
  static InputParameters validParams();
  TestDeclareInitialSetupReporter(const InputParameters &amp; parameters);
  virtual void initialSetup() override;
  virtual void initialize() override {}
  virtual void finalize() override {}
  virtual void execute() override {}
};

class TestGetReporterDeclaredInInitialSetupReporter : public GeneralReporter
{
public:
  static InputParameters validParams();
  TestGetReporterDeclaredInInitialSetupReporter(const InputParameters &amp; parameters);
  virtual void initialize() override {}
  virtual void finalize() override {}
  virtual void execute() override;

protected:
  const Real &amp; _value_declared_in_initial_setup;
  Real &amp; _the_value_of_the_reporter;
};

class TestDeclareErrorsReporter : public GeneralReporter
{
public:
  static InputParameters validParams();
  TestDeclareErrorsReporter(const InputParameters &amp; parameters);
  virtual void initialize() override {}
  virtual void finalize() override {}
  virtual void execute() override {}
};
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="2954775e-ee1c-4f10-96e1-afca3c3adaff"><div class="modal-content"><h4>(moose/test/src/reporters/TestReporter.C)</h4><pre style="max-height:350px;"><code class="language-cpp">// This file is part of the MOOSE framework
// https://mooseframework.inl.gov
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#include &quot;TestReporter.h&quot;

registerMooseObject(&quot;MooseTestApp&quot;, TestDeclareReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestGetReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestDeclareInitialSetupReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestGetReporterDeclaredInInitialSetupReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestDeclareErrorsReporter);

InputParameters
TestDeclareReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  // MooseDocs:param_begin
  params.addParam&lt;ReporterValueName&gt;(&quot;int_name&quot;, &quot;int&quot;, &quot;The name of the integer data&quot;);
  // MooseDocs:param_end
  params.addParam&lt;ReporterValueName&gt;(&quot;distributed_vector_name&quot;, &quot;Distributed vector to produce.&quot;);
  return params;
}

TestDeclareReporter::TestDeclareReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters),
    _int(declareValue&lt;int&gt;(&quot;int_name&quot;, 1980)), // MooseDocs:producer
    _real(declareValueByName&lt;Real&gt;(&quot;real&quot;)),
    _vector(declareValueByName&lt;std::vector&lt;Real&gt;&gt;(&quot;vector&quot;)),
    _string(declareValueByName&lt;std::string&gt;(&quot;string&quot;)),
    _bcast_value(declareValueByName&lt;Real, ReporterBroadcastContext&gt;(&quot;broadcast&quot;)),
    _scatter_value(
        declareValueByName&lt;dof_id_type, ReporterScatterContext&gt;(&quot;scatter&quot;, _values_to_scatter)),
    _gather_value(declareValueByName&lt;std::vector&lt;dof_id_type&gt;, ReporterGatherContext&gt;(
        &quot;gather&quot;)), // MooseDocs:gather
    _distributed_vector(isParamValid(&quot;distributed_vector_name&quot;)
                            ? &amp;declareValue&lt;std::vector&lt;dof_id_type&gt;&gt;(&quot;distributed_vector_name&quot;,
                                                                      REPORTER_MODE_DISTRIBUTED)
                            : nullptr)
{
  if (processor_id() == 0)
    for (dof_id_type rank = 0; rank &lt; n_processors(); ++rank)
      _values_to_scatter.push_back(rank);
}

// MooseDocs:execute_begin
void
TestDeclareReporter::execute()
{
  _int += 1;
  _real = 1.2345;
  _vector = {1, 1.1, 1.2};
  _string = &quot;string&quot;;

  if (processor_id() == 0)
    _bcast_value = 42;

  _gather_value.resize(1, processor_id());

  if (_distributed_vector)
  {
    _distributed_vector-&gt;resize(_vector.size());
    (*_distributed_vector)[0] = processor_id();
    for (unsigned int i = 1; i &lt; _distributed_vector-&gt;size(); ++i)
      (*_distributed_vector)[i] = (*_distributed_vector)[i - 1] * 10;
  }
}
// MooseDocs:execute_end

InputParameters
TestGetReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;ReporterName&gt;(&quot;int_reporter&quot;, &quot;&#x27;int&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;real_reporter&quot;, &quot;&#x27;real&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;vector_reporter&quot;, &quot;&#x27;vector&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;string_reporter&quot;, &quot;&#x27;string&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;broadcast_reporter&quot;, &quot;&#x27;broadcast&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;scatter_reporter&quot;, &quot;&#x27;scatter&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;gather_reporter&quot;, &quot;&#x27;gather&#x27; reporter name&quot;);
  return params;
}

TestGetReporter::TestGetReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters),
    _int(getReporterValue&lt;int&gt;(&quot;int_reporter&quot;)), // MooseDocs:consumer
    _int_old(getReporterValue&lt;int&gt;(&quot;int_reporter&quot;, 1)),
    _real(getReporterValue&lt;Real&gt;(&quot;real_reporter&quot;)),
    _vector(getReporterValue&lt;std::vector&lt;Real&gt;&gt;(&quot;vector_reporter&quot;)),
    _string(getReporterValue&lt;std::string&gt;(&quot;string_reporter&quot;)),
    _bcast_value(getReporterValue&lt;Real&gt;(&quot;broadcast_reporter&quot;)),
    _scatter_value(getReporterValue&lt;dof_id_type&gt;(&quot;scatter_reporter&quot;)),
    _gather_value(getReporterValue&lt;std::vector&lt;dof_id_type&gt;&gt;(&quot;gather_reporter&quot;))
{
}

void
TestGetReporter::execute()
{
  if (_int != 1980 + _t_step)
    mooseError(&quot;int reporter test failed: &quot;, _int, &quot; != &quot;, 1980 + _t_step);
  if (_real != 1.2345)
    mooseError(&quot;Real reporter test failed&quot;);
  if (_vector != std::vector&lt;Real&gt;({1., 1.1, 1.2}))
    mooseError(&quot;std::vector&lt;Real&gt; reporter test failed&quot;);
  if (_string != &quot;string&quot;)
    mooseError(&quot;std::string reporter test failed&quot;);

  if (_t_step == 0 &amp;&amp; _int_old != 1980)
    mooseError(&quot;int_old on timestep 0 failed: &quot;, _int_old, &quot; != &quot;, 1980);
  if (_t_step &gt; 0 &amp;&amp; _int_old != 1980 + (_t_step - 1))
    mooseError(
        &quot;int_old on timestep &quot;, _t_step, &quot; failed: &quot;, _int_old, &quot; != &quot;, 1980 + (_t_step - 1));

  if (_bcast_value != 42)
    mooseError(&quot;Broadcast reporter test failed&quot;);

  if (_scatter_value != processor_id())
    mooseError(&quot;Scatter reporter test failed&quot;);

  if (processor_id() == 0)
  {
    std::vector&lt;dof_id_type&gt; gold;
    for (dof_id_type id = 0; id &lt; n_processors(); ++id)
      gold.push_back(id);
    if (_gather_value != gold)
      mooseError(&quot;Gather reporter test failed!&quot;);
  }
}

InputParameters
TestDeclareInitialSetupReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;Real&gt;(&quot;value&quot;, &quot;The value to report.&quot;);
  return params;
}

TestDeclareInitialSetupReporter::TestDeclareInitialSetupReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters)
{
}

void
TestDeclareInitialSetupReporter::initialSetup()
{
  Real &amp; value = declareValueByName&lt;Real&gt;(&quot;value&quot;);
  value = getParam&lt;Real&gt;(&quot;value&quot;);
}

InputParameters
TestGetReporterDeclaredInInitialSetupReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;ReporterName&gt;(&quot;other_reporter&quot;,
                                        &quot;The reporter name that was declared in initialSetup&quot;);
  return params;
}

TestGetReporterDeclaredInInitialSetupReporter::TestGetReporterDeclaredInInitialSetupReporter(
    const InputParameters &amp; parameters)
  : GeneralReporter(parameters),
    _value_declared_in_initial_setup(getReporterValue&lt;Real&gt;(&quot;other_reporter&quot;)),
    _the_value_of_the_reporter(declareValueByName&lt;Real&gt;(&quot;other_value&quot;))
{
}

void
TestGetReporterDeclaredInInitialSetupReporter::execute()
{
  _the_value_of_the_reporter = _value_declared_in_initial_setup;
}

InputParameters
TestDeclareErrorsReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;ReporterValueName&gt;(&quot;value&quot;, &quot;A reporter value name&quot;);

  params.addParam&lt;bool&gt;(&quot;missing_param&quot;, false, &quot;True to test the error for a missing parameter&quot;);
  params.addParam&lt;bool&gt;(&quot;bad_param&quot;, false, &quot;True to test the error for a bad parameter type&quot;);
  params.addParam&lt;bool&gt;(&quot;already_declared&quot;, false, &quot;Test declaring a value multiple times&quot;);
  params.addParam&lt;bool&gt;(&quot;requested_different_type&quot;,
                        false,
                        &quot;Test declaring a value that has been requested with a differentt type&quot;);

  return params;
}

TestDeclareErrorsReporter::TestDeclareErrorsReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters)
{
  if (getParam&lt;bool&gt;(&quot;missing_param&quot;))
    declareValue&lt;int&gt;(&quot;some_missing_parm&quot;);
  if (getParam&lt;bool&gt;(&quot;bad_param&quot;))
    declareValue&lt;int&gt;(&quot;bad_param&quot;);
  if (getParam&lt;bool&gt;(&quot;already_declared&quot;))
  {
    declareValueByName&lt;int&gt;(&quot;value_name&quot;);
    declareValueByName&lt;Real&gt;(&quot;value_name&quot;);
  }
  if (getParam&lt;bool&gt;(&quot;requested_different_type&quot;))
  {
    getReporterValueByName&lt;int&gt;(name() + &quot;/value_name&quot;);
    declareValueByName&lt;Real&gt;(&quot;value_name&quot;);
  }
}
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="a6f36394-06a4-4367-8b52-2885f94e1dc7"><div class="modal-content"><h4>(moose/test/src/reporters/TestReporter.C)</h4><pre style="max-height:350px;"><code class="language-cpp">// This file is part of the MOOSE framework
// https://mooseframework.inl.gov
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#include &quot;TestReporter.h&quot;

registerMooseObject(&quot;MooseTestApp&quot;, TestDeclareReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestGetReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestDeclareInitialSetupReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestGetReporterDeclaredInInitialSetupReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestDeclareErrorsReporter);

InputParameters
TestDeclareReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  // MooseDocs:param_begin
  params.addParam&lt;ReporterValueName&gt;(&quot;int_name&quot;, &quot;int&quot;, &quot;The name of the integer data&quot;);
  // MooseDocs:param_end
  params.addParam&lt;ReporterValueName&gt;(&quot;distributed_vector_name&quot;, &quot;Distributed vector to produce.&quot;);
  return params;
}

TestDeclareReporter::TestDeclareReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters),
    _int(declareValue&lt;int&gt;(&quot;int_name&quot;, 1980)), // MooseDocs:producer
    _real(declareValueByName&lt;Real&gt;(&quot;real&quot;)),
    _vector(declareValueByName&lt;std::vector&lt;Real&gt;&gt;(&quot;vector&quot;)),
    _string(declareValueByName&lt;std::string&gt;(&quot;string&quot;)),
    _bcast_value(declareValueByName&lt;Real, ReporterBroadcastContext&gt;(&quot;broadcast&quot;)),
    _scatter_value(
        declareValueByName&lt;dof_id_type, ReporterScatterContext&gt;(&quot;scatter&quot;, _values_to_scatter)),
    _gather_value(declareValueByName&lt;std::vector&lt;dof_id_type&gt;, ReporterGatherContext&gt;(
        &quot;gather&quot;)), // MooseDocs:gather
    _distributed_vector(isParamValid(&quot;distributed_vector_name&quot;)
                            ? &amp;declareValue&lt;std::vector&lt;dof_id_type&gt;&gt;(&quot;distributed_vector_name&quot;,
                                                                      REPORTER_MODE_DISTRIBUTED)
                            : nullptr)
{
  if (processor_id() == 0)
    for (dof_id_type rank = 0; rank &lt; n_processors(); ++rank)
      _values_to_scatter.push_back(rank);
}

// MooseDocs:execute_begin
void
TestDeclareReporter::execute()
{
  _int += 1;
  _real = 1.2345;
  _vector = {1, 1.1, 1.2};
  _string = &quot;string&quot;;

  if (processor_id() == 0)
    _bcast_value = 42;

  _gather_value.resize(1, processor_id());

  if (_distributed_vector)
  {
    _distributed_vector-&gt;resize(_vector.size());
    (*_distributed_vector)[0] = processor_id();
    for (unsigned int i = 1; i &lt; _distributed_vector-&gt;size(); ++i)
      (*_distributed_vector)[i] = (*_distributed_vector)[i - 1] * 10;
  }
}
// MooseDocs:execute_end

InputParameters
TestGetReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;ReporterName&gt;(&quot;int_reporter&quot;, &quot;&#x27;int&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;real_reporter&quot;, &quot;&#x27;real&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;vector_reporter&quot;, &quot;&#x27;vector&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;string_reporter&quot;, &quot;&#x27;string&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;broadcast_reporter&quot;, &quot;&#x27;broadcast&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;scatter_reporter&quot;, &quot;&#x27;scatter&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;gather_reporter&quot;, &quot;&#x27;gather&#x27; reporter name&quot;);
  return params;
}

TestGetReporter::TestGetReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters),
    _int(getReporterValue&lt;int&gt;(&quot;int_reporter&quot;)), // MooseDocs:consumer
    _int_old(getReporterValue&lt;int&gt;(&quot;int_reporter&quot;, 1)),
    _real(getReporterValue&lt;Real&gt;(&quot;real_reporter&quot;)),
    _vector(getReporterValue&lt;std::vector&lt;Real&gt;&gt;(&quot;vector_reporter&quot;)),
    _string(getReporterValue&lt;std::string&gt;(&quot;string_reporter&quot;)),
    _bcast_value(getReporterValue&lt;Real&gt;(&quot;broadcast_reporter&quot;)),
    _scatter_value(getReporterValue&lt;dof_id_type&gt;(&quot;scatter_reporter&quot;)),
    _gather_value(getReporterValue&lt;std::vector&lt;dof_id_type&gt;&gt;(&quot;gather_reporter&quot;))
{
}

void
TestGetReporter::execute()
{
  if (_int != 1980 + _t_step)
    mooseError(&quot;int reporter test failed: &quot;, _int, &quot; != &quot;, 1980 + _t_step);
  if (_real != 1.2345)
    mooseError(&quot;Real reporter test failed&quot;);
  if (_vector != std::vector&lt;Real&gt;({1., 1.1, 1.2}))
    mooseError(&quot;std::vector&lt;Real&gt; reporter test failed&quot;);
  if (_string != &quot;string&quot;)
    mooseError(&quot;std::string reporter test failed&quot;);

  if (_t_step == 0 &amp;&amp; _int_old != 1980)
    mooseError(&quot;int_old on timestep 0 failed: &quot;, _int_old, &quot; != &quot;, 1980);
  if (_t_step &gt; 0 &amp;&amp; _int_old != 1980 + (_t_step - 1))
    mooseError(
        &quot;int_old on timestep &quot;, _t_step, &quot; failed: &quot;, _int_old, &quot; != &quot;, 1980 + (_t_step - 1));

  if (_bcast_value != 42)
    mooseError(&quot;Broadcast reporter test failed&quot;);

  if (_scatter_value != processor_id())
    mooseError(&quot;Scatter reporter test failed&quot;);

  if (processor_id() == 0)
  {
    std::vector&lt;dof_id_type&gt; gold;
    for (dof_id_type id = 0; id &lt; n_processors(); ++id)
      gold.push_back(id);
    if (_gather_value != gold)
      mooseError(&quot;Gather reporter test failed!&quot;);
  }
}

InputParameters
TestDeclareInitialSetupReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;Real&gt;(&quot;value&quot;, &quot;The value to report.&quot;);
  return params;
}

TestDeclareInitialSetupReporter::TestDeclareInitialSetupReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters)
{
}

void
TestDeclareInitialSetupReporter::initialSetup()
{
  Real &amp; value = declareValueByName&lt;Real&gt;(&quot;value&quot;);
  value = getParam&lt;Real&gt;(&quot;value&quot;);
}

InputParameters
TestGetReporterDeclaredInInitialSetupReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;ReporterName&gt;(&quot;other_reporter&quot;,
                                        &quot;The reporter name that was declared in initialSetup&quot;);
  return params;
}

TestGetReporterDeclaredInInitialSetupReporter::TestGetReporterDeclaredInInitialSetupReporter(
    const InputParameters &amp; parameters)
  : GeneralReporter(parameters),
    _value_declared_in_initial_setup(getReporterValue&lt;Real&gt;(&quot;other_reporter&quot;)),
    _the_value_of_the_reporter(declareValueByName&lt;Real&gt;(&quot;other_value&quot;))
{
}

void
TestGetReporterDeclaredInInitialSetupReporter::execute()
{
  _the_value_of_the_reporter = _value_declared_in_initial_setup;
}

InputParameters
TestDeclareErrorsReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;ReporterValueName&gt;(&quot;value&quot;, &quot;A reporter value name&quot;);

  params.addParam&lt;bool&gt;(&quot;missing_param&quot;, false, &quot;True to test the error for a missing parameter&quot;);
  params.addParam&lt;bool&gt;(&quot;bad_param&quot;, false, &quot;True to test the error for a bad parameter type&quot;);
  params.addParam&lt;bool&gt;(&quot;already_declared&quot;, false, &quot;Test declaring a value multiple times&quot;);
  params.addParam&lt;bool&gt;(&quot;requested_different_type&quot;,
                        false,
                        &quot;Test declaring a value that has been requested with a differentt type&quot;);

  return params;
}

TestDeclareErrorsReporter::TestDeclareErrorsReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters)
{
  if (getParam&lt;bool&gt;(&quot;missing_param&quot;))
    declareValue&lt;int&gt;(&quot;some_missing_parm&quot;);
  if (getParam&lt;bool&gt;(&quot;bad_param&quot;))
    declareValue&lt;int&gt;(&quot;bad_param&quot;);
  if (getParam&lt;bool&gt;(&quot;already_declared&quot;))
  {
    declareValueByName&lt;int&gt;(&quot;value_name&quot;);
    declareValueByName&lt;Real&gt;(&quot;value_name&quot;);
  }
  if (getParam&lt;bool&gt;(&quot;requested_different_type&quot;))
  {
    getReporterValueByName&lt;int&gt;(name() + &quot;/value_name&quot;);
    declareValueByName&lt;Real&gt;(&quot;value_name&quot;);
  }
}
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="15e2f2e3-155c-4883-9546-fbf8668edb61"><div class="modal-content"><h4>(moose/test/src/reporters/TestReporter.C)</h4><pre style="max-height:350px;"><code class="language-cpp">// This file is part of the MOOSE framework
// https://mooseframework.inl.gov
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#include &quot;TestReporter.h&quot;

registerMooseObject(&quot;MooseTestApp&quot;, TestDeclareReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestGetReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestDeclareInitialSetupReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestGetReporterDeclaredInInitialSetupReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestDeclareErrorsReporter);

InputParameters
TestDeclareReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  // MooseDocs:param_begin
  params.addParam&lt;ReporterValueName&gt;(&quot;int_name&quot;, &quot;int&quot;, &quot;The name of the integer data&quot;);
  // MooseDocs:param_end
  params.addParam&lt;ReporterValueName&gt;(&quot;distributed_vector_name&quot;, &quot;Distributed vector to produce.&quot;);
  return params;
}

TestDeclareReporter::TestDeclareReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters),
    _int(declareValue&lt;int&gt;(&quot;int_name&quot;, 1980)), // MooseDocs:producer
    _real(declareValueByName&lt;Real&gt;(&quot;real&quot;)),
    _vector(declareValueByName&lt;std::vector&lt;Real&gt;&gt;(&quot;vector&quot;)),
    _string(declareValueByName&lt;std::string&gt;(&quot;string&quot;)),
    _bcast_value(declareValueByName&lt;Real, ReporterBroadcastContext&gt;(&quot;broadcast&quot;)),
    _scatter_value(
        declareValueByName&lt;dof_id_type, ReporterScatterContext&gt;(&quot;scatter&quot;, _values_to_scatter)),
    _gather_value(declareValueByName&lt;std::vector&lt;dof_id_type&gt;, ReporterGatherContext&gt;(
        &quot;gather&quot;)), // MooseDocs:gather
    _distributed_vector(isParamValid(&quot;distributed_vector_name&quot;)
                            ? &amp;declareValue&lt;std::vector&lt;dof_id_type&gt;&gt;(&quot;distributed_vector_name&quot;,
                                                                      REPORTER_MODE_DISTRIBUTED)
                            : nullptr)
{
  if (processor_id() == 0)
    for (dof_id_type rank = 0; rank &lt; n_processors(); ++rank)
      _values_to_scatter.push_back(rank);
}

// MooseDocs:execute_begin
void
TestDeclareReporter::execute()
{
  _int += 1;
  _real = 1.2345;
  _vector = {1, 1.1, 1.2};
  _string = &quot;string&quot;;

  if (processor_id() == 0)
    _bcast_value = 42;

  _gather_value.resize(1, processor_id());

  if (_distributed_vector)
  {
    _distributed_vector-&gt;resize(_vector.size());
    (*_distributed_vector)[0] = processor_id();
    for (unsigned int i = 1; i &lt; _distributed_vector-&gt;size(); ++i)
      (*_distributed_vector)[i] = (*_distributed_vector)[i - 1] * 10;
  }
}
// MooseDocs:execute_end

InputParameters
TestGetReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;ReporterName&gt;(&quot;int_reporter&quot;, &quot;&#x27;int&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;real_reporter&quot;, &quot;&#x27;real&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;vector_reporter&quot;, &quot;&#x27;vector&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;string_reporter&quot;, &quot;&#x27;string&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;broadcast_reporter&quot;, &quot;&#x27;broadcast&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;scatter_reporter&quot;, &quot;&#x27;scatter&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;gather_reporter&quot;, &quot;&#x27;gather&#x27; reporter name&quot;);
  return params;
}

TestGetReporter::TestGetReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters),
    _int(getReporterValue&lt;int&gt;(&quot;int_reporter&quot;)), // MooseDocs:consumer
    _int_old(getReporterValue&lt;int&gt;(&quot;int_reporter&quot;, 1)),
    _real(getReporterValue&lt;Real&gt;(&quot;real_reporter&quot;)),
    _vector(getReporterValue&lt;std::vector&lt;Real&gt;&gt;(&quot;vector_reporter&quot;)),
    _string(getReporterValue&lt;std::string&gt;(&quot;string_reporter&quot;)),
    _bcast_value(getReporterValue&lt;Real&gt;(&quot;broadcast_reporter&quot;)),
    _scatter_value(getReporterValue&lt;dof_id_type&gt;(&quot;scatter_reporter&quot;)),
    _gather_value(getReporterValue&lt;std::vector&lt;dof_id_type&gt;&gt;(&quot;gather_reporter&quot;))
{
}

void
TestGetReporter::execute()
{
  if (_int != 1980 + _t_step)
    mooseError(&quot;int reporter test failed: &quot;, _int, &quot; != &quot;, 1980 + _t_step);
  if (_real != 1.2345)
    mooseError(&quot;Real reporter test failed&quot;);
  if (_vector != std::vector&lt;Real&gt;({1., 1.1, 1.2}))
    mooseError(&quot;std::vector&lt;Real&gt; reporter test failed&quot;);
  if (_string != &quot;string&quot;)
    mooseError(&quot;std::string reporter test failed&quot;);

  if (_t_step == 0 &amp;&amp; _int_old != 1980)
    mooseError(&quot;int_old on timestep 0 failed: &quot;, _int_old, &quot; != &quot;, 1980);
  if (_t_step &gt; 0 &amp;&amp; _int_old != 1980 + (_t_step - 1))
    mooseError(
        &quot;int_old on timestep &quot;, _t_step, &quot; failed: &quot;, _int_old, &quot; != &quot;, 1980 + (_t_step - 1));

  if (_bcast_value != 42)
    mooseError(&quot;Broadcast reporter test failed&quot;);

  if (_scatter_value != processor_id())
    mooseError(&quot;Scatter reporter test failed&quot;);

  if (processor_id() == 0)
  {
    std::vector&lt;dof_id_type&gt; gold;
    for (dof_id_type id = 0; id &lt; n_processors(); ++id)
      gold.push_back(id);
    if (_gather_value != gold)
      mooseError(&quot;Gather reporter test failed!&quot;);
  }
}

InputParameters
TestDeclareInitialSetupReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;Real&gt;(&quot;value&quot;, &quot;The value to report.&quot;);
  return params;
}

TestDeclareInitialSetupReporter::TestDeclareInitialSetupReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters)
{
}

void
TestDeclareInitialSetupReporter::initialSetup()
{
  Real &amp; value = declareValueByName&lt;Real&gt;(&quot;value&quot;);
  value = getParam&lt;Real&gt;(&quot;value&quot;);
}

InputParameters
TestGetReporterDeclaredInInitialSetupReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;ReporterName&gt;(&quot;other_reporter&quot;,
                                        &quot;The reporter name that was declared in initialSetup&quot;);
  return params;
}

TestGetReporterDeclaredInInitialSetupReporter::TestGetReporterDeclaredInInitialSetupReporter(
    const InputParameters &amp; parameters)
  : GeneralReporter(parameters),
    _value_declared_in_initial_setup(getReporterValue&lt;Real&gt;(&quot;other_reporter&quot;)),
    _the_value_of_the_reporter(declareValueByName&lt;Real&gt;(&quot;other_value&quot;))
{
}

void
TestGetReporterDeclaredInInitialSetupReporter::execute()
{
  _the_value_of_the_reporter = _value_declared_in_initial_setup;
}

InputParameters
TestDeclareErrorsReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;ReporterValueName&gt;(&quot;value&quot;, &quot;A reporter value name&quot;);

  params.addParam&lt;bool&gt;(&quot;missing_param&quot;, false, &quot;True to test the error for a missing parameter&quot;);
  params.addParam&lt;bool&gt;(&quot;bad_param&quot;, false, &quot;True to test the error for a bad parameter type&quot;);
  params.addParam&lt;bool&gt;(&quot;already_declared&quot;, false, &quot;Test declaring a value multiple times&quot;);
  params.addParam&lt;bool&gt;(&quot;requested_different_type&quot;,
                        false,
                        &quot;Test declaring a value that has been requested with a differentt type&quot;);

  return params;
}

TestDeclareErrorsReporter::TestDeclareErrorsReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters)
{
  if (getParam&lt;bool&gt;(&quot;missing_param&quot;))
    declareValue&lt;int&gt;(&quot;some_missing_parm&quot;);
  if (getParam&lt;bool&gt;(&quot;bad_param&quot;))
    declareValue&lt;int&gt;(&quot;bad_param&quot;);
  if (getParam&lt;bool&gt;(&quot;already_declared&quot;))
  {
    declareValueByName&lt;int&gt;(&quot;value_name&quot;);
    declareValueByName&lt;Real&gt;(&quot;value_name&quot;);
  }
  if (getParam&lt;bool&gt;(&quot;requested_different_type&quot;))
  {
    getReporterValueByName&lt;int&gt;(name() + &quot;/value_name&quot;);
    declareValueByName&lt;Real&gt;(&quot;value_name&quot;);
  }
}
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="d6fd2a68-3fa1-46fe-a1ad-8176c921cf11"><div class="modal-content"><h4>(moose/test/include/reporters/TestReporter.h)</h4><pre style="max-height:350px;"><code class="language-cpp">// This file is part of the MOOSE framework
// https://mooseframework.inl.gov
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#pragma once

#include &quot;GeneralReporter.h&quot;

class TestDeclareReporter : public GeneralReporter
{
public:
  static InputParameters validParams();
  TestDeclareReporter(const InputParameters &amp; parameters);
  virtual void initialize() override {}
  virtual void finalize() override {}
  virtual void execute() override;

protected:
  int &amp; _int; // MooseDocs:producer
  Real &amp; _real;
  std::vector&lt;Real&gt; &amp; _vector;
  std::string &amp; _string;
  Real &amp; _bcast_value;

  std::vector&lt;dof_id_type&gt; _values_to_scatter;
  dof_id_type &amp; _scatter_value;

  std::vector&lt;dof_id_type&gt; _values_to_gather;
  std::vector&lt;dof_id_type&gt; &amp; _gather_value;

  std::vector&lt;dof_id_type&gt; * _distributed_vector;
};

class TestGetReporter : public GeneralReporter
{
public:
  static InputParameters validParams();
  TestGetReporter(const InputParameters &amp; parameters);
  virtual void initialize() override {}
  virtual void finalize() override {}
  virtual void execute() override;

protected:
  const int &amp; _int; // MooseDocs:consumer
  const int &amp; _int_old;

  const Real &amp; _real;
  const std::vector&lt;Real&gt; &amp; _vector;
  const std::string &amp; _string;
  const Real &amp; _bcast_value;
  const dof_id_type &amp; _scatter_value;
  const std::vector&lt;dof_id_type&gt; &amp; _gather_value;
};

class TestDeclareInitialSetupReporter : public GeneralReporter
{
public:
  static InputParameters validParams();
  TestDeclareInitialSetupReporter(const InputParameters &amp; parameters);
  virtual void initialSetup() override;
  virtual void initialize() override {}
  virtual void finalize() override {}
  virtual void execute() override {}
};

class TestGetReporterDeclaredInInitialSetupReporter : public GeneralReporter
{
public:
  static InputParameters validParams();
  TestGetReporterDeclaredInInitialSetupReporter(const InputParameters &amp; parameters);
  virtual void initialize() override {}
  virtual void finalize() override {}
  virtual void execute() override;

protected:
  const Real &amp; _value_declared_in_initial_setup;
  Real &amp; _the_value_of_the_reporter;
};

class TestDeclareErrorsReporter : public GeneralReporter
{
public:
  static InputParameters validParams();
  TestDeclareErrorsReporter(const InputParameters &amp; parameters);
  virtual void initialize() override {}
  virtual void finalize() override {}
  virtual void execute() override {}
};
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="d8366676-a3df-458b-bd6c-327870979f32"><div class="modal-content"><h4>(moose/test/src/reporters/TestReporter.C)</h4><pre style="max-height:350px;"><code class="language-cpp">// This file is part of the MOOSE framework
// https://mooseframework.inl.gov
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#include &quot;TestReporter.h&quot;

registerMooseObject(&quot;MooseTestApp&quot;, TestDeclareReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestGetReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestDeclareInitialSetupReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestGetReporterDeclaredInInitialSetupReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestDeclareErrorsReporter);

InputParameters
TestDeclareReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  // MooseDocs:param_begin
  params.addParam&lt;ReporterValueName&gt;(&quot;int_name&quot;, &quot;int&quot;, &quot;The name of the integer data&quot;);
  // MooseDocs:param_end
  params.addParam&lt;ReporterValueName&gt;(&quot;distributed_vector_name&quot;, &quot;Distributed vector to produce.&quot;);
  return params;
}

TestDeclareReporter::TestDeclareReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters),
    _int(declareValue&lt;int&gt;(&quot;int_name&quot;, 1980)), // MooseDocs:producer
    _real(declareValueByName&lt;Real&gt;(&quot;real&quot;)),
    _vector(declareValueByName&lt;std::vector&lt;Real&gt;&gt;(&quot;vector&quot;)),
    _string(declareValueByName&lt;std::string&gt;(&quot;string&quot;)),
    _bcast_value(declareValueByName&lt;Real, ReporterBroadcastContext&gt;(&quot;broadcast&quot;)),
    _scatter_value(
        declareValueByName&lt;dof_id_type, ReporterScatterContext&gt;(&quot;scatter&quot;, _values_to_scatter)),
    _gather_value(declareValueByName&lt;std::vector&lt;dof_id_type&gt;, ReporterGatherContext&gt;(
        &quot;gather&quot;)), // MooseDocs:gather
    _distributed_vector(isParamValid(&quot;distributed_vector_name&quot;)
                            ? &amp;declareValue&lt;std::vector&lt;dof_id_type&gt;&gt;(&quot;distributed_vector_name&quot;,
                                                                      REPORTER_MODE_DISTRIBUTED)
                            : nullptr)
{
  if (processor_id() == 0)
    for (dof_id_type rank = 0; rank &lt; n_processors(); ++rank)
      _values_to_scatter.push_back(rank);
}

// MooseDocs:execute_begin
void
TestDeclareReporter::execute()
{
  _int += 1;
  _real = 1.2345;
  _vector = {1, 1.1, 1.2};
  _string = &quot;string&quot;;

  if (processor_id() == 0)
    _bcast_value = 42;

  _gather_value.resize(1, processor_id());

  if (_distributed_vector)
  {
    _distributed_vector-&gt;resize(_vector.size());
    (*_distributed_vector)[0] = processor_id();
    for (unsigned int i = 1; i &lt; _distributed_vector-&gt;size(); ++i)
      (*_distributed_vector)[i] = (*_distributed_vector)[i - 1] * 10;
  }
}
// MooseDocs:execute_end

InputParameters
TestGetReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;ReporterName&gt;(&quot;int_reporter&quot;, &quot;&#x27;int&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;real_reporter&quot;, &quot;&#x27;real&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;vector_reporter&quot;, &quot;&#x27;vector&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;string_reporter&quot;, &quot;&#x27;string&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;broadcast_reporter&quot;, &quot;&#x27;broadcast&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;scatter_reporter&quot;, &quot;&#x27;scatter&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;gather_reporter&quot;, &quot;&#x27;gather&#x27; reporter name&quot;);
  return params;
}

TestGetReporter::TestGetReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters),
    _int(getReporterValue&lt;int&gt;(&quot;int_reporter&quot;)), // MooseDocs:consumer
    _int_old(getReporterValue&lt;int&gt;(&quot;int_reporter&quot;, 1)),
    _real(getReporterValue&lt;Real&gt;(&quot;real_reporter&quot;)),
    _vector(getReporterValue&lt;std::vector&lt;Real&gt;&gt;(&quot;vector_reporter&quot;)),
    _string(getReporterValue&lt;std::string&gt;(&quot;string_reporter&quot;)),
    _bcast_value(getReporterValue&lt;Real&gt;(&quot;broadcast_reporter&quot;)),
    _scatter_value(getReporterValue&lt;dof_id_type&gt;(&quot;scatter_reporter&quot;)),
    _gather_value(getReporterValue&lt;std::vector&lt;dof_id_type&gt;&gt;(&quot;gather_reporter&quot;))
{
}

void
TestGetReporter::execute()
{
  if (_int != 1980 + _t_step)
    mooseError(&quot;int reporter test failed: &quot;, _int, &quot; != &quot;, 1980 + _t_step);
  if (_real != 1.2345)
    mooseError(&quot;Real reporter test failed&quot;);
  if (_vector != std::vector&lt;Real&gt;({1., 1.1, 1.2}))
    mooseError(&quot;std::vector&lt;Real&gt; reporter test failed&quot;);
  if (_string != &quot;string&quot;)
    mooseError(&quot;std::string reporter test failed&quot;);

  if (_t_step == 0 &amp;&amp; _int_old != 1980)
    mooseError(&quot;int_old on timestep 0 failed: &quot;, _int_old, &quot; != &quot;, 1980);
  if (_t_step &gt; 0 &amp;&amp; _int_old != 1980 + (_t_step - 1))
    mooseError(
        &quot;int_old on timestep &quot;, _t_step, &quot; failed: &quot;, _int_old, &quot; != &quot;, 1980 + (_t_step - 1));

  if (_bcast_value != 42)
    mooseError(&quot;Broadcast reporter test failed&quot;);

  if (_scatter_value != processor_id())
    mooseError(&quot;Scatter reporter test failed&quot;);

  if (processor_id() == 0)
  {
    std::vector&lt;dof_id_type&gt; gold;
    for (dof_id_type id = 0; id &lt; n_processors(); ++id)
      gold.push_back(id);
    if (_gather_value != gold)
      mooseError(&quot;Gather reporter test failed!&quot;);
  }
}

InputParameters
TestDeclareInitialSetupReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;Real&gt;(&quot;value&quot;, &quot;The value to report.&quot;);
  return params;
}

TestDeclareInitialSetupReporter::TestDeclareInitialSetupReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters)
{
}

void
TestDeclareInitialSetupReporter::initialSetup()
{
  Real &amp; value = declareValueByName&lt;Real&gt;(&quot;value&quot;);
  value = getParam&lt;Real&gt;(&quot;value&quot;);
}

InputParameters
TestGetReporterDeclaredInInitialSetupReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;ReporterName&gt;(&quot;other_reporter&quot;,
                                        &quot;The reporter name that was declared in initialSetup&quot;);
  return params;
}

TestGetReporterDeclaredInInitialSetupReporter::TestGetReporterDeclaredInInitialSetupReporter(
    const InputParameters &amp; parameters)
  : GeneralReporter(parameters),
    _value_declared_in_initial_setup(getReporterValue&lt;Real&gt;(&quot;other_reporter&quot;)),
    _the_value_of_the_reporter(declareValueByName&lt;Real&gt;(&quot;other_value&quot;))
{
}

void
TestGetReporterDeclaredInInitialSetupReporter::execute()
{
  _the_value_of_the_reporter = _value_declared_in_initial_setup;
}

InputParameters
TestDeclareErrorsReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;ReporterValueName&gt;(&quot;value&quot;, &quot;A reporter value name&quot;);

  params.addParam&lt;bool&gt;(&quot;missing_param&quot;, false, &quot;True to test the error for a missing parameter&quot;);
  params.addParam&lt;bool&gt;(&quot;bad_param&quot;, false, &quot;True to test the error for a bad parameter type&quot;);
  params.addParam&lt;bool&gt;(&quot;already_declared&quot;, false, &quot;Test declaring a value multiple times&quot;);
  params.addParam&lt;bool&gt;(&quot;requested_different_type&quot;,
                        false,
                        &quot;Test declaring a value that has been requested with a differentt type&quot;);

  return params;
}

TestDeclareErrorsReporter::TestDeclareErrorsReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters)
{
  if (getParam&lt;bool&gt;(&quot;missing_param&quot;))
    declareValue&lt;int&gt;(&quot;some_missing_parm&quot;);
  if (getParam&lt;bool&gt;(&quot;bad_param&quot;))
    declareValue&lt;int&gt;(&quot;bad_param&quot;);
  if (getParam&lt;bool&gt;(&quot;already_declared&quot;))
  {
    declareValueByName&lt;int&gt;(&quot;value_name&quot;);
    declareValueByName&lt;Real&gt;(&quot;value_name&quot;);
  }
  if (getParam&lt;bool&gt;(&quot;requested_different_type&quot;))
  {
    getReporterValueByName&lt;int&gt;(name() + &quot;/value_name&quot;);
    declareValueByName&lt;Real&gt;(&quot;value_name&quot;);
  }
}
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="b12aa3f3-f3c0-4e46-9229-cca6b1f9a968"><div class="modal-content"><h4>(moose/test/src/reporters/TestReporter.C)</h4><pre style="max-height:350px;"><code class="language-cpp">// This file is part of the MOOSE framework
// https://mooseframework.inl.gov
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#include &quot;TestReporter.h&quot;

registerMooseObject(&quot;MooseTestApp&quot;, TestDeclareReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestGetReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestDeclareInitialSetupReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestGetReporterDeclaredInInitialSetupReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestDeclareErrorsReporter);

InputParameters
TestDeclareReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  // MooseDocs:param_begin
  params.addParam&lt;ReporterValueName&gt;(&quot;int_name&quot;, &quot;int&quot;, &quot;The name of the integer data&quot;);
  // MooseDocs:param_end
  params.addParam&lt;ReporterValueName&gt;(&quot;distributed_vector_name&quot;, &quot;Distributed vector to produce.&quot;);
  return params;
}

TestDeclareReporter::TestDeclareReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters),
    _int(declareValue&lt;int&gt;(&quot;int_name&quot;, 1980)), // MooseDocs:producer
    _real(declareValueByName&lt;Real&gt;(&quot;real&quot;)),
    _vector(declareValueByName&lt;std::vector&lt;Real&gt;&gt;(&quot;vector&quot;)),
    _string(declareValueByName&lt;std::string&gt;(&quot;string&quot;)),
    _bcast_value(declareValueByName&lt;Real, ReporterBroadcastContext&gt;(&quot;broadcast&quot;)),
    _scatter_value(
        declareValueByName&lt;dof_id_type, ReporterScatterContext&gt;(&quot;scatter&quot;, _values_to_scatter)),
    _gather_value(declareValueByName&lt;std::vector&lt;dof_id_type&gt;, ReporterGatherContext&gt;(
        &quot;gather&quot;)), // MooseDocs:gather
    _distributed_vector(isParamValid(&quot;distributed_vector_name&quot;)
                            ? &amp;declareValue&lt;std::vector&lt;dof_id_type&gt;&gt;(&quot;distributed_vector_name&quot;,
                                                                      REPORTER_MODE_DISTRIBUTED)
                            : nullptr)
{
  if (processor_id() == 0)
    for (dof_id_type rank = 0; rank &lt; n_processors(); ++rank)
      _values_to_scatter.push_back(rank);
}

// MooseDocs:execute_begin
void
TestDeclareReporter::execute()
{
  _int += 1;
  _real = 1.2345;
  _vector = {1, 1.1, 1.2};
  _string = &quot;string&quot;;

  if (processor_id() == 0)
    _bcast_value = 42;

  _gather_value.resize(1, processor_id());

  if (_distributed_vector)
  {
    _distributed_vector-&gt;resize(_vector.size());
    (*_distributed_vector)[0] = processor_id();
    for (unsigned int i = 1; i &lt; _distributed_vector-&gt;size(); ++i)
      (*_distributed_vector)[i] = (*_distributed_vector)[i - 1] * 10;
  }
}
// MooseDocs:execute_end

InputParameters
TestGetReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;ReporterName&gt;(&quot;int_reporter&quot;, &quot;&#x27;int&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;real_reporter&quot;, &quot;&#x27;real&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;vector_reporter&quot;, &quot;&#x27;vector&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;string_reporter&quot;, &quot;&#x27;string&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;broadcast_reporter&quot;, &quot;&#x27;broadcast&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;scatter_reporter&quot;, &quot;&#x27;scatter&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;gather_reporter&quot;, &quot;&#x27;gather&#x27; reporter name&quot;);
  return params;
}

TestGetReporter::TestGetReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters),
    _int(getReporterValue&lt;int&gt;(&quot;int_reporter&quot;)), // MooseDocs:consumer
    _int_old(getReporterValue&lt;int&gt;(&quot;int_reporter&quot;, 1)),
    _real(getReporterValue&lt;Real&gt;(&quot;real_reporter&quot;)),
    _vector(getReporterValue&lt;std::vector&lt;Real&gt;&gt;(&quot;vector_reporter&quot;)),
    _string(getReporterValue&lt;std::string&gt;(&quot;string_reporter&quot;)),
    _bcast_value(getReporterValue&lt;Real&gt;(&quot;broadcast_reporter&quot;)),
    _scatter_value(getReporterValue&lt;dof_id_type&gt;(&quot;scatter_reporter&quot;)),
    _gather_value(getReporterValue&lt;std::vector&lt;dof_id_type&gt;&gt;(&quot;gather_reporter&quot;))
{
}

void
TestGetReporter::execute()
{
  if (_int != 1980 + _t_step)
    mooseError(&quot;int reporter test failed: &quot;, _int, &quot; != &quot;, 1980 + _t_step);
  if (_real != 1.2345)
    mooseError(&quot;Real reporter test failed&quot;);
  if (_vector != std::vector&lt;Real&gt;({1., 1.1, 1.2}))
    mooseError(&quot;std::vector&lt;Real&gt; reporter test failed&quot;);
  if (_string != &quot;string&quot;)
    mooseError(&quot;std::string reporter test failed&quot;);

  if (_t_step == 0 &amp;&amp; _int_old != 1980)
    mooseError(&quot;int_old on timestep 0 failed: &quot;, _int_old, &quot; != &quot;, 1980);
  if (_t_step &gt; 0 &amp;&amp; _int_old != 1980 + (_t_step - 1))
    mooseError(
        &quot;int_old on timestep &quot;, _t_step, &quot; failed: &quot;, _int_old, &quot; != &quot;, 1980 + (_t_step - 1));

  if (_bcast_value != 42)
    mooseError(&quot;Broadcast reporter test failed&quot;);

  if (_scatter_value != processor_id())
    mooseError(&quot;Scatter reporter test failed&quot;);

  if (processor_id() == 0)
  {
    std::vector&lt;dof_id_type&gt; gold;
    for (dof_id_type id = 0; id &lt; n_processors(); ++id)
      gold.push_back(id);
    if (_gather_value != gold)
      mooseError(&quot;Gather reporter test failed!&quot;);
  }
}

InputParameters
TestDeclareInitialSetupReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;Real&gt;(&quot;value&quot;, &quot;The value to report.&quot;);
  return params;
}

TestDeclareInitialSetupReporter::TestDeclareInitialSetupReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters)
{
}

void
TestDeclareInitialSetupReporter::initialSetup()
{
  Real &amp; value = declareValueByName&lt;Real&gt;(&quot;value&quot;);
  value = getParam&lt;Real&gt;(&quot;value&quot;);
}

InputParameters
TestGetReporterDeclaredInInitialSetupReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;ReporterName&gt;(&quot;other_reporter&quot;,
                                        &quot;The reporter name that was declared in initialSetup&quot;);
  return params;
}

TestGetReporterDeclaredInInitialSetupReporter::TestGetReporterDeclaredInInitialSetupReporter(
    const InputParameters &amp; parameters)
  : GeneralReporter(parameters),
    _value_declared_in_initial_setup(getReporterValue&lt;Real&gt;(&quot;other_reporter&quot;)),
    _the_value_of_the_reporter(declareValueByName&lt;Real&gt;(&quot;other_value&quot;))
{
}

void
TestGetReporterDeclaredInInitialSetupReporter::execute()
{
  _the_value_of_the_reporter = _value_declared_in_initial_setup;
}

InputParameters
TestDeclareErrorsReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;ReporterValueName&gt;(&quot;value&quot;, &quot;A reporter value name&quot;);

  params.addParam&lt;bool&gt;(&quot;missing_param&quot;, false, &quot;True to test the error for a missing parameter&quot;);
  params.addParam&lt;bool&gt;(&quot;bad_param&quot;, false, &quot;True to test the error for a bad parameter type&quot;);
  params.addParam&lt;bool&gt;(&quot;already_declared&quot;, false, &quot;Test declaring a value multiple times&quot;);
  params.addParam&lt;bool&gt;(&quot;requested_different_type&quot;,
                        false,
                        &quot;Test declaring a value that has been requested with a differentt type&quot;);

  return params;
}

TestDeclareErrorsReporter::TestDeclareErrorsReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters)
{
  if (getParam&lt;bool&gt;(&quot;missing_param&quot;))
    declareValue&lt;int&gt;(&quot;some_missing_parm&quot;);
  if (getParam&lt;bool&gt;(&quot;bad_param&quot;))
    declareValue&lt;int&gt;(&quot;bad_param&quot;);
  if (getParam&lt;bool&gt;(&quot;already_declared&quot;))
  {
    declareValueByName&lt;int&gt;(&quot;value_name&quot;);
    declareValueByName&lt;Real&gt;(&quot;value_name&quot;);
  }
  if (getParam&lt;bool&gt;(&quot;requested_different_type&quot;))
  {
    getReporterValueByName&lt;int&gt;(name() + &quot;/value_name&quot;);
    declareValueByName&lt;Real&gt;(&quot;value_name&quot;);
  }
}
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="e97a99a8-741e-4748-9d92-97fd55406a10"><div class="modal-content"><h4>(moose/test/tests/reporters/base/base.i)</h4><pre style="max-height:350px;"><code class="language-moose">[Mesh]
  type = GeneratedMesh
  dim = 1
[]

[Variables/u]
[]

[Problem]
  solve = false
  kernel_coverage_check = false
[]

[Reporters]
  [b]
    type = TestGetReporter
    int_reporter = a/int
    real_reporter = a/real
    vector_reporter = a/vector
    string_reporter = a/string
    broadcast_reporter = a/broadcast
    scatter_reporter = a/scatter
    gather_reporter = a/gather
  []
  [a]
    type = TestDeclareReporter
  []
[]

[Executioner]
  type = Transient
  num_steps = 3
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="61653b13-7744-4801-af22-380b4e0f7b47"><div class="modal-content"><h4>(moose/test/src/reporters/TestReporter.C)</h4><pre style="max-height:350px;"><code class="language-cpp">// This file is part of the MOOSE framework
// https://mooseframework.inl.gov
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#include &quot;TestReporter.h&quot;

registerMooseObject(&quot;MooseTestApp&quot;, TestDeclareReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestGetReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestDeclareInitialSetupReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestGetReporterDeclaredInInitialSetupReporter);
registerMooseObject(&quot;MooseTestApp&quot;, TestDeclareErrorsReporter);

InputParameters
TestDeclareReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  // MooseDocs:param_begin
  params.addParam&lt;ReporterValueName&gt;(&quot;int_name&quot;, &quot;int&quot;, &quot;The name of the integer data&quot;);
  // MooseDocs:param_end
  params.addParam&lt;ReporterValueName&gt;(&quot;distributed_vector_name&quot;, &quot;Distributed vector to produce.&quot;);
  return params;
}

TestDeclareReporter::TestDeclareReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters),
    _int(declareValue&lt;int&gt;(&quot;int_name&quot;, 1980)), // MooseDocs:producer
    _real(declareValueByName&lt;Real&gt;(&quot;real&quot;)),
    _vector(declareValueByName&lt;std::vector&lt;Real&gt;&gt;(&quot;vector&quot;)),
    _string(declareValueByName&lt;std::string&gt;(&quot;string&quot;)),
    _bcast_value(declareValueByName&lt;Real, ReporterBroadcastContext&gt;(&quot;broadcast&quot;)),
    _scatter_value(
        declareValueByName&lt;dof_id_type, ReporterScatterContext&gt;(&quot;scatter&quot;, _values_to_scatter)),
    _gather_value(declareValueByName&lt;std::vector&lt;dof_id_type&gt;, ReporterGatherContext&gt;(
        &quot;gather&quot;)), // MooseDocs:gather
    _distributed_vector(isParamValid(&quot;distributed_vector_name&quot;)
                            ? &amp;declareValue&lt;std::vector&lt;dof_id_type&gt;&gt;(&quot;distributed_vector_name&quot;,
                                                                      REPORTER_MODE_DISTRIBUTED)
                            : nullptr)
{
  if (processor_id() == 0)
    for (dof_id_type rank = 0; rank &lt; n_processors(); ++rank)
      _values_to_scatter.push_back(rank);
}

// MooseDocs:execute_begin
void
TestDeclareReporter::execute()
{
  _int += 1;
  _real = 1.2345;
  _vector = {1, 1.1, 1.2};
  _string = &quot;string&quot;;

  if (processor_id() == 0)
    _bcast_value = 42;

  _gather_value.resize(1, processor_id());

  if (_distributed_vector)
  {
    _distributed_vector-&gt;resize(_vector.size());
    (*_distributed_vector)[0] = processor_id();
    for (unsigned int i = 1; i &lt; _distributed_vector-&gt;size(); ++i)
      (*_distributed_vector)[i] = (*_distributed_vector)[i - 1] * 10;
  }
}
// MooseDocs:execute_end

InputParameters
TestGetReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;ReporterName&gt;(&quot;int_reporter&quot;, &quot;&#x27;int&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;real_reporter&quot;, &quot;&#x27;real&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;vector_reporter&quot;, &quot;&#x27;vector&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;string_reporter&quot;, &quot;&#x27;string&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;broadcast_reporter&quot;, &quot;&#x27;broadcast&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;scatter_reporter&quot;, &quot;&#x27;scatter&#x27; reporter name&quot;);
  params.addRequiredParam&lt;ReporterName&gt;(&quot;gather_reporter&quot;, &quot;&#x27;gather&#x27; reporter name&quot;);
  return params;
}

TestGetReporter::TestGetReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters),
    _int(getReporterValue&lt;int&gt;(&quot;int_reporter&quot;)), // MooseDocs:consumer
    _int_old(getReporterValue&lt;int&gt;(&quot;int_reporter&quot;, 1)),
    _real(getReporterValue&lt;Real&gt;(&quot;real_reporter&quot;)),
    _vector(getReporterValue&lt;std::vector&lt;Real&gt;&gt;(&quot;vector_reporter&quot;)),
    _string(getReporterValue&lt;std::string&gt;(&quot;string_reporter&quot;)),
    _bcast_value(getReporterValue&lt;Real&gt;(&quot;broadcast_reporter&quot;)),
    _scatter_value(getReporterValue&lt;dof_id_type&gt;(&quot;scatter_reporter&quot;)),
    _gather_value(getReporterValue&lt;std::vector&lt;dof_id_type&gt;&gt;(&quot;gather_reporter&quot;))
{
}

void
TestGetReporter::execute()
{
  if (_int != 1980 + _t_step)
    mooseError(&quot;int reporter test failed: &quot;, _int, &quot; != &quot;, 1980 + _t_step);
  if (_real != 1.2345)
    mooseError(&quot;Real reporter test failed&quot;);
  if (_vector != std::vector&lt;Real&gt;({1., 1.1, 1.2}))
    mooseError(&quot;std::vector&lt;Real&gt; reporter test failed&quot;);
  if (_string != &quot;string&quot;)
    mooseError(&quot;std::string reporter test failed&quot;);

  if (_t_step == 0 &amp;&amp; _int_old != 1980)
    mooseError(&quot;int_old on timestep 0 failed: &quot;, _int_old, &quot; != &quot;, 1980);
  if (_t_step &gt; 0 &amp;&amp; _int_old != 1980 + (_t_step - 1))
    mooseError(
        &quot;int_old on timestep &quot;, _t_step, &quot; failed: &quot;, _int_old, &quot; != &quot;, 1980 + (_t_step - 1));

  if (_bcast_value != 42)
    mooseError(&quot;Broadcast reporter test failed&quot;);

  if (_scatter_value != processor_id())
    mooseError(&quot;Scatter reporter test failed&quot;);

  if (processor_id() == 0)
  {
    std::vector&lt;dof_id_type&gt; gold;
    for (dof_id_type id = 0; id &lt; n_processors(); ++id)
      gold.push_back(id);
    if (_gather_value != gold)
      mooseError(&quot;Gather reporter test failed!&quot;);
  }
}

InputParameters
TestDeclareInitialSetupReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;Real&gt;(&quot;value&quot;, &quot;The value to report.&quot;);
  return params;
}

TestDeclareInitialSetupReporter::TestDeclareInitialSetupReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters)
{
}

void
TestDeclareInitialSetupReporter::initialSetup()
{
  Real &amp; value = declareValueByName&lt;Real&gt;(&quot;value&quot;);
  value = getParam&lt;Real&gt;(&quot;value&quot;);
}

InputParameters
TestGetReporterDeclaredInInitialSetupReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;ReporterName&gt;(&quot;other_reporter&quot;,
                                        &quot;The reporter name that was declared in initialSetup&quot;);
  return params;
}

TestGetReporterDeclaredInInitialSetupReporter::TestGetReporterDeclaredInInitialSetupReporter(
    const InputParameters &amp; parameters)
  : GeneralReporter(parameters),
    _value_declared_in_initial_setup(getReporterValue&lt;Real&gt;(&quot;other_reporter&quot;)),
    _the_value_of_the_reporter(declareValueByName&lt;Real&gt;(&quot;other_value&quot;))
{
}

void
TestGetReporterDeclaredInInitialSetupReporter::execute()
{
  _the_value_of_the_reporter = _value_declared_in_initial_setup;
}

InputParameters
TestDeclareErrorsReporter::validParams()
{
  InputParameters params = GeneralReporter::validParams();
  params.addRequiredParam&lt;ReporterValueName&gt;(&quot;value&quot;, &quot;A reporter value name&quot;);

  params.addParam&lt;bool&gt;(&quot;missing_param&quot;, false, &quot;True to test the error for a missing parameter&quot;);
  params.addParam&lt;bool&gt;(&quot;bad_param&quot;, false, &quot;True to test the error for a bad parameter type&quot;);
  params.addParam&lt;bool&gt;(&quot;already_declared&quot;, false, &quot;Test declaring a value multiple times&quot;);
  params.addParam&lt;bool&gt;(&quot;requested_different_type&quot;,
                        false,
                        &quot;Test declaring a value that has been requested with a differentt type&quot;);

  return params;
}

TestDeclareErrorsReporter::TestDeclareErrorsReporter(const InputParameters &amp; parameters)
  : GeneralReporter(parameters)
{
  if (getParam&lt;bool&gt;(&quot;missing_param&quot;))
    declareValue&lt;int&gt;(&quot;some_missing_parm&quot;);
  if (getParam&lt;bool&gt;(&quot;bad_param&quot;))
    declareValue&lt;int&gt;(&quot;bad_param&quot;);
  if (getParam&lt;bool&gt;(&quot;already_declared&quot;))
  {
    declareValueByName&lt;int&gt;(&quot;value_name&quot;);
    declareValueByName&lt;Real&gt;(&quot;value_name&quot;);
  }
  if (getParam&lt;bool&gt;(&quot;requested_different_type&quot;))
  {
    getReporterValueByName&lt;int&gt;(name() + &quot;/value_name&quot;);
    declareValueByName&lt;Real&gt;(&quot;value_name&quot;);
  }
}
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="aae9563b-2e09-44c5-927e-9e9f0d2b2a33"><div class="modal-content"><h4>verbose_restore</h4><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Set to True to enable verbose screen printing related to solution restoration</p></div></div></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#f295c32c-b321-4ec4-8e30-0e4a3ace0c8b" class="tooltipped" data-position="left" data-tooltip="Producing Reporter Data">Producing Reporter Data</a></li><li><a href="#d523585e-3f9c-4df2-b07d-33f6590f85fc" class="tooltipped" data-position="left" data-tooltip="Consuming Reporter Data">Consuming Reporter Data</a></li><li><a href="#1bdbd777-cfab-4913-b532-15d9ad1554ee" class="tooltipped" data-position="left" data-tooltip="Outputting Reporter Data">Outputting Reporter Data</a></li><li><a href="#bba7d2fc-e6bf-4327-a2e5-87e7c395d1f3" class="tooltipped" data-position="left" data-tooltip="Reporter Context and Modes">Reporter Context and Modes</a></li><li><a href="#8409251b-acff-4c37-b5cf-e7bd8919c314" class="tooltipped" data-position="left" data-tooltip="Reporter Debug Output">Reporter Debug Output</a></li><li><a href="#0566572f-976d-422a-90f5-d16ffe3bc15d" class="tooltipped" data-position="left" data-tooltip="Restore on Rejected Timesteps">Restore on Rejected Timesteps</a></li><li><a href="#e5c1ee3f-d761-4bb2-b712-42b47199699f" class="tooltipped" data-position="left" data-tooltip="Available Objects">Available Objects</a></li><li><a href="#919cce7e-20aa-4ff4-97b1-618c93fd4086" class="tooltipped" data-position="left" data-tooltip="Available Actions">Available Actions</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script><script type="text/javascript" src="../../js/moose_input_parser.js"></script>