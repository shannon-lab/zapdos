<!DOCTYPE html><head><meta charset="UTF-8"><title>LinearFVKernels System | Zapdos</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/zapdos.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Zapdos</a><a href="https://github.com/shannon-lab/zapdos" class="right"><img src="../../media/framework/github-logo.png" alt="GitHub wordmark" class="github-mark"></img><img src="../../media/framework/github-mark.png" alt="GitHub logo" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="829d0934-6e65-4412-bc85-e6abf842ec44" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="9043e108-cc12-4282-b766-b9e52f1c4039" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="403ff690-c997-4bcb-92cc-18b6054da9ab" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../citing.html">Citing</a></li></ul><a href="#" class="sidenav-trigger" data-target="6b6e58fc-0658-4a17-8468-638d354163c8"><i class="material-icons">menu</i></a><ul class="sidenav" id="6b6e58fc-0658-4a17-8468-638d354163c8"><li><a href="#!" class="dropdown-trigger" data-target="4a79fbc3-1ec2-481e-9f2f-c206d9473966" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="7a8312d3-48d8-4765-bf06-f98170d842c2" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="9c456b3e-bce2-403f-b15a-e38a92a4f7c6" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../citing.html">Citing</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="829d0934-6e65-4412-bc85-e6abf842ec44"><li><a href="../../getting_started/installation.html">Installation</a></li><li><a href="../../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../../getting_started/zapdos_meshing.html">Generating Meshes</a></li><li><a href="../../tutorial/index.html">Tutorial Slides</a></li></ul><ul class="dropdown-content" id="9043e108-cc12-4282-b766-b9e52f1c4039"><li><a href="../zapdos_only.html">Zapdos Input Syntax</a></li><li><a href="../index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../../examples/crane_examples.html">CRANE Examples</a></li><li><a href="../../development/contributing.html">Contributing Guidelines</a></li><li><a href="../../development/code_standards.html">Code Standards</a></li><li><a href="../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="403ff690-c997-4bcb-92cc-18b6054da9ab"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="../../development/zapdos_developer_info.html">Zapdos Developer Information</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul><ul class="dropdown-content" id="4a79fbc3-1ec2-481e-9f2f-c206d9473966"><li><a href="../../getting_started/installation.html">Installation</a></li><li><a href="../../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../../getting_started/zapdos_meshing.html">Generating Meshes</a></li><li><a href="../../tutorial/index.html">Tutorial Slides</a></li></ul><ul class="dropdown-content" id="7a8312d3-48d8-4765-bf06-f98170d842c2"><li><a href="../zapdos_only.html">Zapdos Input Syntax</a></li><li><a href="../index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../../examples/crane_examples.html">CRANE Examples</a></li><li><a href="../../development/contributing.html">Contributing Guidelines</a></li><li><a href="../../development/code_standards.html">Code Standards</a></li><li><a href="../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="9c456b3e-bce2-403f-b15a-e38a92a4f7c6"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="../../development/zapdos_developer_info.html">Zapdos Developer Information</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">syntax</a><a href="." class="breadcrumb">LinearFVKernels</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="8052e870-1e9a-4158-9743-9ed30cefd493" data-section-level="1" data-section-text="LinearFVKernels System"><h1 id="linearfvkernels-system">LinearFVKernels System</h1><p>For the finite volume method (FVM) when used without Newton&#x27;s method, <code>LinearFVKernel</code> is the base class for <code>LinearFVFluxKernel</code> and <code>LinearFVElementalKernel</code>. These specialized objects satisfy the following tasks:</p><p>* <code>LinearFVFluxKernel</code> adds contributions to system matrices and right hand sides coming from flux terms over   the faces between cells and boundaries. Diffusion and advection terms in PDEs serve as good examples   for these kernels.</p><p>* <code>LinearFVElementalKernel</code> adds contributions to system matrices and right hand sides from volumetric integrals.   Volumetric source terms or reaction terms serve as good examples for these kernels.</p><p>For more information on general design choices in this setting <a href="../../finite_volumes/linear_fv_design.html">click here</a></p><section class="scrollspy" id="6e49938f-16e1-413c-8ff2-2f7223932844" data-section-level="2" data-section-text="LinearFVKernels block"><h2 id="linearfvkernels-block">LinearFVKernels block</h2><p>FVM kernels which contribute to systems that are not solved via Newton&#x27;s method are added to simulation input files in the <code>LinearFVKernels</code> block.  The <code>LinearFVKernels</code> block in the example below sets up a steady-state diffusion problem defined by the equation:</p><p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-26c8a06f-6d3b-49a4-ab87-74b171302f4a"></span><script>var element = document.getElementById("moose-equation-26c8a06f-6d3b-49a4-ab87-74b171302f4a");katex.render("  - \\nabla \\cdot D \\nabla u = S.", element, {displayMode:true,throwOnError:false});</script></span></p><p>The diffusion term is represented by the kernel named <code>diffusion</code>.</p><div class="card moose-float"><div class="card-content"><p class="moose-caption"><span class="moose-caption-text">Example of the LinearFVKernels block in a MOOSE input file.</span></p><pre style="max-height:350px;"><code class="language-moose">[LinearFVKernels&lt;&lt;&lt;{&quot;href&quot;: &quot;index.html&quot;}&gt;&gt;&gt;]
  [diffusion]
    type = LinearFVDiffusion&lt;&lt;&lt;{&quot;description&quot;: &quot;Represents the matrix and right hand side contributions of a diffusion term in a partial differential equation.&quot;, &quot;href&quot;: &quot;../../source/linearfvkernels/LinearFVDiffusion.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable whose linear system this object contributes to&quot;}&gt;&gt;&gt; = u
    diffusion_coeff&lt;&lt;&lt;{&quot;description&quot;: &quot;The diffusion coefficient. A functor is any of the following: a variable, a functor material property, a function, a postprocessor or a number.&quot;}&gt;&gt;&gt; = coeff_func
    use_nonorthogonal_correction&lt;&lt;&lt;{&quot;description&quot;: &quot;If the nonorthogonal correction should be used when computing the normal gradient.&quot;}&gt;&gt;&gt; = false
  []
  [source]
    type = LinearFVSource&lt;&lt;&lt;{&quot;description&quot;: &quot;Represents the matrix and right hand side contributions of a solution-independent source term in a partial differential equation.&quot;, &quot;href&quot;: &quot;../../source/linearfvkernels/LinearFVSource.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable whose linear system this object contributes to&quot;}&gt;&gt;&gt; = u
    source_density&lt;&lt;&lt;{&quot;description&quot;: &quot;The source density. A functor is any of the following: a variable, a functor material property, a function, a postprocessor or a number.&quot;}&gt;&gt;&gt; = source_func
  []
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#656d4a21-d00f-4f90-92b1-be2188c487c0">(moose/test/tests/linearfvkernels/diffusion/diffusion-2d.i)</a></div></div><p>The <code>LinearFVSource</code> in the example derives from <code>LinearFVElementalKernel</code> so it&#x27;s a volumetric contribution to the right hand side, while the <code>LinearFVDiffusion</code> is an <code>LinearFVFluxKernel</code> and it&#x27;s a face contribution to the system matrix and right hand side. The remaining MOOSE syntax is what you would expect to see in finite element kernel objects. The <code>variable</code> parameter refers to the variable that this kernel is acting on (i.e. into which equation do the contributions of this term go). This must be a linear finite-volume variable in this case.</p><p>Boundary conditions are not discussed in these examples. We recommend visiting the [LinearFVBCs/index.md) page for details about boundary conditions.</p></section><section class="scrollspy" id="09974e97-ff06-4852-acc6-79617b42a62c" data-section-level="2" data-section-text="Available Objects"><h2 id="available-objects">Available Objects</h2><ul class="moose-syntax-list collection with-header"><li class="collection-header">Moose App</li><li class="collection-item"><a href="../../source/linearfvkernels/LinearFVAdvection.html">LinearFVAdvection</a>Represents the matrix and right hand side contributions of an advection term in a partial differential equation.</li><li class="collection-item"><a href="../../source/linearfvkernels/LinearFVAnisotropicDiffusion.html">LinearFVAnisotropicDiffusion</a>Represents the matrix and right hand side contributions of a diffusion term in a partial differential equation.</li><li class="collection-item"><a href="../../source/linearfvkernels/LinearFVDiffusion.html">LinearFVDiffusion</a>Represents the matrix and right hand side contributions of a diffusion term in a partial differential equation.</li><li class="collection-item"><a href="../../source/linearfvkernels/LinearFVReaction.html">LinearFVReaction</a>Represents the matrix and right hand side contributions of a reaction term (<span class="moose-katex-inline-equation" id="moose-equation-add32278-52fc-457e-a35e-b3cd9305970b"><script>var element = document.getElementById("moose-equation-add32278-52fc-457e-a35e-b3cd9305970b");katex.render("c u", element, {displayMode:false,throwOnError:false});</script></span>) in a partial differential equation.</li><li class="collection-item"><a href="../../source/linearfvkernels/LinearFVSource.html">LinearFVSource</a>Represents the matrix and right hand side contributions of a solution-independent source term in a partial differential equation.</li><li class="collection-item"><a href="../../source/linearfvkernels/LinearFVTimeDerivative.html">LinearFVTimeDerivative</a>Represents the matrix and right hand side contributions of a time derivative term in a partial differential equation.</li></ul></section></section><div class="moose-modal modal" id="656d4a21-d00f-4f90-92b1-be2188c487c0"><div class="modal-content"><h4>(moose/test/tests/linearfvkernels/diffusion/diffusion-2d.i)</h4><pre style="max-height:350px;"><code class="language-moose">[Mesh]
  [gmg]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 2
    ny = 1
    ymax = 0.5
  []
[]

[Problem]
  linear_sys_names = &#x27;u_sys&#x27;
[]

[Variables]
  [u]
    type = MooseLinearVariableFVReal
    solver_sys = &#x27;u_sys&#x27;
    initial_condition = 1.0
  []
[]

[LinearFVKernels]
  [diffusion]
    type = LinearFVDiffusion
    variable = u
    diffusion_coeff = coeff_func
    use_nonorthogonal_correction = false
  []
  [source]
    type = LinearFVSource
    variable = u
    source_density = source_func
  []
[]

[LinearFVBCs]
  [dir]
    type = LinearFVAdvectionDiffusionFunctorDirichletBC
    variable = u
    boundary = &quot;left right top bottom&quot;
    functor = analytic_solution
  []
[]

[Functions]
  [coeff_func]
    type = ParsedFunction
    expression = &#x27;1+0.5*x*y&#x27;
  []
  [source_func]
    type = ParsedFunction
    expression = &#x27;2*(1.5-y*y)+2*x*y*(1.5-y*y)+2*(1.5-x*x)+2*x*y*(1.5-x*x)&#x27;
  []
  [analytic_solution]
    type = ParsedFunction
    expression = &#x27;(1.5-x*x)*(1.5-y*y)&#x27;
  []
[]

[Postprocessors]
  [h]
    type = AverageElementSize
    execute_on = FINAL
  []
  [error]
    type = ElementL2FunctorError
    approximate = u
    exact = analytic_solution
    execute_on = FINAL
  []
[]

[Convergence]
  [linear]
    type = IterationCountConvergence
    max_iterations = 1
    converge_at_max_iterations = true
  []
[]

[Executioner]
  type = Steady
  system_names = u_sys
  l_tol = 1e-10
  multi_system_fixed_point=true
  multi_system_fixed_point_convergence=linear
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  [csv]
    type = CSV
    execute_on = FINAL
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#6e49938f-16e1-413c-8ff2-2f7223932844" class="tooltipped" data-position="left" data-tooltip="LinearFVKernels block">LinearFVKernels block</a></li><li><a href="#09974e97-ff06-4852-acc6-79617b42a62c" class="tooltipped" data-position="left" data-tooltip="Available Objects">Available Objects</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script><script type="text/javascript" src="../../js/moose_input_parser.js"></script>