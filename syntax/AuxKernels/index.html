<!DOCTYPE html><head><meta charset="UTF-8"><title>AuxKernels System | Zapdos</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/zapdos.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Zapdos</a><a href="https://github.com/shannon-lab/zapdos" class="right"><img src="../../media/framework/github-logo.png" alt="GitHub wordmark" class="github-mark"></img><img src="../../media/framework/github-mark.png" alt="GitHub logo" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="531573a5-061f-4ad4-b0eb-8535d425affa" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="6e460009-d38d-4df8-81d2-755b3deeea5d" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="a0dd8a25-95bb-4fdf-af8c-70ec202d091f" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../citing.html">Citing</a></li></ul><a href="#" class="sidenav-trigger" data-target="e5377cc6-15ed-4222-989e-b80b53f27427"><i class="material-icons">menu</i></a><ul class="sidenav" id="e5377cc6-15ed-4222-989e-b80b53f27427"><li><a href="#!" class="dropdown-trigger" data-target="09fcc928-6cbd-4996-ac62-86dcaeaabb76" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="44ba8795-b36c-4a7f-8ea2-c9702972a7fa" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="9ed00769-0e1f-4eea-9114-f84c0bcc3f6e" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../citing.html">Citing</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="531573a5-061f-4ad4-b0eb-8535d425affa"><li><a href="../../getting_started/installation.html">Installation</a></li><li><a href="../../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../../getting_started/zapdos_meshing.html">Generating Meshes</a></li><li><a href="../../tutorial/index.html">Tutorial Slides</a></li></ul><ul class="dropdown-content" id="6e460009-d38d-4df8-81d2-755b3deeea5d"><li><a href="../zapdos_only.html">Zapdos Input Syntax</a></li><li><a href="../index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../../examples/crane_examples.html">CRANE Examples</a></li><li><a href="../../development/contributing.html">Contributing Guidelines</a></li><li><a href="../../development/code_standards.html">Code Standards</a></li><li><a href="../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="a0dd8a25-95bb-4fdf-af8c-70ec202d091f"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="../../development/zapdos_developer_info.html">Zapdos Developer Information</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul><ul class="dropdown-content" id="09fcc928-6cbd-4996-ac62-86dcaeaabb76"><li><a href="../../getting_started/installation.html">Installation</a></li><li><a href="../../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../../getting_started/zapdos_meshing.html">Generating Meshes</a></li><li><a href="../../tutorial/index.html">Tutorial Slides</a></li></ul><ul class="dropdown-content" id="44ba8795-b36c-4a7f-8ea2-c9702972a7fa"><li><a href="../zapdos_only.html">Zapdos Input Syntax</a></li><li><a href="../index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../../examples/crane_examples.html">CRANE Examples</a></li><li><a href="../../development/contributing.html">Contributing Guidelines</a></li><li><a href="../../development/code_standards.html">Code Standards</a></li><li><a href="../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="9ed00769-0e1f-4eea-9114-f84c0bcc3f6e"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="../../development/zapdos_developer_info.html">Zapdos Developer Information</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">syntax</a><a href="." class="breadcrumb">AuxKernels</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="512e633e-82bd-4cd7-bc7b-9448b2dca5ad" data-section-level="1" data-section-text="AuxKernels System"><h1 id="auxkernels-system">AuxKernels System</h1><p>The AuxKernel system mimics the <a href="../Kernels/index.html">Kernels System</a> but compute values that can be defined explicitly with a known function. There are two main use cases for the AuxKernel system: computing a quantity that varies with space and time for postprocessing purposes or for decoupling systems of equations. Examples for both of these use cases shall be discussed further in the following sections.</p><p>Creating a custom AuxKernel object is done by creating a new C++ object that inherits from <code>AuxKernel</code>, <code>VectorAuxKernel</code> or <code>ArrayAuxKernel</code> and overriding the <code>computeValue</code> method, which returns a scalar (<code>Real</code>), vector (<code>RealVectorValue</code>) or a Eigen vector (<code>RealEigenVector</code>) for the three types respectively. A forth type (<code>AuxScalarKernel</code>) also exists, but the syntax for these objects is different and detailed in the <a href="../AuxScalarKernels/index.html">AuxScalarKernels System</a>.</p><p>AuxKernel objects, like Kernel objects, must operate on a variable. Thus, there is a required parameter (&quot;variable&quot;) that indicates the variable that the AuxKernel object is computing. These variables are defined in the <a href="../AuxVariables/index.html">AuxVariables</a> block of the input file. AuxKernel objects derived from <code>AuxKernel</code>, <code>VectorAuxKernel</code> or <code>ArrayAuxKernel</code> operate on standard scalar, vector or array field variables respectively. For example the following input file snippet creates an auxiliary variable suitable for use with an <code>VectorAuxKernel</code>.</p><pre style="max-height:350px;"><code class="language-moose">[AuxVariables&lt;&lt;&lt;{&quot;href&quot;: &quot;../AuxVariables/index.html&quot;}&gt;&gt;&gt;]
  [vec]
    family&lt;&lt;&lt;{&quot;description&quot;: &quot;Specifies the family of FE shape functions to use for this variable&quot;}&gt;&gt;&gt; = LAGRANGE_VEC
    order&lt;&lt;&lt;{&quot;description&quot;: &quot;Specifies the order of the FE shape function to use for this variable (additional orders not listed are allowed)&quot;}&gt;&gt;&gt; = FIRST
  []
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#32e34ccc-d0bc-4a1b-81ae-b64765ef3a60">(moose/test/tests/auxkernels/vector_function_aux/vector_function_aux.i)</a><section class="scrollspy" id="ebbbd26d-8009-44dd-be37-1dcfab1ec209" data-section-level="2" data-section-text="Nodal vs Elemental AuxKernel Objects"><h2 id="nodal-vs-elemental-auxkernel-objects">Nodal vs Elemental AuxKernel Objects</h2><p>There are two flavors of AuxKernel objects: nodal and elemental. The distinction is based on the type of variable that is being operated on by the object. If the variable family is <code>LAGRANGE</code> or <code>LAGRANGE_VEC</code> then the AuxKernel will behave as nodal. If the variable family is <code>MONOMIAL</code> then the AuxKernel will behave as elemental.</p><p>The difference is based on how the <code>computeValue</code> method of the object is called when the kernel is executed. In the nodal case the <code>computeValue</code> method will be executed on each <strong>node</strong> within the finite element mesh and the value returned from the method will directly assign the value of the shape function at that node.</p><p>In the elemental case the <code>computeValue</code> method will be executed on each quadrature point of an <strong>element</strong> of the finite element mesh. The values computed at the quadrature points are used to perform the correct finite element projection automatically and set the values for the degrees of freedom. This is achieved by assembling and solving a <em>local</em> finite element projection problem for each and every element in the domain (or blocks) of interest. Typically, in the elemental case the order of the monomial finite element is set to constant so there is a single DOF per element, but higher monomials are also supported.</p><p>As is evident by the functionality detailed, the distinction between the two arises from the nature of the finite element shape functions. For Lagrange shape functions the DOF values correspond with the nodes, while for elemental shape functions the DOF values are not associated with nodes.</p><p>The same AuxKernel object can be designed work both as elemental or nodal, for example the <code>computeValue</code> method for the <a href="../../source/auxkernels/FunctionAux.html">FunctionAux</a> object properly handles using the correct spatial location based on if the object is nodal or elemental with the <code>isNodal</code> method.</p></section><section class="scrollspy" id="e0ad3b05-351f-4cb5-b815-76d17de897b6" data-section-level="2" data-section-text="Block vs Boundary Restricted AuxKernel Objects"><h2 id="block-vs-boundary-restricted-auxkernel-objects">Block vs Boundary Restricted AuxKernel Objects</h2><p>While auxiliary variables are always defined on mesh subdomains, MOOSE allows auxiliary kernels to be either block (mesh subdomain) or boundary restricted. When an auxiliary kernel is boundary restricted, it evaluates an auxiliary variable only on the designated boundaries. Because of this, the auxiliary variable will only have meaningful values on the boundaries even though it is defined on mesh subdomains. When an auxiliary kernel is block restricted, the variable that it evaluates must be defined on a subdomain covering the blocks where the auxiliary kernel is defined. When an auxiliary kernel is boundary restricted, the variable must be defined on a subdomain that all the sides on the boundaries are connected with. An elemental auxiliary variable defined on an element that has multiple boundary sides cannot be properly evaluated within a boundary restricted auxiliary kernel because elemental auxiliary variables can only store one value per element. Users can split the boundaries and define multiple elemental auxiliary variables for each split to avoid the situation of element connecting with multiple boundary sides.</p><pre style="max-height:350px;"><code class="language-cpp">Real
FunctionAux::computeValue()
{
  if (isNodal())
    return _func.value(_t, *_current_node);
  else
    return _func.value(_t, _q_point[_qp]);
}
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#1367138a-7d65-4eca-bc59-c8931049db9d">(moose/framework/src/auxkernels/FunctionAux.C)</a><p>Nodal AuxKernel objects abuse the notion of quadrature points, the <code>_qp</code> member variable is set to zero, but still must be used to access coupled variable values and material properties. This is done to allow the syntax to be consistent regardless of the AuxKernel flavor: nodal or elemental.</p></section><section class="scrollspy" id="03f72ca0-674e-4b56-a3b0-61a378f10462" data-section-level="2" data-section-text="Mortar Nodal Auxiliary Kernel Objects"><h2 id="mortar-nodal-auxiliary-kernel-objects">Mortar Nodal Auxiliary Kernel Objects</h2><p>In order to compute properties in the mortar sense, it is necessary to loop over the mortar segment mesh to spatially integrate variables. <code>MortarNodalAuxKernel</code>s offer this functionality where these &quot;weighted&quot; variables, which intervene in the computation of contact constraints and their residuals, can be coupled to generate the desired output value. Therefore, if postprocessing of mortar quantities is required, nodal mortar auxiliary kernels can be employed. Objects inheriting from <code>MortarNodalAuxKernel</code> allow for said operations on the mortar lower-dimensional domains featuring similar functionality to other nodal auxiliary kernels, including the possibility of computing quantities in an <code>incremental</code> manner.</p></section><section class="scrollspy" id="d07fbc5f-dd17-4082-a204-c0d29975cf28" data-section-level="2" data-section-text="Execute Flags"><h2 id="execute-flags">Execute Flags</h2><p>AuxKernel objects inherit from the <a href="../../source/interfaces/SetupInterface.html">SetupInterface</a> so they include the &quot;execute_on&quot; variable. By default this parameter is set to <code>EXEC_LINEAR</code> and <code>EXEC_TIMESTEP_END</code>. The <code>EXEC_LINEAR</code> flag is set because it is possible to couple values compute by an AuxKernel object to other objects such as Kernel or Material objects that are used in the residual calculation. In order to ensure that the values from the auxiliary variable are correct during the iterative solve they are computed for each iteration.</p><p>However, if the auxiliary variable be computed is not being coupled to objects computing the residual evaluating the AuxKernel on each linear iteration is not necessary and can slow down the execution of a simulation. In this case, the <code>EXEC_LINEAR</code> flag should be removed. Likely the <code>EXEC_INITIAL</code> flag should be added to perform the auxiliary variable calculation during the initial setup phase as well.</p></section><section class="scrollspy" id="166bc989-5feb-4a75-883b-097ae8bce09e" data-section-level="2" data-section-text="Populating lower - dimensional auxiliary variables"><h2 id="populating-lower-dimensional-auxiliary-variables">Populating lower-dimensional auxiliary variables</h2><p>Lower-dimensional auxiliary variables may be populated using boundary restricted auxiliary kernels. The boundary restriction of the aux kernel should be coincident with (a subset of) the lower-dimensional blocks that the lower-dimensional variable lives on. Using a boundary restricted auxiliary kernel as opposed to a lower-d block-restricted auxiliary kernel allows pulling in coincident face evaluations of higher-dimensional variables and material properties as well as evaluations of coupled lower-dimensional variables.</p></section><section class="scrollspy" id="f22ebc3d-acc8-4c5b-8ffd-f21dcb59dc30" data-section-level="2" data-section-text="Example A : Post processing with AuxKernel"><h2 id="example-a-post-processing-with-auxkernel">Example A: Post processing with AuxKernel</h2><p>The following example is extracted from step 4 of the Darcy Flow and Thermomechanics Tutorial. Consider Darcy&#x27;s Law for flow in porous media neglecting changes in time and gravity:</p><p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-e9833081-b0be-4edf-bb4f-f437dd0cff04"></span><span class="moose-katex-equation-number">(1)</span><script>var element = document.getElementById("moose-equation-e9833081-b0be-4edf-bb4f-f437dd0cff04");katex.render(" -\\nabla\\cdot\\frac{\\mathbf{K}}{\\mu}\\nabla p = 0,", element, {displayMode:true,throwOnError:false});</script></span> where <span class="moose-katex-inline-equation" id="moose-equation-284d6bc0-a625-4c1b-a483-32ef8fa9f0eb"><script>var element = document.getElementById("moose-equation-284d6bc0-a625-4c1b-a483-32ef8fa9f0eb");katex.render("\\mathbf{K}", element, {displayMode:false,throwOnError:false});</script></span> is the permeability tensor, <span class="moose-katex-inline-equation" id="moose-equation-1857118f-21a7-4703-bb8e-3bf8ca771553"><script>var element = document.getElementById("moose-equation-1857118f-21a7-4703-bb8e-3bf8ca771553");katex.render("\\mu", element, {displayMode:false,throwOnError:false});</script></span> is the fluid viscosity, and <span class="moose-katex-inline-equation" id="moose-equation-af5a1ced-8511-4d81-9f95-cfc40006d2c9"><script>var element = document.getElementById("moose-equation-af5a1ced-8511-4d81-9f95-cfc40006d2c9");katex.render("p", element, {displayMode:false,throwOnError:false});</script></span> is the pressure and the velocity (<span class="moose-katex-inline-equation" id="moose-equation-61d1b3ac-89dc-44a5-925f-08e0d83fd120"><script>var element = document.getElementById("moose-equation-61d1b3ac-89dc-44a5-925f-08e0d83fd120");katex.render("\\vec{u}", element, {displayMode:false,throwOnError:false});</script></span>) may be computed as:</p><p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-dec302f6-1365-4f5c-8a11-43068825210f"></span><span class="moose-katex-equation-number">(2)</span><script>var element = document.getElementById("moose-equation-dec302f6-1365-4f5c-8a11-43068825210f");katex.render(" \\vec{u} = \\frac{\\mathbf{K}}{\\mu}\\nabla p.", element, {displayMode:true,throwOnError:false});</script></span></p><p>The left-hand side of <a href="#moose-equation-e9833081-b0be-4edf-bb4f-f437dd0cff04">Eq. (1)</a> would be solved with a nonlinear variable and an appropriate <a href="../Kernels/index.html">Kernel object</a>. The AuxKernel system can be used computing the velocity following <a href="#moose-equation-dec302f6-1365-4f5c-8a11-43068825210f">Eq. (2)</a>. In the tutorial the exact calculation is performed using the DarcyVelocity object, the header and source files for this object are listed below.</p><pre style="max-height:350px;"><code class="language-cpp">
#pragma once

#include &quot;AuxKernel.h&quot;

/**
 * Auxiliary kernel responsible for computing the Darcy velocity given
 * several fluid properties and the pressure gradient.
 */
class DarcyVelocity : public VectorAuxKernel
{
public:
  static InputParameters validParams();

  DarcyVelocity(const InputParameters &amp; parameters);

protected:
  /**
   * AuxKernels MUST override computeValue.  computeValue() is called on
   * every quadrature point.  For Nodal Auxiliary variables those quadrature
   * points coincide with the nodes.
   */
  virtual RealVectorValue computeValue() override;

  /// The gradient of a coupled variable
  const VariableGradient &amp; _pressure_gradient;

  /// Holds the permeability and viscosity from the material system
  const ADMaterialProperty&lt;Real&gt; &amp; _permeability;
  const ADMaterialProperty&lt;Real&gt; &amp; _viscosity;
};
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#b23a4d17-23f8-413a-b0c8-67f003b558f0">(moose/tutorials/darcy_thermo_mech/step04_velocity_aux/include/auxkernels/DarcyVelocity.h)</a><pre style="max-height:350px;"><code class="language-cpp">
#include &quot;DarcyVelocity.h&quot;

#include &quot;metaphysicl/raw_type.h&quot;

registerMooseObject(&quot;DarcyThermoMechApp&quot;, DarcyVelocity);

InputParameters
DarcyVelocity::validParams()
{
  InputParameters params = VectorAuxKernel::validParams();

  // Add a &quot;coupling paramater&quot; to get a variable from the input file.
  params.addRequiredCoupledVar(&quot;pressure&quot;, &quot;The pressure field.&quot;);

  return params;
}

DarcyVelocity::DarcyVelocity(const InputParameters &amp; parameters)
  : VectorAuxKernel(parameters),

    // Get the gradient of the variable
    _pressure_gradient(coupledGradient(&quot;pressure&quot;)),

    // Set reference to the permeability MaterialProperty.
    // Only AuxKernels operating on Elemental Auxiliary Variables can do this
    _permeability(getADMaterialProperty&lt;Real&gt;(&quot;permeability&quot;)),

    // Set reference to the viscosity MaterialProperty.
    // Only AuxKernels operating on Elemental Auxiliary Variables can do this
    _viscosity(getADMaterialProperty&lt;Real&gt;(&quot;viscosity&quot;))
{
}

RealVectorValue
DarcyVelocity::computeValue()
{
  // Access the gradient of the pressure at this quadrature point, then pull out the &quot;component&quot; of
  // it requested (x, y or z). Note, that getting a particular component of a gradient is done using
  // the parenthesis operator.
  return -MetaPhysicL::raw_value(_permeability[_qp] / _viscosity[_qp]) * _pressure_gradient[_qp];
}
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#c4124a04-950a-44ad-b5d7-728e4e003d88">(moose/tutorials/darcy_thermo_mech/step04_velocity_aux/src/auxkernels/DarcyVelocity.C)</a></section><section class="scrollspy" id="9242ede5-bac2-46d0-ae37-819a60b691af" data-section-level="2" data-section-text="Example B : Decoupling Equations"><h2 id="example-b-decoupling-equations">Example B: Decoupling Equations</h2><p>Auxiliary variables may be used interchangeably with nonlinear variables with respect to coupling allowing complicated systems of equations to be decoupled for solving individually. This is very useful for testing and validation.</p><p>Consider the heat equation with an advective term that is coupled to the pressure computed in <a href="#moose-equation-e9833081-b0be-4edf-bb4f-f437dd0cff04">Eq. (1)</a> as in step 6 of the Darcy Flow and Thermomechanics Tutorial:</p><p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-92ff830d-68bc-4206-aec3-7a81154cc746"></span><span class="moose-katex-equation-number">(3)</span><script>var element = document.getElementById("moose-equation-92ff830d-68bc-4206-aec3-7a81154cc746");katex.render(" C\\left( \\frac{\\partial T}{\\partial t} + \\epsilon \\vec{u}\\cdot\\nabla T \\right) - \\nabla \\cdot k \\nabla T = 0,", element, {displayMode:true,throwOnError:false});</script></span> where <span class="moose-katex-inline-equation" id="moose-equation-30610a65-6637-44f4-bf4b-ad1808d56551"><script>var element = document.getElementById("moose-equation-30610a65-6637-44f4-bf4b-ad1808d56551");katex.render("T", element, {displayMode:false,throwOnError:false});</script></span> is temperature, <span class="moose-katex-inline-equation" id="moose-equation-b98c0329-f49c-4818-83be-abdb37361350"><script>var element = document.getElementById("moose-equation-b98c0329-f49c-4818-83be-abdb37361350");katex.render("C", element, {displayMode:false,throwOnError:false});</script></span> is the heat capacity, <span class="moose-katex-inline-equation" id="moose-equation-fa46d26b-a7b8-455b-99ca-cc21c9cc6930"><script>var element = document.getElementById("moose-equation-fa46d26b-a7b8-455b-99ca-cc21c9cc6930");katex.render("k", element, {displayMode:false,throwOnError:false});</script></span> is the thermal conductivity, and <span class="moose-katex-inline-equation" id="moose-equation-89eda385-e711-4660-969e-9c5214dda109"><script>var element = document.getElementById("moose-equation-89eda385-e711-4660-969e-9c5214dda109");katex.render("\\epsilon", element, {displayMode:false,throwOnError:false});</script></span> is the porosity. The advective term (<span class="moose-katex-inline-equation" id="moose-equation-45606ca1-73b4-4f27-ad17-2c8800e4d33c"><script>var element = document.getElementById("moose-equation-45606ca1-73b4-4f27-ad17-2c8800e4d33c");katex.render("\\epsilon\\vec{u}\\cdot\\nabla T", element, {displayMode:false,throwOnError:false});</script></span>) is computed in a kernel object (<a class="moose-source-filename tooltipped modal-trigger" href="#260f7344-c952-43a2-b1c4-944091413ada">(moose/tutorials/darcy_thermo_mech/step06_coupled_darcy_heat_conduction/src/kernels/DarcyAdvection.C)</a>) and requires the pressure variable be provided as a variable:</p><pre style="max-height:350px;"><code class="language-cpp">  params.addRequiredCoupledVar(&quot;pressure&quot;, &quot;The variable representing the pressure.&quot;);
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#de6f1b95-20b6-4560-88cd-1ac769cf65cd">(moose/tutorials/darcy_thermo_mech/step06_coupled_darcy_heat_conduction/src/kernels/DarcyAdvection.C)</a><p>For testing purposes is it not desirable to include the solve for the pressure variable when examining the correctness of the heat equation solve, so an auxiliary variable that is assigned an arbitrary function of space and time is used instead. The following input file snippet demonstrates the decoupling of the pressure variable by computing it using an AuxVariable the FunctionAux object.</p><pre style="max-height:350px;"><code class="language-moose">[AuxVariables&lt;&lt;&lt;{&quot;href&quot;: &quot;../AuxVariables/index.html&quot;}&gt;&gt;&gt;]
  [pressure]
  []
[]

[AuxKernels&lt;&lt;&lt;{&quot;href&quot;: &quot;index.html&quot;}&gt;&gt;&gt;]
  [pressure]
    type = FunctionAux&lt;&lt;&lt;{&quot;description&quot;: &quot;Auxiliary Kernel that creates and updates a field variable by sampling a function through space and time.&quot;, &quot;href&quot;: &quot;../../source/auxkernels/FunctionAux.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this object applies to&quot;}&gt;&gt;&gt; = pressure
    function&lt;&lt;&lt;{&quot;description&quot;: &quot;The function to use as the value&quot;}&gt;&gt;&gt; = &#x27;4000 - 3000 * x - 3000 * t*x*x*y&#x27;
    execute_on&lt;&lt;&lt;{&quot;description&quot;: &quot;The list of flag(s) indicating when this object should be executed. For a description of each flag, see https://mooseframework.inl.gov/source/interfaces/SetupInterface.html.&quot;}&gt;&gt;&gt; = timestep_end
  []
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#6fb9e621-4c02-4deb-8407-82c8a9c8ab6c">(moose/tutorials/darcy_thermo_mech/step06_coupled_darcy_heat_conduction/problems/step6c_decoupled.i)</a></section><section class="scrollspy" id="7885a092-73bc-473c-b7b2-9793b3659070" data-section-level="2" data-section-text="Available Objects"><h2 id="available-objects">Available Objects</h2><ul class="moose-syntax-list collection with-header"><li class="collection-header">Moose App</li><li class="collection-item"><a href="../../source/auxkernels/DivergenceAux.html">ADDivergenceAux</a>Computes the divergence of a vector of functors.</li><li class="collection-item"><a href="../../source/auxkernels/FunctorAux.html">ADFunctorElementalAux</a>Evaluates a functor (variable, function or functor material property) on the current element, quadrature point, or node.</li><li class="collection-item"><a href="../../source/auxkernels/FunctorElementalGradientAux.html">ADFunctorElementalGradientAux</a>Evaluates the gradient of a functor (variable, function or functor material property) on the current element or quadrature point.</li><li class="collection-item"><a href="../../source/auxkernels/MaterialRealAux.html">ADFunctorMaterialRealAux</a>Outputs element volume-averaged material properties</li><li class="collection-item"><a href="../../source/auxkernels/MaterialRealVectorValueAux.html">ADFunctorMaterialRealVectorValueAux</a>Capture a component of a vector material property in an auxiliary variable.</li><li class="collection-item"><a href="../../source/auxkernels/FunctorVectorElementalAux.html">ADFunctorVectorElementalAux</a>Evaluates a vector functor (material property usually) on the current element.For finite volume, this evaluates the vector functor at the centroid.</li><li class="collection-item"><a href="../../source/auxkernels/MaterialRankFourTensorAux.html">ADMaterialRankFourTensorAux</a>Access a component of a RankFourTensor for automatic material property output</li><li class="collection-item"><a href="../../source/auxkernels/MaterialRankTwoTensorAux.html">ADMaterialRankTwoTensorAux</a>Access a component of a RankTwoTensor for automatic material property output</li><li class="collection-item"><a href="../../source/auxkernels/MaterialRateRealAux.html">ADMaterialRateRealAux</a>Outputs element material properties rate of change</li><li class="collection-item"><a href="../../source/auxkernels/MaterialRealAux.html">ADMaterialRealAux</a>Outputs element volume-averaged material properties</li><li class="collection-item"><a href="../../source/auxkernels/MaterialRealTensorValueAux.html">ADMaterialRealTensorValueAux</a>Object for extracting a component of a rank two tensor material property to populate an auxiliary variable.</li><li class="collection-item"><a href="../../source/auxkernels/MaterialRealVectorValueAux.html">ADMaterialRealVectorValueAux</a>Capture a component of a vector material property in an auxiliary variable.</li><li class="collection-item"><a href="../../source/auxkernels/MaterialStdVectorAux.html">ADMaterialStdVectorAux</a>Extracts a component of a material type std::vector&lt;Real&gt; to an aux variable.  If the std::vector is not of sufficient size then zero is returned</li><li class="collection-item"><a href="../../source/auxkernels/MaterialRankTwoTensorAux.html">ADMaterialSymmetricRankFourTensorAux</a>Access a component of a RankTwoTensor for automatic material property output</li><li class="collection-item"><a href="../../source/auxkernels/MaterialRealVectorValueAux.html">ADMaterialSymmetricRankTwoTensorAux</a>Capture a component of a vector material property in an auxiliary variable.</li><li class="collection-item"><a href="../../source/auxkernels/ProjectedStatefulMaterialAux.html">ADProjectedStatefulMaterialRankFourTensorAux</a>Picks a component of an indexable material property to get projected on an elemental Auxvariable. For use by ProjectedStatefulMaterialStorageAction.</li><li class="collection-item"><a href="../../source/auxkernels/ProjectedStatefulMaterialAux.html">ADProjectedStatefulMaterialRankTwoTensorAux</a>Picks a component of an indexable material property to get projected on an elemental Auxvariable. For use by ProjectedStatefulMaterialStorageAction.</li><li class="collection-item"><a href="../../source/auxkernels/ProjectedStatefulMaterialAux.html">ADProjectedStatefulMaterialRealAux</a>Picks a component of an indexable material property to get projected on an elemental Auxvariable. For use by ProjectedStatefulMaterialStorageAction.</li><li class="collection-item"><a href="../../source/auxkernels/ProjectedStatefulMaterialAux.html">ADProjectedStatefulMaterialRealVectorValueAux</a>Picks a component of an indexable material property to get projected on an elemental Auxvariable. For use by ProjectedStatefulMaterialStorageAction.</li><li class="collection-item"><a href="../../source/auxkernels/VectorMaterialRealVectorValueAux.html">ADVectorMaterialRealVectorValueAux</a>Converts a vector-quantity material property into a vector auxiliary variable</li><li class="collection-item"><a href="../../source/auxkernels/AdvectiveFluxAux.html">AdvectiveFluxAux</a>Compute components of flux vector for advection problems <span class="moose-katex-inline-equation" id="moose-equation-47501523-1343-4b16-ad67-a16ee8ec2f8f"><script>var element = document.getElementById("moose-equation-47501523-1343-4b16-ad67-a16ee8ec2f8f");katex.render("(\\vec{J} \\cdot \\vec{n} = \\vec{v} u \\cdot \\vec{n})", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/auxkernels/ArrayParsedAux.html">ArrayParsedAux</a>Sets field array variable values to the evaluation of a parsed expression.</li><li class="collection-item"><a href="../../source/auxkernels/ArrayVarReductionAux.html">ArrayVarReductionAux</a>Takes an array variable and performs a reduction operation on it (max, min, sum, average) and stores as a standard variable.</li><li class="collection-item"><a href="../../source/auxkernels/ArrayVariableComponent.html">ArrayVariableComponent</a>Copy a component of an array variable.</li><li class="collection-item"><a href="../../source/auxkernels/BuildArrayVariableAux.html">BuildArrayVariableAux</a>Combines multiple standard variables into an array variable.</li><li class="collection-item"><a href="../../source/auxkernels/ConstantAux.html">ConstantAux</a>Creates a constant field in the domain.</li><li class="collection-item"><a href="../../source/auxkernels/ContainsPointAux.html">ContainsPointAux</a>Computes a binary field where the field is 1 in the elements that contain the point  and 0 everywhere else</li><li class="collection-item"><a href="../../source/auxkernels/CopyValueAux.html">CopyValueAux</a>Returns the specified variable as an auxiliary variable with a simple copy of the variable values.</li><li class="collection-item"><a href="../../source/auxkernels/DebugResidualAux.html">DebugResidualAux</a>Populate an auxiliary variable with the residual contribution of a variable.</li><li class="collection-item"><a href="../../source/auxkernels/DiffusionFluxAux.html">DiffusionFluxAux</a>Compute components of flux vector for diffusion problems <span class="moose-katex-inline-equation" id="moose-equation-24be9b81-3e87-4bb1-8239-7d8f2c0b42bf"><script>var element = document.getElementById("moose-equation-24be9b81-3e87-4bb1-8239-7d8f2c0b42bf");katex.render("(\\vec{J} = -D \\nabla C)", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/auxkernels/DivergenceAux.html">DivergenceAux</a>Computes the divergence of a vector of functors.</li><li class="collection-item"><a href="../../source/auxkernels/ExtraElementIDAux.html">ElemExtraIDAux</a>Puts element extra IDs into an aux variable.</li><li class="collection-item"><a href="../../source/auxkernels/ElementAdaptivityLevelAux.html">ElementAdaptivityLevelAux</a>stores the element hierarchy in a aux variable</li><li class="collection-item"><a href="../../source/auxkernels/ElementH1ErrorFunctionAux.html">ElementH1ErrorFunctionAux</a>Computes the H1 or W^{1,p} error between an exact function and a coupled variable.</li><li class="collection-item"><a href="../../source/auxkernels/ElementIntegerAux.html">ElementIntegerAux</a>Creates a field showing the element integer.</li><li class="collection-item"><a href="../../source/auxkernels/ElementL2ErrorFunctionAux.html">ElementL2ErrorFunctionAux</a>A class for computing the element-wise L^2 (Euclidean) error between a function and a coupled variable.</li><li class="collection-item"><a href="../../source/auxkernels/ElementLengthAux.html">ElementLengthAux</a>Compute the element size using Elem::hmin() or Elem::hmax() from libMesh.</li><li class="collection-item"><a href="../../source/auxkernels/ElementLpNormAux.html">ElementLpNormAux</a>Compute an elemental field variable (single value per element) equal to the Lp-norm of a coupled Variable.</li><li class="collection-item"><a href="../../source/auxkernels/ElementQualityAux.html">ElementQualityAux</a>Generates a field containing the quality metric for each element.  Useful for visualizing mesh quality.</li><li class="collection-item"><a href="../../source/auxkernels/ElementUOAux.html">ElementUOAux</a>Aux Kernel to display generic spatial (elemental) information from a UserObject that satisfies the underlying ElementUOProvider interface.</li><li class="collection-item"><a href="../../source/auxkernels/ExtraElementIDAux.html">ExtraElementIDAux</a>Puts element extra IDs into an aux variable.</li><li class="collection-item"><a href="../../source/auxkernels/ForcingFunctionAux.html">ForcingFunctionAux</a>Auxiliary Kernel that adds a forcing function to the value of an AuxVariable from the previous time step.</li><li class="collection-item"><a href="../../source/auxkernels/FunctionArrayAux.html">FunctionArrayAux</a>Auxiliary Kernel that creates and updates an array field variable by sampling functions through space and time.</li><li class="collection-item"><a href="../../source/auxkernels/FunctionAux.html">FunctionAux</a>Auxiliary Kernel that creates and updates a field variable by sampling a function through space and time.</li><li class="collection-item"><a href="../../source/auxkernels/FunctorAux.html">FunctorAux</a>Evaluates a functor (variable, function or functor material property) on the current element, quadrature point, or node.</li><li class="collection-item"><a href="../../source/auxkernels/FunctorCoordinatesFunctionAux.html">FunctorCoordinatesFunctionAux</a>Auxiliary Kernel that creates and updates a field variable by sampling a function with functors (variables, functions, others) as the coordinates.</li><li class="collection-item"><a href="../../source/auxkernels/FunctorAux.html">FunctorElementalAux</a>Evaluates a functor (variable, function or functor material property) on the current element, quadrature point, or node.</li><li class="collection-item"><a href="../../source/auxkernels/FunctorElementalGradientAux.html">FunctorElementalGradientAux</a>Evaluates the gradient of a functor (variable, function or functor material property) on the current element or quadrature point.</li><li class="collection-item"><a href="../../source/auxkernels/MaterialRealAux.html">FunctorMaterialRealAux</a>Outputs element volume-averaged material properties</li><li class="collection-item"><a href="../../source/auxkernels/MaterialRealVectorValueAux.html">FunctorMaterialRealVectorValueAux</a>Capture a component of a vector material property in an auxiliary variable.</li><li class="collection-item"><a href="../../source/auxkernels/FunctorVectorElementalAux.html">FunctorVectorElementalAux</a>Evaluates a vector functor (material property usually) on the current element.For finite volume, this evaluates the vector functor at the centroid.</li><li class="collection-item"><a href="../../source/auxkernels/GapValueAux.html">GapValueAux</a>Return the nearest value of a variable on a boundary from across a gap.</li><li class="collection-item"><a href="../../source/auxkernels/GhostingFromUOAux.html">GhostingAux</a>Colors the elements ghosted to the chosen PID.</li><li class="collection-item"><a href="../../source/auxkernels/GhostingFromUOAux.html">GhostingFromUOAux</a>Colors the elements ghosted to the chosen PID.</li><li class="collection-item"><a href="../../source/auxkernels/HardwareIDAux.html">HardwareIDAux</a>Creates a field showing the assignment of partitions to physical nodes in the cluster.</li><li class="collection-item"><a href="../../source/auxkernels/InterfaceValueUserObjectAux.html">InterfaceValueUserObjectAux</a>Get stored value from the specified InterfaceQpUserObjectBase.</li><li class="collection-item"><a href="../../source/auxkernels/MaterialRankFourTensorAux.html">MaterialRankFourTensorAux</a>Access a component of a RankFourTensor for automatic material property output</li><li class="collection-item"><a href="../../source/auxkernels/MaterialRankTwoTensorAux.html">MaterialRankTwoTensorAux</a>Access a component of a RankTwoTensor for automatic material property output</li><li class="collection-item"><a href="../../source/auxkernels/MaterialRateRealAux.html">MaterialRateRealAux</a>Outputs element material properties rate of change</li><li class="collection-item"><a href="../../source/auxkernels/MaterialRealAux.html">MaterialRealAux</a>Outputs element volume-averaged material properties</li><li class="collection-item"><a href="../../source/auxkernels/MaterialRealDenseMatrixAux.html">MaterialRealDenseMatrixAux</a>Populate an auxiliary variable with an entry from a dense matrix material property.</li><li class="collection-item"><a href="../../source/auxkernels/MaterialRealTensorValueAux.html">MaterialRealTensorValueAux</a>Object for extracting a component of a rank two tensor material property to populate an auxiliary variable.</li><li class="collection-item"><a href="../../source/auxkernels/MaterialRealVectorValueAux.html">MaterialRealVectorValueAux</a>Capture a component of a vector material property in an auxiliary variable.</li><li class="collection-item"><a href="../../source/auxkernels/MaterialStdVectorAux.html">MaterialStdVectorAux</a>Extracts a component of a material type std::vector&lt;Real&gt; to an aux variable.  If the std::vector is not of sufficient size then zero is returned</li><li class="collection-item"><a href="../../source/auxkernels/MaterialStdVectorRealGradientAux.html">MaterialStdVectorRealGradientAux</a>Extracts a component of a material&#x27;s std::vector&lt;RealGradient&gt; to an aux variable.  If the std::vector is not of sufficient size then zero is returned</li><li class="collection-item"><a href="../../source/auxkernels/MaterialRankTwoTensorAux.html">MaterialSymmetricRankFourTensorAux</a>Access a component of a RankTwoTensor for automatic material property output</li><li class="collection-item"><a href="../../source/auxkernels/MaterialRealVectorValueAux.html">MaterialSymmetricRankTwoTensorAux</a>Capture a component of a vector material property in an auxiliary variable.</li><li class="collection-item"><a href="../../source/auxkernels/MeshDivisionAux.html">MeshDivisionAux</a>Returns the value of the mesh division index for each element / node</li><li class="collection-item"><a href="../../source/auxkernels/NearestNodeDistanceAux.html">NearestNodeDistanceAux</a>Stores the distance between a block and boundary or between two boundaries.</li><li class="collection-item"><a href="../../source/auxkernels/NearestNodeValueAux.html">NearestNodeValueAux</a>Retrieves a field value from the closest node on the paired boundary and stores it on this boundary or block.</li><li class="collection-item"><a href="../../source/auxkernels/NodalPatchRecoveryAux.html">NodalPatchRecoveryAux</a>This Auxkernel solves a least squares problem at each node to fit a value from quantities defined on quadrature points.</li><li class="collection-item"><a href="../../source/auxkernels/NormalizationAux.html">NormalizationAux</a>Normalizes a variable based on a Postprocessor value.</li><li class="collection-item"><a href="../../source/auxkernels/ParsedAux.html">ParsedAux</a>Sets a field variable value to the evaluation of a parsed expression.</li><li class="collection-item"><a href="../../source/auxkernels/ParsedVectorAux.html">ParsedVectorAux</a>Sets a field vector variable value to the evaluation of a parsed expression.</li><li class="collection-item"><a href="../../source/auxkernels/PenetrationAux.html">PenetrationAux</a>Auxiliary Kernel for computing several geometry related quantities between two contacting bodies.</li><li class="collection-item"><a href="../../source/auxkernels/ProcessorIDAux.html">ProcessorIDAux</a>Creates a field showing the processors and partitioning.</li><li class="collection-item"><a href="../../source/auxkernels/ProjectedMaterialPropertyNodalPatchRecoveryAux.html">ProjectedMaterialPropertyNodalPatchRecoveryAux</a>This Auxkernel solves a least squares problem at each node to fit a value from quantities defined on quadrature points.</li><li class="collection-item"><a href="../../source/auxkernels/ProjectedStatefulMaterialAux.html">ProjectedStatefulMaterialRankFourTensorAux</a>Picks a component of an indexable material property to get projected on an elemental Auxvariable. For use by ProjectedStatefulMaterialStorageAction.</li><li class="collection-item"><a href="../../source/auxkernels/ProjectedStatefulMaterialAux.html">ProjectedStatefulMaterialRankTwoTensorAux</a>Picks a component of an indexable material property to get projected on an elemental Auxvariable. For use by ProjectedStatefulMaterialStorageAction.</li><li class="collection-item"><a href="../../source/auxkernels/ProjectedStatefulMaterialAux.html">ProjectedStatefulMaterialRealAux</a>Picks a component of an indexable material property to get projected on an elemental Auxvariable. For use by ProjectedStatefulMaterialStorageAction.</li><li class="collection-item"><a href="../../source/auxkernels/ProjectedStatefulMaterialAux.html">ProjectedStatefulMaterialRealVectorValueAux</a>Picks a component of an indexable material property to get projected on an elemental Auxvariable. For use by ProjectedStatefulMaterialStorageAction.</li><li class="collection-item"><a href="../../source/auxkernels/ProjectionAux.html">ProjectionAux</a>Returns the specified variable as an auxiliary variable with a projection of the source variable. If they are the same type, this amounts to a simple copy.</li><li class="collection-item"><a href="../../source/auxkernels/QuotientAux.html">QuotientAux</a>Divides two coupled variables.</li><li class="collection-item"><a href="../../source/auxkernels/SecondTimeDerivativeAux.html">SecondTimeDerivativeAux</a>Returns the second order time derivative of the specified variable as an auxiliary variable.</li><li class="collection-item"><a href="../../source/auxkernels/ProjectionAux.html">SelfAux</a>Returns the specified variable as an auxiliary variable with a projection of the source variable. If they are the same type, this amounts to a simple copy.</li><li class="collection-item"><a href="../../source/auxkernels/SolutionAux.html">SolutionAux</a>Creates fields by using information from a SolutionUserObject.</li><li class="collection-item"><a href="../../source/auxkernels/SpatialUserObjectAux.html">SpatialUserObjectAux</a>Populates an auxiliary variable with a spatial value returned from a UserObject spatialValue method.</li><li class="collection-item"><a href="../../source/auxkernels/TagMatrixAux.html">TagMatrixAux</a>Couple the diagonal of a tag matrix, and return its nodal value</li><li class="collection-item"><a href="../../source/auxkernels/TagVectorArrayVariableAux.html">TagVectorArrayVariableAux</a>Couple a tagged vector, and return its evaluations at degree of freedom indices corresponding to the coupled array variable.</li><li class="collection-item"><a href="../../source/auxkernels/TagVectorArrayVariableValueAux.html">TagVectorArrayVariableValueAux</a>Couple a tagged vector, and return its array value.</li><li class="collection-item"><a href="../../source/auxkernels/TagVectorAux.html">TagVectorAux</a>Extract DOF values from a tagged vector into an AuxVariable</li><li class="collection-item"><a href="../../source/auxkernels/TimeDerivativeAux.html">TimeDerivativeAux</a>Returns the time derivative of the specified variable/functor as an auxiliary variable.</li><li class="collection-item"><a href="../../source/auxkernels/VariableGradientComponent.html">VariableGradientComponent</a>Creates a field consisting of one component of the gradient of a coupled variable.</li><li class="collection-item"><a href="../../source/auxkernels/VariableTimeIntegrationAux.html">VariableTimeIntegrationAux</a>Integrates a field variable in time.</li><li class="collection-item"><a href="../../source/auxkernels/VectorFunctionAux.html">VectorFunctionAux</a>Auxiliary Kernel that creates and updates a vector field variable by sampling a Function object, via the vectorValue method, through space and time.</li><li class="collection-item"><a href="../../source/auxkernels/VectorMagnitudeAux.html">VectorMagnitudeAux</a>Creates a field representing the magnitude of three coupled variables using an Euclidean norm.</li><li class="collection-item"><a href="../../source/auxkernels/VectorMaterialRealVectorValueAux.html">VectorMaterialRealVectorValueAux</a>Converts a vector-quantity material property into a vector auxiliary variable</li><li class="collection-item"><a href="../../source/auxkernels/VectorPostprocessorVisualizationAux.html">VectorPostprocessorVisualizationAux</a>Read values from a VectorPostprocessor that is producing vectors that are &#x27;number of processors&#x27; * in length.  Puts the value for each processor into an elemental auxiliary field.</li><li class="collection-item"><a href="../../source/auxkernels/VectorVariableComponentAux.html">VectorVariableComponentAux</a>Creates a field consisting of one component of a coupled vector variable.</li><li class="collection-item"><a href="../../source/auxkernels/VectorVariableMagnitudeAux.html">VectorVariableMagnitudeAux</a>Creates a field consisting of the magnitude of a coupled vector variable.</li><li class="collection-item"><a href="../../source/auxkernels/VolumeAux.html">VolumeAux</a>Auxiliary Kernel that samples volumes.</li><li class="collection-item"><a href="../../source/auxkernels/WeightedGapAux.html">WeightedGapAux</a>Returns the specified variable as an auxiliary variable with the same value.</li><li class="collection-header">Electromagnetics App</li><li class="collection-item">ADCurrentDensityCalculates the current density vector field (in A/m^2) when given electrostatic potential (electrostatic = true, default) or electric field.</li><li class="collection-item">AzimuthMagneticTimeDerivRZComputes the time derivative of the azimuthal component of the magnetic field assuming cylindrical electric field. The electric field can be supplied as a vector or scalar components.</li><li class="collection-item">CurrentDensityCalculates the current density vector field (in A/m^2) when given electrostatic potential (electrostatic = true, default) or electric field.</li><li class="collection-item">EMJouleHeatingHeatGeneratedAuxComputes the heating due to the electic field in the form of <span class="moose-katex-inline-equation" id="moose-equation-65fa6bde-412e-4dc1-889a-beb473298375"><script>var element = document.getElementById("moose-equation-65fa6bde-412e-4dc1-889a-beb473298375");katex.render("(0.5Re(\\sigma E \\cdot E^{*} ))", element, {displayMode:false,throwOnError:false});</script></span></li><li class="collection-item">PotentialToFieldAuxAn AuxKernel that calculates the electrostatic electric field given the electrostatic potential.</li><li class="collection-item">SourceCurrentHeatingComputes the heating due to the electic field in the form of <span class="moose-katex-inline-equation" id="moose-equation-e7dd5a6e-265b-4a82-b120-d5c94d8f8524"><script>var element = document.getElementById("moose-equation-e7dd5a6e-265b-4a82-b120-d5c94d8f8524");katex.render("(0.5Re(J \\cdot E^{*} ))", element, {displayMode:false,throwOnError:false});</script></span></li><li class="collection-header">Squirrel App</li><li class="collection-item"><a href="../../source/auxkernels/Density.html">Density</a></li><li class="collection-item"><a href="../../source/auxkernels/FunctionDerivativeAux.html">FunctionDerivativeAux</a></li><li class="collection-header">Crane App</li><li class="collection-item"><a href="../../source/auxkernels/ReactionRateEEDFTownsendLog.html">ADReactionRateEEDFTownsendLog</a></li><li class="collection-item"><a href="../../source/auxkernels/DataRead.html">DataRead</a></li><li class="collection-item"><a href="../../source/auxkernels/DensityLogConvert.html">DensityLogConvert</a></li><li class="collection-item"><a href="../../source/auxkernels/ReactionRateEEDFTownsendLog.html">ReactionRateEEDFTownsendLog</a></li><li class="collection-item"><a href="../../source/auxkernels/ReactionRateFirstOrder.html">ReactionRateFirstOrder</a>Reaction rate for one body collisions. User can pass choice of elastic, excitation, or ionization reaction rate coefficients. Automatically added if track_rates set to true in the <a href="/syntax/Reactions/index.md">Reactions</a> action.</li><li class="collection-item"><a href="../../source/auxkernels/ReactionRateFirstOrderLog.html">ReactionRateFirstOrderLog</a>Reaction rate for one body collisions. User can pass choice of elastic, excitation, or ionization reaction rate coefficients. Automatically added if track_rates set to true in the <a href="/syntax/Reactions/index.md">Reactions</a> action.</li><li class="collection-item"><a href="../../source/auxkernels/ReactionRateSecondOrder.html">ReactionRateSecondOrder</a>Reaction rate for two body collisions. User can pass choice of elastic, excitation, or ionization reaction rate coefficients. Automatically added if track_rates set to true in the <a href="/syntax/Reactions/index.md">Reactions</a> action.</li><li class="collection-item"><a href="../../source/auxkernels/ReactionRateSecondOrderLog.html">ReactionRateSecondOrderLog</a>Reaction rate for two body collisions. User can pass choice of elastic, excitation, or ionization reaction rate coefficients. Automatically added if track_rates set to true in the <a href="/syntax/Reactions/index.md">Reactions</a> action.</li><li class="collection-item"><a href="../../source/auxkernels/ReactionRateThirdOrder.html">ReactionRateThirdOrder</a>Reaction rate for three body collisions. User can pass choice of elastic, excitation, or ionization reaction rate coefficients. Automatically added if track_rates set to true in the <a href="/syntax/Reactions/index.md">Reactions</a> action.</li><li class="collection-item"><a href="../../source/auxkernels/ReactionRateThirdOrderLog.html">ReactionRateThirdOrderLog</a>Reaction rate for three body collisions. User can pass choice of elastic, excitation, or ionization reaction rate coefficients. Automatically added if track_rates set to true in the <a href="/syntax/Reactions/index.md">Reactions</a> action.</li><li class="collection-header">Zapdos App</li><li class="collection-item"><a href="../../source/auxkernels/Current.html">ADCurrent</a>Returns the electric current associated with the flux of the specified species</li><li class="collection-item"><a href="../../source/auxkernels/DiffusiveFlux.html">ADDiffusiveFlux</a>Returns the diffusive flux of the specified species</li><li class="collection-item"><a href="../../source/auxkernels/EFieldAdvAux.html">ADEFieldAdvAux</a>Returns the electric field driven advective flux of the specified species</li><li class="collection-item"><a href="../../source/auxkernels/PowerDep.html">ADPowerDep</a>Amount of power deposited into a user specified specie by Joule Heating</li><li class="collection-item"><a href="../../source/auxkernels/ProcRate.html">ADProcRate</a>Reaction rate for electron impact collisions in units of #/m<span class="moose-katex-inline-equation" id="moose-equation-8f167fe6-4ae4-447c-9bd3-428b7fcd20e5"><script>var element = document.getElementById("moose-equation-8f167fe6-4ae4-447c-9bd3-428b7fcd20e5");katex.render("^{3}", element, {displayMode:false,throwOnError:false});</script></span>s. User can pass choice of elastic, excitation, or ionization Townsend coefficients</li><li class="collection-item"><a href="../../source/auxkernels/ProcRateForRateCoeff.html">ADProcRateForRateCoeff</a>Reaction rate for two body collisions in units of #/m<span class="moose-katex-inline-equation" id="moose-equation-81ab1edc-c17c-4d17-9f18-08760c451e0a"><script>var element = document.getElementById("moose-equation-81ab1edc-c17c-4d17-9f18-08760c451e0a");katex.render("^{3}", element, {displayMode:false,throwOnError:false});</script></span>s. User can pass choice of elastic, excitation, or ionization reaction rate coefficients</li><li class="collection-item"><a href="../../source/auxkernels/ProcRateForRateCoeffThreeBody.html">ADProcRateForRateCoeffThreeBody</a>Reaction rate for three body collisions in units of #/m<span class="moose-katex-inline-equation" id="moose-equation-3d870e20-4750-47af-9341-fe046f2e8369"><script>var element = document.getElementById("moose-equation-3d870e20-4750-47af-9341-fe046f2e8369");katex.render("^{3}", element, {displayMode:false,throwOnError:false});</script></span>s. User can pass choice of elastic, excitation, or ionization reaction rate coefficients</li><li class="collection-item"><a href="../../source/auxkernels/TotalFlux.html">ADTotalFlux</a>Returns the total flux of the specified species</li><li class="collection-item"><a href="../../source/auxkernels/AbsValueAux.html">AbsValueAux</a>Returns the absolute value of the specified variable</li><li class="collection-item"><a href="../../source/auxkernels/Current.html">Current</a>Returns the electric current associated with the flux of the specified species</li><li class="collection-item"><a href="../../source/auxkernels/DensityMoles.html">DensityMoles</a>Returns physical densities in units of #/m<span class="moose-katex-inline-equation" id="moose-equation-fed15b40-ba96-41ad-982a-4a7e1bc86bc1"><script>var element = document.getElementById("moose-equation-fed15b40-ba96-41ad-982a-4a7e1bc86bc1");katex.render("^3", element, {displayMode:false,throwOnError:false});</script></span></li><li class="collection-item"><a href="../../source/auxkernels/DensityNormalization.html">DensityNormalization</a>Similar to NormalizationAux except meant to normalize variables expressed in log form</li><li class="collection-item"><a href="../../source/auxkernels/DiffusiveFlux.html">DiffusiveFlux</a>Returns the diffusive flux of the specified species</li><li class="collection-item"><a href="../../source/auxkernels/DriftDiffusionFluxAux.html">DriftDiffusionFluxAux</a>Returns the drift-diffusion flux of the specified species</li><li class="collection-item"><a href="../../source/auxkernels/EFieldAdvAux.html">EFieldAdvAux</a>Returns the electric field driven advective flux of the specified species</li><li class="collection-item"><a href="../../source/auxkernels/Efield.html">Efield</a>Returns the defined component of the electric field (0 = x, 1 = y, 2 = z)</li><li class="collection-item"><a href="../../source/auxkernels/ElectronTemperature.html">ElectronTemperature</a>Returns the electron temperature</li><li class="collection-item"><a href="../../source/auxkernels/LinearCombinationAuxKernel.html">LinearCombinationAuxKernel</a>Linearly combine coupled variables with user provided weights and a bias</li><li class="collection-item"><a href="../../source/auxkernels/Position.html">Position</a>Produces an elemental auxiliary variable useful for plotting against other elemental auxiliary variables. Mesh points automatically output by Zapdos only work for plotting nodal variables. Since almost all auxiliary variables are elemental, this AuxKernel is very important</li><li class="collection-item"><a href="../../source/auxkernels/PowerDep.html">PowerDep</a>Amount of power deposited into a user specified specie by Joule Heating</li><li class="collection-item"><a href="../../source/auxkernels/ProcRate.html">ProcRate</a>Reaction rate for electron impact collisions in units of #/m<span class="moose-katex-inline-equation" id="moose-equation-026633c3-02bd-4be1-adca-7ba4f0c54c29"><script>var element = document.getElementById("moose-equation-026633c3-02bd-4be1-adca-7ba4f0c54c29");katex.render("^{3}", element, {displayMode:false,throwOnError:false});</script></span>s. User can pass choice of elastic, excitation, or ionization Townsend coefficients</li><li class="collection-item"><a href="../../source/auxkernels/ProcRateForRateCoeff.html">ProcRateForRateCoeff</a>Reaction rate for two body collisions in units of #/m<span class="moose-katex-inline-equation" id="moose-equation-715913ba-743b-4a56-b5de-e3c09fd9df63"><script>var element = document.getElementById("moose-equation-715913ba-743b-4a56-b5de-e3c09fd9df63");katex.render("^{3}", element, {displayMode:false,throwOnError:false});</script></span>s. User can pass choice of elastic, excitation, or ionization reaction rate coefficients</li><li class="collection-item"><a href="../../source/auxkernels/ProcRateForRateCoeffThreeBody.html">ProcRateForRateCoeffThreeBody</a>Reaction rate for three body collisions in units of #/m<span class="moose-katex-inline-equation" id="moose-equation-3d2a13ff-3380-459b-8492-b1c848f12bac"><script>var element = document.getElementById("moose-equation-3d2a13ff-3380-459b-8492-b1c848f12bac");katex.render("^{3}", element, {displayMode:false,throwOnError:false});</script></span>s. User can pass choice of elastic, excitation, or ionization reaction rate coefficients</li><li class="collection-item"><a href="../../source/auxkernels/Sigma.html">Sigma</a>Calculates the surface charge due to a simplified version of the ion flux to a boundary.</li><li class="collection-item"><a href="../../source/auxkernels/TM0CylindricalErAux.html">TM0CylindricalErAux</a>Calculates the radial E-field for an axisymmetric TM<span class="moose-katex-inline-equation" id="moose-equation-bf72da2d-0b0f-4c95-a8f2-0ff494591f08"><script>var element = document.getElementById("moose-equation-bf72da2d-0b0f-4c95-a8f2-0ff494591f08");katex.render("_{0}", element, {displayMode:false,throwOnError:false});</script></span> wave.</li><li class="collection-item"><a href="../../source/auxkernels/TM0CylindricalEzAux.html">TM0CylindricalEzAux</a>Calculates the axial E-field for an axisymmetric TM<span class="moose-katex-inline-equation" id="moose-equation-1e104756-8a84-49c0-b1fe-f9248c6ad0ba"><script>var element = document.getElementById("moose-equation-1e104756-8a84-49c0-b1fe-f9248c6ad0ba");katex.render("_{0}", element, {displayMode:false,throwOnError:false});</script></span> wave.</li><li class="collection-item"><a href="../../source/auxkernels/TotalFlux.html">TotalFlux</a>Returns the total flux of the specified species</li></ul></section><section class="scrollspy" id="58b091fb-ff6d-4e8d-a67a-c33c63d0fa51" data-section-level="2" data-section-text="Available Actions"><h2 id="available-actions">Available Actions</h2><ul class="moose-syntax-list collection with-header"><li class="collection-header">Moose App</li><li class="collection-item"><a href="../../source/actions/AddKernelAction.html">AddKernelAction</a>Add a Kernel object to the simulation.</li></ul></section></section><div class="moose-modal modal" id="32e34ccc-d0bc-4a1b-81ae-b64765ef3a60"><div class="modal-content"><h4>(moose/test/tests/auxkernels/vector_function_aux/vector_function_aux.i)</h4><pre style="max-height:350px;"><code class="language-moose">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 2
  ny = 2
[]

[AuxVariables]
  [vec]
    family = LAGRANGE_VEC
    order = FIRST
  []
[]

[Variables]
  [u][]
[]

[Functions]
  [function]
    type = ParsedVectorFunction
    expression_x = t*x
    expression_y = t*y
  []
[]

[AuxKernels]
  [vec]
    type = VectorFunctionAux
    variable = vec
    function = function
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
  [../]
[]

[Problem]
  type = FEProblem
  #solve = false
  kernel_coverage_check = false
[]

[Executioner]
  type = Transient
  start_time = 0.0
  num_steps = 5
  dt = 1
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="1367138a-7d65-4eca-bc59-c8931049db9d"><div class="modal-content"><h4>(moose/framework/src/auxkernels/FunctionAux.C)</h4><pre style="max-height:350px;"><code class="language-cpp">// This file is part of the MOOSE framework
// https://mooseframework.inl.gov
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#include &quot;FunctionAux.h&quot;
#include &quot;Function.h&quot;

registerMooseObject(&quot;MooseApp&quot;, FunctionAux);

InputParameters
FunctionAux::validParams()
{
  InputParameters params = AuxKernel::validParams();
  params.addClassDescription(&quot;Auxiliary Kernel that creates and updates a field variable by &quot;
                             &quot;sampling a function through space and time.&quot;);
  params.addRequiredParam&lt;FunctionName&gt;(&quot;function&quot;, &quot;The function to use as the value&quot;);
  return params;
}

FunctionAux::FunctionAux(const InputParameters &amp; parameters)
  : AuxKernel(parameters), _func(getFunction(&quot;function&quot;))
{
}

Real
FunctionAux::computeValue()
{
  if (isNodal())
    return _func.value(_t, *_current_node);
  else
    return _func.value(_t, _q_point[_qp]);
}
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="b23a4d17-23f8-413a-b0c8-67f003b558f0"><div class="modal-content"><h4>(moose/tutorials/darcy_thermo_mech/step04_velocity_aux/include/auxkernels/DarcyVelocity.h)</h4><pre style="max-height:350px;"><code class="language-cpp">// This file is part of the MOOSE framework
// https://mooseframework.inl.gov
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#pragma once

#include &quot;AuxKernel.h&quot;

/**
 * Auxiliary kernel responsible for computing the Darcy velocity given
 * several fluid properties and the pressure gradient.
 */
class DarcyVelocity : public VectorAuxKernel
{
public:
  static InputParameters validParams();

  DarcyVelocity(const InputParameters &amp; parameters);

protected:
  /**
   * AuxKernels MUST override computeValue.  computeValue() is called on
   * every quadrature point.  For Nodal Auxiliary variables those quadrature
   * points coincide with the nodes.
   */
  virtual RealVectorValue computeValue() override;

  /// The gradient of a coupled variable
  const VariableGradient &amp; _pressure_gradient;

  /// Holds the permeability and viscosity from the material system
  const ADMaterialProperty&lt;Real&gt; &amp; _permeability;
  const ADMaterialProperty&lt;Real&gt; &amp; _viscosity;
};
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="c4124a04-950a-44ad-b5d7-728e4e003d88"><div class="modal-content"><h4>(moose/tutorials/darcy_thermo_mech/step04_velocity_aux/src/auxkernels/DarcyVelocity.C)</h4><pre style="max-height:350px;"><code class="language-cpp">// This file is part of the MOOSE framework
// https://mooseframework.inl.gov
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#include &quot;DarcyVelocity.h&quot;

#include &quot;metaphysicl/raw_type.h&quot;

registerMooseObject(&quot;DarcyThermoMechApp&quot;, DarcyVelocity);

InputParameters
DarcyVelocity::validParams()
{
  InputParameters params = VectorAuxKernel::validParams();

  // Add a &quot;coupling paramater&quot; to get a variable from the input file.
  params.addRequiredCoupledVar(&quot;pressure&quot;, &quot;The pressure field.&quot;);

  return params;
}

DarcyVelocity::DarcyVelocity(const InputParameters &amp; parameters)
  : VectorAuxKernel(parameters),

    // Get the gradient of the variable
    _pressure_gradient(coupledGradient(&quot;pressure&quot;)),

    // Set reference to the permeability MaterialProperty.
    // Only AuxKernels operating on Elemental Auxiliary Variables can do this
    _permeability(getADMaterialProperty&lt;Real&gt;(&quot;permeability&quot;)),

    // Set reference to the viscosity MaterialProperty.
    // Only AuxKernels operating on Elemental Auxiliary Variables can do this
    _viscosity(getADMaterialProperty&lt;Real&gt;(&quot;viscosity&quot;))
{
}

RealVectorValue
DarcyVelocity::computeValue()
{
  // Access the gradient of the pressure at this quadrature point, then pull out the &quot;component&quot; of
  // it requested (x, y or z). Note, that getting a particular component of a gradient is done using
  // the parenthesis operator.
  return -MetaPhysicL::raw_value(_permeability[_qp] / _viscosity[_qp]) * _pressure_gradient[_qp];
}
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="260f7344-c952-43a2-b1c4-944091413ada"><div class="modal-content"><h4>(moose/tutorials/darcy_thermo_mech/step06_coupled_darcy_heat_conduction/src/kernels/DarcyAdvection.C)</h4><pre style="max-height:350px;"><code class="language-cpp">// This file is part of the MOOSE framework
// https://mooseframework.inl.gov
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#include &quot;DarcyAdvection.h&quot;

registerMooseObject(&quot;DarcyThermoMechApp&quot;, DarcyAdvection);

InputParameters
DarcyAdvection::validParams()
{
  InputParameters params = ADKernelValue::validParams();
  params.addRequiredCoupledVar(&quot;pressure&quot;, &quot;The variable representing the pressure.&quot;);
  return params;
}

DarcyAdvection::DarcyAdvection(const InputParameters &amp; parameters)
  : ADKernelValue(parameters),
    // Couple to the gradient of the pressure
    _pressure_grad(adCoupledGradient(&quot;pressure&quot;)),
    // Grab necessary material properties
    _permeability(getADMaterialProperty&lt;Real&gt;(&quot;permeability&quot;)),
    _porosity(getADMaterialProperty&lt;Real&gt;(&quot;porosity&quot;)),
    _viscosity(getADMaterialProperty&lt;Real&gt;(&quot;viscosity&quot;)),
    _density(getADMaterialProperty&lt;Real&gt;(&quot;density&quot;)),
    _specific_heat(getADMaterialProperty&lt;Real&gt;(&quot;specific_heat&quot;))
{
}

ADReal
DarcyAdvection::precomputeQpResidual()
{
  // See also: E. Majchrzak and L. Turchan, &quot;The Finite Difference
  // Method For Transient Convection Diffusion&quot;, Scientific Research
  // of the Institute of Mathematics and Computer Science, vol. 1,
  // no. 11, 2012, pp. 63-72.
  // http://srimcs.im.pcz.pl/2012_1/art_07.pdf

  // http://en.wikipedia.org/wiki/Superficial_velocity
  ADRealVectorValue superficial_velocity =
      _porosity[_qp] * -(_permeability[_qp] / _viscosity[_qp]) * _pressure_grad[_qp];

  return _density[_qp] * _specific_heat[_qp] * superficial_velocity * _grad_u[_qp];
}
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="de6f1b95-20b6-4560-88cd-1ac769cf65cd"><div class="modal-content"><h4>(moose/tutorials/darcy_thermo_mech/step06_coupled_darcy_heat_conduction/src/kernels/DarcyAdvection.C)</h4><pre style="max-height:350px;"><code class="language-cpp">// This file is part of the MOOSE framework
// https://mooseframework.inl.gov
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#include &quot;DarcyAdvection.h&quot;

registerMooseObject(&quot;DarcyThermoMechApp&quot;, DarcyAdvection);

InputParameters
DarcyAdvection::validParams()
{
  InputParameters params = ADKernelValue::validParams();
  params.addRequiredCoupledVar(&quot;pressure&quot;, &quot;The variable representing the pressure.&quot;);
  return params;
}

DarcyAdvection::DarcyAdvection(const InputParameters &amp; parameters)
  : ADKernelValue(parameters),
    // Couple to the gradient of the pressure
    _pressure_grad(adCoupledGradient(&quot;pressure&quot;)),
    // Grab necessary material properties
    _permeability(getADMaterialProperty&lt;Real&gt;(&quot;permeability&quot;)),
    _porosity(getADMaterialProperty&lt;Real&gt;(&quot;porosity&quot;)),
    _viscosity(getADMaterialProperty&lt;Real&gt;(&quot;viscosity&quot;)),
    _density(getADMaterialProperty&lt;Real&gt;(&quot;density&quot;)),
    _specific_heat(getADMaterialProperty&lt;Real&gt;(&quot;specific_heat&quot;))
{
}

ADReal
DarcyAdvection::precomputeQpResidual()
{
  // See also: E. Majchrzak and L. Turchan, &quot;The Finite Difference
  // Method For Transient Convection Diffusion&quot;, Scientific Research
  // of the Institute of Mathematics and Computer Science, vol. 1,
  // no. 11, 2012, pp. 63-72.
  // http://srimcs.im.pcz.pl/2012_1/art_07.pdf

  // http://en.wikipedia.org/wiki/Superficial_velocity
  ADRealVectorValue superficial_velocity =
      _porosity[_qp] * -(_permeability[_qp] / _viscosity[_qp]) * _pressure_grad[_qp];

  return _density[_qp] * _specific_heat[_qp] * superficial_velocity * _grad_u[_qp];
}
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="6fb9e621-4c02-4deb-8407-82c8a9c8ab6c"><div class="modal-content"><h4>(moose/tutorials/darcy_thermo_mech/step06_coupled_darcy_heat_conduction/problems/step6c_decoupled.i)</h4><pre style="max-height:350px;"><code class="language-moose">[Mesh]
  [gmg]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 200
    ny = 10
    xmax = 0.304 # Length of test chamber
    ymax = 0.0257 # Test chamber radius
  []
  coord_type = RZ
  rz_coord_axis = X
[]

[Variables]
  [temperature]
    initial_condition = 300 # Start at room temperature
  []
[]

[AuxVariables/pressure]
[]

[AuxKernels/pressure]
  type = FunctionAux
  variable = pressure
  function = &#x27;4000 - 3000 * x - 3000 * t*x*x*y&#x27;
  execute_on = timestep_end
[]

[Kernels]
  [heat_conduction]
    type = ADHeatConduction
    variable = temperature
  []
  [heat_conduction_time_derivative]
    type = ADHeatConductionTimeDerivative
    variable = temperature
  []
  [heat_convection]
    type = DarcyAdvection
    variable = temperature
    pressure = pressure
  []
[]

[BCs]
  [inlet_temperature]
    type = DirichletBC
    variable = temperature
    boundary = left
    value = 350
  []
  [outlet_temperature]
    type = HeatConductionOutflow
    variable = temperature
    boundary = right
  []
[]

[Materials/column]
  type = PackedColumn
  temperature = 293.15 # 20C
  radius = 1
[]

[Problem]
  type = FEProblem
[]

[Executioner]
  type = Transient
  num_steps = 300
  dt = 0.1

  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#ebbbd26d-8009-44dd-be37-1dcfab1ec209" class="tooltipped" data-position="left" data-tooltip="Nodal vs Elemental AuxKernel Objects">Nodal vs Elemental AuxKernel Objects</a></li><li><a href="#e0ad3b05-351f-4cb5-b815-76d17de897b6" class="tooltipped" data-position="left" data-tooltip="Block vs Boundary Restricted AuxKernel Objects">Block vs Boundary Restricted AuxKernel Objects</a></li><li><a href="#03f72ca0-674e-4b56-a3b0-61a378f10462" class="tooltipped" data-position="left" data-tooltip="Mortar Nodal Auxiliary Kernel Objects">Mortar Nodal Auxiliary Kernel Objects</a></li><li><a href="#d07fbc5f-dd17-4082-a204-c0d29975cf28" class="tooltipped" data-position="left" data-tooltip="Execute Flags">Execute Flags</a></li><li><a href="#166bc989-5feb-4a75-883b-097ae8bce09e" class="tooltipped" data-position="left" data-tooltip="Populating lower - dimensional auxiliary variables">Populating lower - dimensional auxiliary variables</a></li><li><a href="#f22ebc3d-acc8-4c5b-8ffd-f21dcb59dc30" class="tooltipped" data-position="left" data-tooltip="Example A : Post processing with AuxKernel">Example A : Post processing with AuxKernel</a></li><li><a href="#9242ede5-bac2-46d0-ae37-819a60b691af" class="tooltipped" data-position="left" data-tooltip="Example B : Decoupling Equations">Example B : Decoupling Equations</a></li><li><a href="#7885a092-73bc-473c-b7b2-9793b3659070" class="tooltipped" data-position="left" data-tooltip="Available Objects">Available Objects</a></li><li><a href="#58b091fb-ff6d-4e8d-a67a-c33c63d0fa51" class="tooltipped" data-position="left" data-tooltip="Available Actions">Available Actions</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script><script type="text/javascript" src="../../js/moose_input_parser.js"></script>