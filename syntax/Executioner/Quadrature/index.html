<!DOCTYPE html><head><meta charset="UTF-8"><title>Quadrature System | Zapdos</title><link href="../../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/zapdos.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../../contrib/katex/katex.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../../../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Zapdos</a><a href="https://github.com/shannon-lab/zapdos" class="right"><img src="../../../media/framework/github-logo.png" alt="GitHub wordmark" class="github-mark"></img><img src="../../../media/framework/github-mark.png" alt="GitHub logo" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="8475aaa6-1f35-40a0-a090-6e8b973163b1" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="98c4846a-2715-48fc-90e5-5b12aa6e7a5b" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="4a8049f3-a353-4be4-9ac5-bccc28802290" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../../citing.html">Citing</a></li></ul><a href="#" class="sidenav-trigger" data-target="673b61ac-1f3e-43ce-b277-6c9c946e3616"><i class="material-icons">menu</i></a><ul class="sidenav" id="673b61ac-1f3e-43ce-b277-6c9c946e3616"><li><a href="#!" class="dropdown-trigger" data-target="d1735a1c-16fa-4a1a-9084-561d2fbb829b" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="12cb3aea-a71d-46ed-ab9d-37fedcdeb879" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="f87a5788-5497-4228-bbf0-973b913b3ee8" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../../citing.html">Citing</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="8475aaa6-1f35-40a0-a090-6e8b973163b1"><li><a href="../../../getting_started/installation.html">Installation</a></li><li><a href="../../../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../../../getting_started/zapdos_meshing.html">Generating Meshes</a></li><li><a href="../../../tutorial/index.html">Tutorial Slides</a></li></ul><ul class="dropdown-content" id="98c4846a-2715-48fc-90e5-5b12aa6e7a5b"><li><a href="../../zapdos_only.html">Zapdos Input Syntax</a></li><li><a href="../../index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../../../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../../../examples/crane_examples.html">CRANE Examples</a></li><li><a href="../../../development/contributing.html">Contributing Guidelines</a></li><li><a href="../../../development/code_standards.html">Code Standards</a></li><li><a href="../../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="4a8049f3-a353-4be4-9ac5-bccc28802290"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="../../../development/zapdos_developer_info.html">Zapdos Developer Information</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../../../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul><ul class="dropdown-content" id="d1735a1c-16fa-4a1a-9084-561d2fbb829b"><li><a href="../../../getting_started/installation.html">Installation</a></li><li><a href="../../../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../../../getting_started/zapdos_meshing.html">Generating Meshes</a></li><li><a href="../../../tutorial/index.html">Tutorial Slides</a></li></ul><ul class="dropdown-content" id="12cb3aea-a71d-46ed-ab9d-37fedcdeb879"><li><a href="../../zapdos_only.html">Zapdos Input Syntax</a></li><li><a href="../../index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../../../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../../../examples/crane_examples.html">CRANE Examples</a></li><li><a href="../../../development/contributing.html">Contributing Guidelines</a></li><li><a href="../../../development/code_standards.html">Code Standards</a></li><li><a href="../../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="f87a5788-5497-4228-bbf0-973b913b3ee8"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="../../../development/zapdos_developer_info.html">Zapdos Developer Information</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../../../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href="../.." class="breadcrumb">syntax</a><a href=".." class="breadcrumb">Executioner</a><a href="." class="breadcrumb">Quadrature</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="0ebf764e-31be-478a-997e-a6c4c9bd81a6" data-section-level="1" data-section-text="Quadrature System"><h1 id="quadrature-system">Quadrature System</h1><p>The <code>Quadrature</code> is used to integrate numerically in the domain and on sides. Some examples of integrals performed by MOOSE are the integration of the residual over an element, or the postprocessing of spatial variable integrals / averages over the domain.</p><p>The <code>Quadrature</code> order is chosen by default so that the product of the test function and the shape functions is integrated exactly. When using Galerkin&#x27;s method, this would mean the quadrature needs to integrate exactly polynomials of order twice the order of the variables. In order to be able to integrate exactly with a potential third multiplied term in the definition of the residual, we actually use a quadrature of order <span class="moose-katex-inline-equation" id="moose-equation-bda839ab-7cf7-433b-9fd5-b5f9a4474819"><script>var element = document.getElementById("moose-equation-bda839ab-7cf7-433b-9fd5-b5f9a4474819");katex.render("2 n + 1", element, {displayMode:false,throwOnError:false});</script></span>, with n the order of the variables.</p><p>In 1D, the following quadratures are known to integrate exactly:</p><ul class="browser-default"><li><p>GAUSS (-Legendre), the default rule, with n points integrates exactly 1D polynomials of order up to 2n-1 </p></li><li><p>GAUSS_LOBATTO with n points integrates exactly 1D polynomials of order up to 2n-3 </p></li><li><p>SIMPSON&#x27;s rule is known to integrate exactly 1D polynomials of order up to 3</p></li></ul><p>In higher dimensions, the quadratures are defined differently based on the element types. The user is referred to the libMesh doxygen for each quadrature rule object. They generally may be either:</p><ul class="browser-default"><li><p>tensor product of 1D quadratures to be able to able to integrate exactly <span class="moose-katex-inline-equation" id="moose-equation-beea6eee-7a8a-4a9a-84f5-a21947ce6383"><script>var element = document.getElementById("moose-equation-beea6eee-7a8a-4a9a-84f5-a21947ce6383");katex.render("x^a y^b z^c", element, {displayMode:false,throwOnError:false});</script></span> terms with <span class="moose-katex-inline-equation" id="moose-equation-7b8c6854-9318-466c-9187-7c9f21202961"><script>var element = document.getElementById("moose-equation-7b8c6854-9318-466c-9187-7c9f21202961");katex.render("a\\leq p, b\\leq p, c\\leq p", element, {displayMode:false,throwOnError:false});</script></span> with a quadrature of order <span class="moose-katex-inline-equation" id="moose-equation-5a708bf9-6a11-490f-862a-7db05a257a0f"><script>var element = document.getElementById("moose-equation-5a708bf9-6a11-490f-862a-7db05a257a0f");katex.render("p", element, {displayMode:false,throwOnError:false});</script></span>. </p></li><li><p>using Dunavant&#x27;s rule for quadratures on triangle elements </p></li><li><p>extracted from the finite element literature</p></li></ul><div class="card moose-alert moose-alert-note"><div class="card-title moose-alert-title"><i class="material-icons moose-inline-icon">comment</i><span class="moose-alert-title-brand">note</span></div><div class="card-content"><div class="moose-alert-content"><p>Due to a current issue in the documentation system, the <code>type</code> parameter of the quadrature does not display in the list of parameters. The available options are <code>CLOUGH CONICAL GAUSS GRID MONOMIAL SIMPSON TRAP GAUSS_LOBATTO</code> with a default of <code>GAUSS</code> (-Legendre).</p></div></div></div><section class="scrollspy" id="6472929e-62e4-4503-a476-58164520266c" data-section-level="2" data-section-text="Lowering the quadrature order"><h2 id="lowering-the-quadrature-order">Lowering the quadrature order</h2><p>The quadrature order may be lowered intentionally for various purposes. The side integration quadrature can be set at different order than the element integration one, using the <a href="#97129254-6f87-47ac-acc2-e8832bf99133" class="moose-modal-link modal-trigger">&quot;element_order&quot;</a> and <a href="#b18dea21-ac5b-4685-806b-df83cb084ab7" class="moose-modal-link modal-trigger">&quot;side_order&quot;</a> parameters. Custom quadrature orders may be set on selected blocks using the <a href="#f6dac07d-55b7-48c8-8ba8-9a991172333d" class="moose-modal-link modal-trigger">&quot;custom_blocks&quot;</a> and <a href="#14e89807-e687-47a8-8242-9a39a52d6757" class="moose-modal-link modal-trigger">&quot;custom_orders&quot;</a> parameters</p></section><section class="scrollspy" id="610bad0f-0bf8-4c7a-87d5-e652ab69efb5" data-section-level="2" data-section-text="Example syntax"><h2 id="example-syntax">Example syntax</h2><p>In this example, we specify a different quadrature rule using the <code>[Quadrature]</code> block nested in the <code>[Executioner]</code> block.</p><pre style="max-height:350px;"><code class="language-moose">[Executioner&lt;&lt;&lt;{&quot;href&quot;: &quot;../index.html&quot;}&gt;&gt;&gt;]
  type = Steady

  # In 1D, 5th-order Gauss-Lobatto quadrature has 4 points, so in 2D
  # it should have 16.
  [./Quadrature&lt;&lt;&lt;{&quot;href&quot;: &quot;index.html&quot;}&gt;&gt;&gt;]
    type = GAUSS_LOBATTO
    order&lt;&lt;&lt;{&quot;description&quot;: &quot;Order of the quadrature&quot;}&gt;&gt;&gt; = FIFTH
  [../]
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#414c91eb-54eb-4afd-be49-84f92027a8eb">(moose/test/tests/quadrature/gauss_lobatto/gauss_lobatto.i)</a></section><section class="scrollspy" id="08674f51-41ac-4813-88b2-121beeb5da0c" data-section-level="2" data-section-text="Available Actions"><h2 id="available-actions">Available Actions</h2><ul class="moose-syntax-list collection with-header"><li class="collection-header">Moose App</li><li class="collection-item"><a href="../../../source/actions/SetupQuadratureAction.html">SetupQuadratureAction</a>Sets the quadrature type for the simulation.</li></ul></section></section><div class="moose-modal modal" id="97129254-6f87-47ac-acc2-e8832bf99133"><div class="modal-content"><h4>element_order</h4><p class="moose-parameter-description-default"><span>Default:</span>AUTO</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MooseEnum</p><p class="moose-parameter-description-options"><span>Options:</span>AUTO, CONSTANT, FIRST, SECOND, THIRD, FOURTH, FIFTH, SIXTH, SEVENTH, EIGHTH, NINTH, TENTH, ELEVENTH, TWELFTH, THIRTEENTH, FOURTEENTH, FIFTEENTH, SIXTEENTH, SEVENTEENTH, EIGHTTEENTH, NINTEENTH, TWENTIETH</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Order of the quadrature for elements</p></div></div><div class="moose-modal modal" id="b18dea21-ac5b-4685-806b-df83cb084ab7"><div class="modal-content"><h4>side_order</h4><p class="moose-parameter-description-default"><span>Default:</span>AUTO</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MooseEnum</p><p class="moose-parameter-description-options"><span>Options:</span>AUTO, CONSTANT, FIRST, SECOND, THIRD, FOURTH, FIFTH, SIXTH, SEVENTH, EIGHTH, NINTH, TENTH, ELEVENTH, TWELFTH, THIRTEENTH, FOURTEENTH, FIFTEENTH, SIXTEENTH, SEVENTEENTH, EIGHTTEENTH, NINTEENTH, TWENTIETH</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Order of the quadrature for sides</p></div></div><div class="moose-modal modal" id="f6dac07d-55b7-48c8-8ba8-9a991172333d"><div class="modal-content"><h4>custom_blocks</h4><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;unsigned short&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>list of blocks to specify custom quadrature order</p></div></div><div class="moose-modal modal" id="14e89807-e687-47a8-8242-9a39a52d6757"><div class="modal-content"><h4>custom_orders</h4><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MultiMooseEnum</p><p class="moose-parameter-description-options"><span>Options:</span>CONSTANT, FIRST, SECOND, THIRD, FOURTH, FIFTH, SIXTH, SEVENTH, EIGHTH, NINTH, TENTH, ELEVENTH, TWELFTH, THIRTEENTH, FOURTEENTH, FIFTEENTH, SIXTEENTH, SEVENTEENTH, EIGHTTEENTH, NINTEENTH, TWENTIETH</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>list of quadrature orders for the blocks specified in `custom_blocks`</p></div></div><div class="moose-modal modal" id="414c91eb-54eb-4afd-be49-84f92027a8eb"><div class="modal-content"><h4>(moose/test/tests/quadrature/gauss_lobatto/gauss_lobatto.i)</h4><pre style="max-height:350px;"><code class="language-moose">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 1
  ny = 1
  nz = 0
  elem_type = QUAD4
[]

[Postprocessors]
  [./num_elem_qps]
    type = NumElemQPs
    block = 0
  [../]
[]

[Problem]
  type = FEProblem
  solve = false
[]

[Executioner]
  type = Steady

  # In 1D, 5th-order Gauss-Lobatto quadrature has 4 points, so in 2D
  # it should have 16.
  [./Quadrature]
    type = GAUSS_LOBATTO
    order = FIFTH
  [../]
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  exodus = false
  csv = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#6472929e-62e4-4503-a476-58164520266c" class="tooltipped" data-position="left" data-tooltip="Lowering the quadrature order">Lowering the quadrature order</a></li><li><a href="#610bad0f-0bf8-4c7a-87d5-e652ab69efb5" class="tooltipped" data-position="left" data-tooltip="Example syntax">Example syntax</a></li><li><a href="#08674f51-41ac-4813-88b2-121beeb5da0c" class="tooltipped" data-position="left" data-tooltip="Available Actions">Available Actions</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../../js/init.js"></script><script type="text/javascript" src="../../../js/navigation.js"></script><script type="text/javascript" src="../../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../../js/search_index.js"></script><script type="text/javascript" src="../../../js/sqa_moose.js"></script><script type="text/javascript" src="../../../js/moose_input_parser.js"></script>